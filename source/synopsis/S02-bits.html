<!DOCTYPE html>
<html lang="ja">
<head>
<title>S02-bits</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" >
<link rel="stylesheet" href="http://yandex.st/highlightjs/8.0/styles/github.min.css">
<link rel="stylesheet" href="../default.css">
<script src="http://yandex.st/highlightjs/8.0/highlight.min.js"></script>
<script>hljs.configure( { languages: ['perl'] } ); hljs.initHighlightingOnLoad();</script>
</head>
<body class='pod'>
<!--
  generated by My::Pod v,
  using Pod::Simple::PullParser v3.28,
  under Perl v5.018002 at Sat Sep 27 10:05:32 2014 GMT.

 If you want to change this HTML document, you probably shouldn't do that
   by changing it directly.  Instead, see about changing the calling options
   to My::Pod, and/or subclassing My::Pod,
   then reconverting this document from the Pod source.
   When in doubt, email the author of My::Pod for advice.
   See 'perldoc My::Pod' for more info.

-->

<!-- start doc -->
<a name='___top' class='dummyTopAnchor' ></a>

<div class='indexgroup'>
<ul   class='indexList indexList1'>
  <li class='indexItem indexItem1'><a href='#TITLE'>TITLE</a>
  <li class='indexItem indexItem1'><a href='#AUTHORS'>AUTHORS</a>
  <li class='indexItem indexItem1'><a href='#VERSION'>VERSION</a>
  <li class='indexItem indexItem1'><a href='#One-pass_parsing'>One-pass parsing</a>
  <li class='indexItem indexItem1'><a href='#Lexical_Conventions'>Lexical Conventions</a>
  <ul   class='indexList indexList2'>
    <li class='indexItem indexItem2'><a href='#Unicode_Semantics'>Unicode Semantics</a>
    <li class='indexItem indexItem2'><a href='#Bracketing_Characters'>Bracketing Characters</a>
    <li class='indexItem indexItem2'><a href='#Multiline_Comments'>Multiline Comments</a>
    <li class='indexItem indexItem2'><a href='#Single-line_Comments'>Single-line Comments</a>
    <li class='indexItem indexItem2'><a href='#Embedded_Comments'>Embedded Comments</a>
    <li class='indexItem indexItem2'><a href='#User-selected_Brackets'>User-selected Brackets</a>
    <li class='indexItem indexItem2'><a href='#Unspaces'>Unspaces</a>
    <li class='indexItem indexItem2'><a href='#Comments_in_Unspaces_and_vice_versa'>Comments in Unspaces and vice versa</a>
    <li class='indexItem indexItem2'><a href='#Optional_Whitespace_and_Exclusions'>Optional Whitespace and Exclusions</a>
    <ul   class='indexList indexList3'>
      <li class='indexItem indexItem3'><a href='#Implicit_Topical_Method_Calls'>Implicit Topical Method Calls</a>
    </ul>
  </ul>
  <li class='indexItem indexItem1'><a href='#Built-In_Data_Types'>Built-In Data Types</a>
  <ul   class='indexList indexList2'>
    <li class='indexItem indexItem2'><a href='#The_P6opaque_Datatype'>The P6opaque Datatype</a>
    <li class='indexItem indexItem2'><a href='#Name_Equivalence_of_Types'>Name Equivalence of Types</a>
    <li class='indexItem indexItem2'><a href='#Properties_on_Objects'>Properties on Objects</a>
    <ul   class='indexList indexList3'>
      <li class='indexItem indexItem3'><a href='#Traits'>Traits</a>
    </ul>
    <li class='indexItem indexItem2'><a href='#Types_as_Constraints'>Types as Constraints</a>
    <li class='indexItem indexItem2'><a href='#Container_Types'>Container Types</a>
    <li class='indexItem indexItem2'><a href='#Nil'>Nil</a>
    <li class='indexItem indexItem2'><a href='#Type_Objects'>Type Objects</a>
    <li class='indexItem indexItem2'><a href='#Coercive_type_declarations'>Coercive type declarations</a>
    <li class='indexItem indexItem2'><a href='#Containers_of_Native_Types'>Containers of Native Types</a>
    <li class='indexItem indexItem2'><a href='#Methods_on_Arrays'>Methods on Arrays</a>
    <li class='indexItem indexItem2'><a href='#Built-in_Type_Conventions'>Built-in Type Conventions</a>
    <ul   class='indexList indexList3'>
      <li class='indexItem indexItem3'><a href='#The_.WHICH_Method_for_Value_Types'>The .WHICH Method for Value Types</a>
      <li class='indexItem indexItem3'><a href='#The_ObjAt_Type'>The ObjAt Type</a>
    </ul>
    <li class='indexItem indexItem2'><a href='#Variables_Containing_Undefined_Values'>Variables Containing Undefined Values</a>
    <li class='indexItem indexItem2'><a href='#The_HOW_Method'>The HOW Method</a>
    <li class='indexItem indexItem2'><a href='#Roles'>Roles</a>
    <li class='indexItem indexItem2'><a href='#Numeric_Types'>Numeric Types</a>
    <li class='indexItem indexItem2'><a href='#Infinity_and_NaN'>Infinity and NaN</a>
    <li class='indexItem indexItem2'><a href='#Strings%2C_the_Str_Type'>Strings, the Str Type</a>
    <ul   class='indexList indexList3'>
      <li class='indexItem indexItem3'><a href='#The_StrPos_Type'>The StrPos Type</a>
      <li class='indexItem indexItem3'><a href='#The_StrLen_Type'>The StrLen Type</a>
      <li class='indexItem indexItem3'><a href='#Units_of_Position_Arguments'>Units of Position Arguments</a>
      <li class='indexItem indexItem3'><a href='#Numeric_Coercion_of_StrPos_or_StrLen'>Numeric Coercion of StrPos or StrLen</a>
    </ul>
    <li class='indexItem indexItem2'><a href='#The_Buf_Type'>The Buf Type</a>
    <ul   class='indexList indexList3'>
      <li class='indexItem indexItem3'><a href='#Native_buf_Types'>Native buf Types</a>
    </ul>
    <li class='indexItem indexItem2'><a href='#The_Whatever_Object'>The Whatever Object</a>
    <ul   class='indexList indexList3'>
      <li class='indexItem indexItem3'><a href='#Autopriming_of_Unary_and_Binary_Operators_with_Whatever'>Autopriming of Unary and Binary Operators with Whatever</a>
      <li class='indexItem indexItem3'><a href='#The_WhateverCode_Types'>The WhateverCode Types</a>
      <li class='indexItem indexItem3'><a href='#Operators_with_idiosyncratic_Whatever'>Operators with idiosyncratic Whatever</a>
      <li class='indexItem indexItem3'><a href='#Non-closure-returning_Operators_with_*'>Non-closure-returning Operators with *</a>
      <li class='indexItem indexItem3'><a href='#The_HyperWhatever_Type'>The HyperWhatever Type</a>
    </ul>
    <li class='indexItem indexItem2'><a href='#Native_types'>Native types</a>
    <li class='indexItem indexItem2'><a href='#The_Mu_type'>The Mu type</a>
    <li class='indexItem indexItem2'><a href='#Undefined_types'>Undefined types</a>
    <li class='indexItem indexItem2'><a href='#Immutable_types'>Immutable types</a>
    <li class='indexItem indexItem2'><a href='#Mutable_types'>Mutable types</a>
    <li class='indexItem indexItem2'><a href='#Of_types'>Of types</a>
    <li class='indexItem indexItem2'><a href='#Container_types'>Container types</a>
    <li class='indexItem indexItem2'><a href='#Hierarchical_types'>Hierarchical types</a>
    <li class='indexItem indexItem2'><a href='#Parameter_types'>Parameter types</a>
    <li class='indexItem indexItem2'><a href='#Generic_types'>Generic types</a>
  </ul>
  <li class='indexItem indexItem1'><a href='#The_Cool_class_(and_package)'>The Cool class (and package)</a>
  <li class='indexItem indexItem1'><a href='#Names_and_Variables'>Names and Variables</a>
  <ul   class='indexList indexList2'>
    <li class='indexItem indexItem2'><a href='#Apostrophe_separator'>Apostrophe separator</a>
    <li class='indexItem indexItem2'><a href='#Sigils'>Sigils</a>
    <ul   class='indexList indexList3'>
      <li class='indexItem indexItem3'><a href='#Sigils_indicate_interface'>Sigils indicate interface</a>
      <li class='indexItem indexItem3'><a href='#No_intervening_whitespace'>No intervening whitespace</a>
    </ul>
    <li class='indexItem indexItem2'><a href='#Twigils'>Twigils</a>
    <li class='indexItem indexItem2'><a href='#Scope_declarators'>Scope declarators</a>
    <li class='indexItem indexItem2'><a href='#Invariant_sigils'>Invariant sigils</a>
    <li class='indexItem indexItem2'><a href='#List_stringification'>List stringification</a>
    <li class='indexItem indexItem2'><a href='#The_.perl_method'>The .perl method</a>
    <li class='indexItem indexItem2'><a href='#The_.gist_method'>The .gist method</a>
    <li class='indexItem indexItem2'><a href='#The_.fmt_method'>The .fmt method</a>
    <li class='indexItem indexItem2'><a href='#Subscripts'>Subscripts</a>
    <ul   class='indexList indexList3'>
      <li class='indexItem indexItem3'><a href='#Subscripts_have_list_context'>Subscripts have list context</a>
    </ul>
    <li class='indexItem indexItem2'><a href='#List_assignment_and_binding'>List assignment and binding</a>
    <li class='indexItem indexItem2'><a href='#Parcels'>Parcels</a>
    <li class='indexItem indexItem2'><a href='#Parcels%2C_parameters%2C_and_Captures'>Parcels, parameters, and Captures</a>
    <li class='indexItem indexItem2'><a href='#CaptureCursors'>CaptureCursors</a>
    <li class='indexItem indexItem2'><a href='#Signature_objects'>Signature objects</a>
    <li class='indexItem indexItem2'><a href='#Ampersand_and_invocation'>Ampersand and invocation</a>
    <li class='indexItem indexItem2'><a href='#Specifying_a_dispatch_candidate'>Specifying a dispatch candidate</a>
    <li class='indexItem indexItem2'><a href='#Multidimensional_slices_and_parcels'>Multidimensional slices and parcels</a>
    <li class='indexItem indexItem2'><a href='#Subscript_adverbs'>Subscript adverbs</a>
    <li class='indexItem indexItem2'><a href='#Combining_subscript_adverbs'>Combining subscript adverbs</a>
    <li class='indexItem indexItem2'><a href='#Numeric_and_boolean_context_of_hashes'>Numeric and boolean context of hashes</a>
    <li class='indexItem indexItem2'><a href='#List_sorting'>List sorting</a>
    <li class='indexItem indexItem2'><a href='#Special_variables'>Special variables</a>
    <li class='indexItem indexItem2'><a href='#Array_end_index'>Array end index</a>
  </ul>
  <li class='indexItem indexItem1'><a href='#Names'>Names</a>
  <ul   class='indexList indexList2'>
    <li class='indexItem indexItem2'><a href='#Package-qualified_names'>Package-qualified names</a>
    <li class='indexItem indexItem2'><a href='#Pseudo-packages'>Pseudo-packages</a>
    <li class='indexItem indexItem2'><a href='#Interpolating_into_names'>Interpolating into names</a>
    <li class='indexItem indexItem2'><a href='#Strict_lookup'>Strict lookup</a>
    <li class='indexItem indexItem2'><a href='#Direct_lookup'>Direct lookup</a>
    <li class='indexItem indexItem2'><a href='#Symbol_tables'>Symbol tables</a>
    <li class='indexItem indexItem2'><a href='#Dynamic_lookup'>Dynamic lookup</a>
    <li class='indexItem indexItem2'><a href='#DYNAMIC'>DYNAMIC</a>
    <li class='indexItem indexItem2'><a href='#Package_lookup'>Package lookup</a>
    <li class='indexItem indexItem2'><a href='#Globals'>Globals</a>
    <li class='indexItem indexItem2'><a href='#The_PROCESS_package'>The PROCESS package</a>
    <li class='indexItem indexItem2'><a href='#Dynamic_variable_creation'>Dynamic variable creation</a>
    <li class='indexItem indexItem2'><a href='#The_magic_input_handle'>The magic input handle</a>
    <li class='indexItem indexItem2'><a href='#Magical_access_to_documentation'>Magical access to documentation</a>
    <li class='indexItem indexItem2'><a href='#Magical_lexically_scoped_values'>Magical lexically scoped values</a>
    <li class='indexItem indexItem2'><a href='#The_COMPILING_pseudopackage'>The COMPILING pseudopackage</a>
    <li class='indexItem indexItem2'><a href='#Switching_parsers'>Switching parsers</a>
    <li class='indexItem indexItem2'><a href='#Slangs'>Slangs</a>
    <li class='indexItem indexItem2'><a href='#Extended_identifiers'>Extended identifiers</a>
  </ul>
  <li class='indexItem indexItem1'><a href='#Literals'>Literals</a>
  <ul   class='indexList indexList2'>
    <li class='indexItem indexItem2'><a href='#Underscores'>Underscores</a>
    <li class='indexItem indexItem2'><a href='#Radix_markers'>Radix markers</a>
    <li class='indexItem indexItem2'><a href='#General_radices'>General radices</a>
    <li class='indexItem indexItem2'><a href='#Exponentials'>Exponentials</a>
    <li class='indexItem indexItem2'><a href='#Conversion_functions'>Conversion functions</a>
    <li class='indexItem indexItem2'><a href='#Rational_literals'>Rational literals</a>
    <li class='indexItem indexItem2'><a href='#Complex_literals'>Complex literals</a>
    <li class='indexItem indexItem2'><a href='#Blob_literals'>Blob literals</a>
    <li class='indexItem indexItem2'><a href='#Radix_interpolation'>Radix interpolation</a>
    <li class='indexItem indexItem2'><a href='#Angle_quotes_(quote_words)'>Angle quotes (quote words)</a>
    <ul   class='indexList indexList3'>
      <li class='indexItem indexItem3'><a href='#Explicit_Parcel_construction'>Explicit Parcel construction</a>
      <li class='indexItem indexItem3'><a href='#Empty_Parcel'>Empty Parcel</a>
      <li class='indexItem indexItem3'><a href='#Disallowed_forms'>Disallowed forms</a>
      <li class='indexItem indexItem3'><a href='#Relationship_between_%3C%3E_and_%C2%AB%C2%BB'>Relationship between &#60;&#62; and &#171;&#187;</a>
    </ul>
    <li class='indexItem indexItem2'><a href='#Adverbial_Pair_forms'>Adverbial Pair forms</a>
    <li class='indexItem indexItem2'><a href='#Q_forms'>Q forms</a>
    <li class='indexItem indexItem2'><a href='#Adverbs_on_quotes'>Adverbs on quotes</a>
    <li class='indexItem indexItem2'><a href='#The_%3Aval_modifier'>The :val modifier</a>
    <li class='indexItem indexItem2'><a href='#Whitespace_before_adverbs'>Whitespace before adverbs</a>
    <li class='indexItem indexItem2'><a href='#Delimiters_of_quoting_forms'>Delimiters of quoting forms</a>
    <li class='indexItem indexItem2'><a href='#Quotes_from_Macros'>Quotes from Macros</a>
    <li class='indexItem indexItem2'><a href='#Interpolating_into_a_single-quoted_string'>Interpolating into a single-quoted string</a>
    <li class='indexItem indexItem2'><a href='#Interpolation_rules'>Interpolation rules</a>
    <ul   class='indexList indexList3'>
      <li class='indexItem indexItem3'><a href='#Arrays'>Arrays</a>
      <li class='indexItem indexItem3'><a href='#Hashes'>Hashes</a>
      <li class='indexItem indexItem3'><a href='#Sub_calls'>Sub calls</a>
      <li class='indexItem indexItem3'><a href='#Method_calls'>Method calls</a>
      <li class='indexItem indexItem3'><a href='#Multiple_dereferencers'>Multiple dereferencers</a>
      <li class='indexItem indexItem3'><a href='#Closures'>Closures</a>
      <li class='indexItem indexItem3'><a href='#Twigils'>Twigils</a>
      <li class='indexItem indexItem3'><a href='#Other_expressions'>Other expressions</a>
      <li class='indexItem indexItem3'><a href='#Class_methods'>Class methods</a>
      <li class='indexItem indexItem3'><a href='#Old_disambiguation'>Old disambiguation</a>
      <li class='indexItem indexItem3'><a href='#Topical_methods'>Topical methods</a>
      <li class='indexItem indexItem3'><a href='#Function_calls'>Function calls</a>
      <li class='indexItem indexItem3'><a href='#Backslash_sequences'>Backslash sequences</a>
      <li class='indexItem indexItem3'><a href='#Other_functions'>Other functions</a>
      <li class='indexItem indexItem3'><a href='#Unicode_codepoints'>Unicode codepoints</a>
      <li class='indexItem indexItem3'><a href='#Backslashing'>Backslashing</a>
    </ul>
    <li class='indexItem indexItem2'><a href='#Bare_identifiers'>Bare identifiers</a>
    <li class='indexItem indexItem2'><a href='#Dereferences'>Dereferences</a>
    <li class='indexItem indexItem2'><a href='#Hash_subscripts_and_bare_keys'>Hash subscripts and bare keys</a>
    <li class='indexItem indexItem2'><a href='#Double-underscore_forms'>Double-underscore forms</a>
    <li class='indexItem indexItem2'><a href='#Heredocs'>Heredocs</a>
    <ul   class='indexList indexList3'>
      <li class='indexItem indexItem3'><a href='#Optional_whitespace'>Optional whitespace</a>
      <li class='indexItem indexItem3'><a href='#One-pass_heredoc_parsing'>One-pass heredoc parsing</a>
    </ul>
    <li class='indexItem indexItem2'><a href='#Version_literals'>Version literals</a>
    <li class='indexItem indexItem2'><a href='#Allomorphic_value_semantics'>Allomorphic value semantics</a>
    <ul   class='indexList indexList3'>
      <li class='indexItem indexItem3'><a href='#Allomorphic_Rats'>Allomorphic Rats</a>
    </ul>
  </ul>
  <li class='indexItem indexItem1'><a href='#Context'>Context</a>
  <li class='indexItem indexItem1'><a href='#Lists'>Lists</a>
  <ul   class='indexList indexList2'>
    <li class='indexItem indexItem2'><a href='#Lazy_flattening'>Lazy flattening</a>
    <li class='indexItem indexItem2'><a href='#list%2C_flat%2C_item%2C_and_.tree'>list, flat, item, and .tree</a>
    <li class='indexItem indexItem2'><a href='#Forcing_capture_context'>Forcing capture context</a>
    <li class='indexItem indexItem2'><a href='#The_eager_operator'>The eager operator</a>
    <li class='indexItem indexItem2'><a href='#The_hyper_operator'>The hyper operator</a>
    <li class='indexItem indexItem2'><a href='#The_race_operator'>The race operator</a>
    <li class='indexItem indexItem2'><a href='#The_%3D%3E_operator'>The =&#62; operator</a>
    <li class='indexItem indexItem2'><a href='#The_.._operator'>The .. operator </a>
    <li class='indexItem indexItem2'><a href='#Hash_assignment'>Hash assignment</a>
    <li class='indexItem indexItem2'><a href='#The_anonymous_enum_function'>The anonymous enum function</a>
    <li class='indexItem indexItem2'><a href='#Hash_binding'>Hash binding</a>
  </ul>
  <li class='indexItem indexItem1'><a href='#Files'>Files</a>
  <li class='indexItem indexItem1'><a href='#Grammatical_Categories'>Grammatical Categories</a>
  <li class='indexItem indexItem1'><a href='#Deprecations'>Deprecations</a>
</ul>
</div>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="TITLE"
>TITLE</a></h1>

<p>Synopsis 2: Bits and Pieces</p>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="AUTHORS"
>AUTHORS</a></h1>

<pre><code>Larry Wall &#60;larry@wall.org&#62;</code></pre>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="VERSION"
>VERSION</a></h1>

<pre><code>Created: 10 Aug 2004

Last Modified: 2 Sept 2014
Version: 285</code></pre>

<p>This document summarizes Apocalypse 2, which covers small-scale lexical items and typological issues. (These Synopses also contain updates to reflect the evolving design of Perl 6 over time, unlike the Apocalypses, which are frozen in time as &#34;historical documents&#34;. These updates are not marked--if a Synopsis disagrees with its Apocalypse, assume the Synopsis is correct.)</p>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="One-pass_parsing"
>One-pass parsing</a></h1>

<p>To the extent allowed by sublanguages&#39; parsers, Perl is parsed using a one-pass, predictive parser. That is, lookahead of more than one &#34;longest token&#34; is discouraged. The currently known exceptions to this are where the parser must:</p>

<ul>
<li>Locate the end of interpolated expressions that begin with a sigil and might or might not end with brackets.</li>

<li>Recognize that a reduce operator is not really beginning a <code>[...]</code> composer.</li>
</ul>

<p>One-pass parsing is fundamental to knowing exactly which language you are dealing with at any moment, which in turn is fundamental to allowing unambiguous language mutation in any desired direction. (Generic languages are allowed, but only if intended; accidentally generic languages lead to loss of linguistic identity and integrity. This is the hard lesson of Perl 5&#39;s source filters and other multi-pass parsing mistakes.)</p>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="Lexical_Conventions"
>Lexical Conventions</a></h1>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="Unicode_Semantics"
>Unicode Semantics</a></h2>

<p>In the abstract, Perl is written in Unicode, and has consistent Unicode semantics regardless of the underlying text representations. By default Perl presents Unicode in &#34;NFG&#34; formation, where each grapheme counts as one character. A grapheme is what the novice user would think of as a character in their normal everyday life, including any diacritics.</p>

<p>Perl can count Unicode line and paragraph separators as line markers, but that behavior had better be configurable so that Perl&#39;s idea of line numbers matches what your editor thinks about Unicode lines.</p>

<p>Unicode horizontal whitespace is counted as whitespace, but it&#39;s better not to use thin spaces where they will make adjoining tokens look like a single token. On the other hand, Perl doesn&#39;t use indentation as syntax, so you are free to use any amount of whitespace anywhere that whitespace makes sense. Comments always count as whitespace.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="Bracketing_Characters"
>Bracketing Characters</a></h2>

<p>For some syntactic purposes, Perl distinguishes bracketing characters from non-bracketing. Bracketing characters are defined as any Unicode characters with either bidirectional mirrorings or Ps/Pe/Pi/Pf properties.</p>

<p>In practice, though, you&#39;re safest using matching characters with Ps/Pe/Pi/Pf properties, though ASCII angle brackets are a notable exception, since they&#39;re bidirectional but not in the Ps/Pe/Pi/Pf sets.</p>

<p>Characters with no corresponding closing character do not qualify as opening brackets. This includes the second section of the Unicode BidiMirroring data table.</p>

<p>If a character is already used in Ps/Pe/Pi/Pf mappings, then any entry in BidiMirroring is ignored (both forward and backward mappings). For any given Ps character, the next Pe codepoint (in numerical order) is assumed to be its matching character even if that is not what you might guess using left-right symmetry. Therefore <code>U+298D</code> maps to <code>U+298E</code>, not <code>U+2990</code>, and <code>U+298F</code> maps to <code>U+2990</code>, not <code>U+298E</code>. Neither <code>U+298E</code> nor <code>U+2990</code> are valid bracket openers, despite having reverse mappings in the BidiMirroring table.</p>

<p>The <code>U+301D</code> codepoint has two closing alternatives, <code>U+301E</code> and <code>U+301F</code>; Perl 6 only recognizes the one with lower code point number, <code>U+301E</code>, as the closing brace. This policy also applies to new one-to-many mappings introduced in the future.</p>

<p>However, many-to-one mappings are fine; multiple opening characters may map to the same closing character. For instance, <code>U+2018</code>, <code>U+201A</code>, and <code>U+201B</code> may all be used as the opener for the <code>U+2019</code> closer. Constructs that count openers and closers assume that only the given opener is special. That is, if you open with one of the alternatives, all other alternatives are treated as non-bracketing characters within that construct.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="Multiline_Comments"
>Multiline Comments</a></h2>

<p>Pod sections may be used reliably as multiline comments in Perl 6. Unlike in Perl 5, Pod syntax now lets you use <code>=begin comment</code> and <code>=end comment</code> to delimit a Pod block correctly without the need for <code>=cut</code>. (In fact, <code>=cut</code> is now gone.) The format name does not have to be <code>comment</code> -- any unrecognized format name will do to make it a comment. (However, bare <code>=begin</code> and <code>=end</code> probably aren&#39;t good enough, because all comments in them will show up in the formatted output.)</p>

<p>We have single paragraph comments with <code>=for comment</code> as well. That lets <code>=for</code> keep its meaning as the equivalent of a <code>=begin</code> and <code>=end</code> combined. As with <code>=begin</code> and <code>=end</code>, a comment started in code reverts to code afterwards.</p>

<p>Since there is a newline before the first <code>=</code>, the Pod form of comment counts as whitespace equivalent to a newline. See S26 for more on embedded documentation.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="Single-line_Comments"
>Single-line Comments</a></h2>

<p>Except within a quote literal, a <code>#</code> character always introduces a comment in Perl 6. There are two forms of comment based on <code>#</code>. Embedded comments require the <code>#</code> to be followed by a backtick (<code>`</code>) plus one or more opening bracketing characters.</p>

<p>All other uses of <code>#</code> are interpreted as single-line comments that work just as in Perl 5, starting with a <code>#</code> character and ending at the subsequent newline. They count as whitespace equivalent to newline for purposes of separation. Unlike in Perl 5, <code>#</code> may <i>not</i> be used as the delimiter in quoting constructs.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="Embedded_Comments"
>Embedded Comments</a></h2>

<p>Embedded comments are supported as a variant on quoting syntax, introduced by <code>#`</code> plus any user-selected bracket characters (as defined in <a href="#Bracketing_Characters" class="podlinkpod"
>&#34;Bracketing Characters&#34;</a> above):</p>

<pre><code>say #`( embedded comment ) &#34;hello, world!&#34;;

$object\#`{ embedded comments }.say;

$object\ #`&#12300;
    embedded comments
&#12301;.say;</code></pre>

<p>Brackets may be nested, following the same policy as ordinary quote brackets.</p>

<p>There must be no space between the <code>#`</code> and the opening bracket character. (There may be the <i>visual appearance</i> of space for some double-wide characters, however, such as the corner quotes above.)</p>

<p>For multiline comments it is recommended (but not required) to use two or more brackets both for visual clarity and to avoid relying too much on internal bracket counting heuristics when commenting code that may accidentally miscount single brackets:</p>

<pre><code>#`{{
    say &#34;here is an unmatched } character&#34;;
}}</code></pre>

<p>However, it&#39;s sometimes better to use Pod comments because they are implicitly line-oriented.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="User-selected_Brackets"
>User-selected Brackets</a></h2>

<p>For all quoting constructs that use user-selected brackets, you can open with multiple identical bracket characters, which must be closed by the same number of closing brackets. Counting of nested brackets applies only to pairs of brackets of the same length as the opening brackets:</p>

<pre><code>say #`{{
    This comment contains unmatched } and { { { {   (ignored)
    Plus a nested {{ ... }} pair                    (counted)
}} q&#60;&#60; &#60;&#60;woot&#62;&#62; &#62;&#62;   # says &#34; &#60;&#60;woot&#62;&#62; &#34;</code></pre>

<p>Note however that bare circumfix or postcircumfix <code>&#60;&#60;...&#62;&#62;</code> is not a user-selected bracket, but the ASCII variant of the <code>&#171;...&#187;</code> interpolating word list. Only <code>#`</code> and the <code>q</code>-style quoters (including <code>m</code>, <code>s</code>, <code>tr</code>, and <code>rx</code>) enable subsequent user-selected brackets.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="Unspaces"
>Unspaces</a></h2>

<p>Some languages such as C allow you to escape newline characters to combine lines. Other languages (such as regexes) allow you to backslash a space character for various reasons. Perl 6 generalizes this notion to any kind of whitespace. Any contiguous whitespace (including comments) may be hidden from the parser by prefixing it with <code>\</code>. This is known as the &#34;unspace&#34;. An unspace can suppress any of several whitespace dependencies in Perl. For example, since Perl requires an absence of whitespace between a noun and a postfix operator, using unspace lets you line up postfix operators:</p>

<pre><code>%hash\  {$key}
@array\ [$ix]
$subref\($arg)</code></pre>

<p>As a special case to support the use above, a backslash where a postfix is expected is considered a degenerate form of unspace. Note that whitespace is not allowed before that, hence</p>

<pre><code>$subref \($arg)</code></pre>

<p>is a syntax error (two terms in a row). And</p>

<pre><code>foo \($arg)</code></pre>

<p>will be parsed as a list operator with a <code>Capture</code> argument:</p>

<pre><code>foo(\($arg))</code></pre>

<p>However, other forms of unspace may usefully be preceded by whitespace. (Unary uses of backslash may therefore never be followed by whitespace or they would be taken as an unspace.)</p>

<p>Other postfix operators may also make use of unspace:</p>

<pre><code>$number\  ++;
$number\  --;
1+3\      i;
$object\  .say();
$object\#`{ your ad here }.say</code></pre>

<p>Another normal use of a you-don&#39;t-see-this-space is typically to put a dotted postfix on the next line:</p>

<pre><code>$object\ # comment
.say

$object\#`[ comment
].say

$object\
.say</code></pre>

<p>But unspace is mainly about language extensibility: it lets you continue the line in any situation where a newline might confuse the parser, regardless of your currently installed parser. (Unless, of course, you override the unspace rule itself...)</p>

<p>Although we say that the unspace hides the whitespace from the parser, it does not hide whitespace from the lexer. As a result, unspace is not allowed within a token. Additionally, line numbers are still counted if the unspace contains one or more newlines. Since Pod chunks count as whitespace to the language, they are also swallowed up by unspace. Heredoc boundaries are suppressed, however, so you can split excessively long heredoc intro lines like this:</p>

<pre><code>ok(q:to&#39;CODE&#39;, q:to&#39;OUTPUT&#39;, \
&#34;Here is a long description&#34;, \ # --more--
todo(:parr&#248;t&#60;0.42&#62;, :d&#246;tnet&#60;1.2&#62;));
    ...
    CODE
    ...
    OUTPUT</code></pre>

<p>To the heredoc parser that just looks like:</p>

<pre><code>ok(q:to&#39;CODE&#39;, q:to&#39;OUTPUT&#39;, &#34;Here is a long description&#34;, todo(:parr&#248;t&#60;0.42&#62;, :d&#246;tnet&#60;1.2&#62;));
    ...
    CODE
    ...
    OUTPUT</code></pre>

<p>Note that this is one of those cases in which it is fine to have whitespace before the unspace, since we&#39;re only trying to suppress the newline transition, not all whitespace as in the case of postfix parsing. (Note also that the example above is not meant to spec how the test suite works. )</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="Comments_in_Unspaces_and_vice_versa"
>Comments in Unspaces and vice versa</a></h2>

<p>An unspace may contain a comment, but a comment may not contain an unspace. In particular, end-of-line comments do not treat backslash as significant. If you say:</p>

<pre><code>#`\ (...</code></pre>

<p>or</p>

<pre><code>#\ `(...</code></pre>

<p>it is an end-of-line comment, not an embedded comment. Write:</p>

<pre><code>\ #`(
     ...
    )</code></pre>

<p>to mean the other thing.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="Optional_Whitespace_and_Exclusions"
>Optional Whitespace and Exclusions</a></h2>

<p>In general, whitespace is optional in Perl 6 except where it is needed to separate constructs that would be misconstrued as a single token or other syntactic unit. (In other words, Perl 6 follows the standard <i>longest-token</i> principle, or in the cases of large constructs, a <i>prefer shifting to reducing</i> principle. See <a href="#Grammatical_Categories" class="podlinkpod"
>&#34;Grammatical Categories&#34;</a> below for more on how a Perl program is analyzed into tokens.)</p>

<p>This is an unchanging deep rule, but the surface ramifications of it change as various operators and macros are added to or removed from the language, which we expect to happen because Perl 6 is designed to be a mutable language. In particular, there is a natural conflict between postfix operators and infix operators, either of which may occur after a term. If a given token may be interpreted as either a postfix operator or an infix operator, the infix operator requires space before it. Postfix operators may never have intervening space, though they may have an intervening dot. If further separation is desired, an unspace or embedded comment may be used as described above, as long as no whitespace occurs outside the unspace or embedded comment.</p>

<p>For instance, if you were to add your own <code>infix:&#60;++&#62;</code> operator, then it must have space before it. The normal autoincrementing <code>postfix:&#60;++&#62;</code> operator may never have space before it, but may be written in any of these forms:</p>

<pre><code>$x++

$x\++

$x.++

$x\ ++

$x\ .++

$x\#`( comment ).++
$x\#`((( comment ))).++

$x\
.++

$x\         # comment
            # inside unspace
.++

$x\         # comment
            # inside unspace
++          # (but without the optional postfix dot)

$x\#`&#12302;      comment
            more comment
&#12303;.++

$x\#`[   comment 1
comment 2
=begin Podstuff
whatever (Pod comments ignore current parser state)
=end Podstuff
comment 3
].++</code></pre>

<h3><a class='u' href='#___top' title='click to go to top of document'
name="Implicit_Topical_Method_Calls"
>Implicit Topical Method Calls</a></h3>

<p>A consequence of the postfix rule is that (except when delimiting a quote or terminating an unspace) a dot with whitespace in front of it is always considered a method call on <code>$_</code> where a term is expected. If a term is not expected at this point, it is a syntax error. (Unless, of course, there is an infix operator of that name beginning with dot. You could, for instance, define a Fortranly <code>infix:&#60;.EQ.&#62;</code> if the fit took you. But you&#39;ll have to be sure to always put whitespace in front of it, or it would be interpreted as a postfix method call instead.)</p>

<p>For example,</p>

<pre><code>foo .method</code></pre>

<p>and</p>

<pre><code>foo
.method</code></pre>

<p>will always be interpreted as</p>

<pre><code>foo $_.method</code></pre>

<p>but never as</p>

<pre><code>foo.method</code></pre>

<p>Use some variant of</p>

<pre><code>foo\
.method</code></pre>

<p>if you mean the postfix method call.</p>

<p>One consequence of all this is that you may no longer write a Num as <code>42.</code> with just a trailing dot. You must instead say either <code>42</code> or <code>42.0</code>. In other words, a dot following a number can only be a decimal point if the following character is a digit. Otherwise the postfix dot will be taken to be the start of some kind of method call syntax. (The <code>.123</code> form with a leading dot is still allowed however when a term is expected, and is equivalent to <code>0.123</code> rather than <code>$_.123</code>.)</p>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="Built-In_Data_Types"
>Built-In Data Types</a></h1>

<p>Perl 6 has an optional type system that helps you write safer code that performs better. The compiler is free to infer what type information it can from the types you supply, but it will not complain about missing type information unless you ask it to.</p>

<p>Perl 6 is an OO engine, but you&#39;re not generally required to think in OO when that&#39;s inconvenient. However, some built-in concepts such as filehandles are more object-oriented in a user-visible way than in Perl 5.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="The_P6opaque_Datatype"
>The P6opaque Datatype</a></h2>

<p>In support of OO encapsulation, there is a new fundamental data representation: <b>P6opaque</b>. External access to opaque objects is always through method calls, even for attributes.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="Name_Equivalence_of_Types"
>Name Equivalence of Types</a></h2>

<p>Types are officially compared using name equivalence rather than structural equivalence. However, we&#39;re rather liberal in what we consider a name. For example, the name includes the version and authority associated with the module defining the type (even if the type itself is &#34;anonymous&#34;). Beyond that, when you instantiate a parametric type, the arguments are considered part of the &#34;long name&#34; of the resulting type, so one <code>Array of Int</code> is equivalent to another <code>Array of Int</code>. (Another way to look at it is that the type instantiation &#34;factory&#34; is memoized.) Typename aliases are considered equivalent to the original type. In particular, the <code>Array of Int</code> syntax is just sugar for <code>Array:of(Int)</code>, which is the canonical form of an instantiated generic type.</p>

<p>This name equivalence of parametric types extends only to parameters that can be considered immutable (or that at least can have an immutable snapshot taken of them). Two distinct classes are never considered equivalent even if they have the same attributes because classes are not considered immutable.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="Properties_on_Objects"
>Properties on Objects</a></h2>

<p>Perl 6 supports the notion of <b>properties</b> on various kinds of objects. Properties are like object attributes, except that they&#39;re managed by the individual object rather than by the object&#39;s class.</p>

<p>According to S12, properties are actually implemented by a kind of mixin mechanism, and such mixins are accomplished by the generation of an individual anonymous class for the object (unless an identical anonymous class already exists and can safely be shared).</p>

<h3><a class='u' href='#___top' title='click to go to top of document'
name="Traits"
>Traits</a></h3>

<p>Properties applied to objects constructed at compile-time, such as variables and classes, are also called <b>traits</b>. Traits cannot be changed at run-time. Changes to run-time properties are done via mixin instead, so that the compiler can optimize based on declared traits.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="Types_as_Constraints"
>Types as Constraints</a></h2>

<p>A variable&#39;s type is a constraint indicating what sorts of values the variable may contain. More precisely, it&#39;s a promise that the object or objects contained in the variable are capable of responding to the methods of the indicated &#34;role&#34;. See S12 for more about roles.</p>

<pre><code># $x can contain only Int objects
my Int $x;</code></pre>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="Container_Types"
>Container Types</a></h2>

<p>A variable may itself be bound to a container type that specifies how the container works, without specifying what kinds of things it contains.</p>

<pre><code># $x is implemented by the MyScalar class
my $x is MyScalar;</code></pre>

<p>Constraints and container types can be used together:</p>

<pre><code># $x can contain only Int objects,
# and is implemented by the MyScalar class
my Int $x is MyScalar;</code></pre>

<p>Note that <code>$x</code> is also initialized to the <code>Int</code> type object. See below for more on this.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="Nil"
>Nil</a></h2>

<p>There is a special value named <code>Nil</code>. It means &#34;there is no value here&#34;. It is a little bit like the empty <code>()</code> list, insofar as both represent an absence of values, except that <code>()</code> is defined and means &#34;there are 0 arguments here if you&#39;re counting that low&#34;. The <code>Nil</code> value represents the absence of a value where there <i>should</i> be one, so it does not disappear in list context, but relies on something downstream to catch it or blow up. <code>Nil</code> also indicates a failed match.</p>

<p>Since method calls are performed directly on any object, <code>Nil</code> can respond to certain method calls. <code>Nil.defined</code> returns <code>False</code> (whereas <code>().defined</code> returns <code>True</code>). <code>Nil.so</code> also returns <code>False</code>. <code>Nil.ACCEPTS</code> always returns <code>Nil</code>. <code>Nil.perl</code> and <code>Nil.gist</code> return <code>&#39;Nil&#39;</code>. <code>Nil.Stringy</code> and <code>Nil.Str</code> throw a resumable warning that returns a value of <code>&#39;&#39;</code> on resumption. <code>Nil.Numeric</code> likewise throws a resumable warning that returns 0 on resumption. Any undefined method call on <code>Nil</code> returns <code>Nil</code>, so that <code>Nil</code> propagates down method call chains. Likewise any subscripting operation on <code>Nil</code> returns <code>Nil</code>.</p>

<p>Any attempt to change the <code>Nil</code> value should cause an exception to be thrown.</p>

<p>Assigning <code>Nil</code> to any scalar container causes the container to throw out any contents and restore itself to an uninitialized state (after which it will appear to contain an object appropriate to the declared default of the container, where <code>Any</code> is the default default; the element may be simply deleted if that&#39;s how the default can be represented in the structure). Binding of <code>Nil</code> with <code>:=</code> simply puts Nil in the container. However, binding <code>Nil</code> to a parameter (<code>::=</code> semantics) works more like assignment; passing <code>Nil</code> to a parameter with a default causes that parameter to be set to its default value rather than an undefined value, as if the argument had not been supplied.</p>

<p>Assigning <code>Nil</code> to any entire composite container (such as an <code>Array</code> or <code>Hash</code>) empties the container, resetting it back to an uninitialized state. The container object itself then becomes undefined. (Assignment of <code>()</code> leaves it defined.)</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="Type_Objects"
>Type Objects</a></h2>

<p><code>my Dog $spot</code> by itself does not automatically call a <code>Dog</code> constructor. It merely assigns an undefined <code>Dog</code> prototype object to <code>$spot</code>:</p>

<pre><code>my Dog $spot;           # $spot is initialized with ::Dog
my Dog $spot = Dog;     # same thing

$spot.defined;          # False
say $spot;              # &#34;Dog()&#34;</code></pre>

<p>Any type name used as a value is the undefined prototype object of that type, or <i>type object</i> for short. See S12 for more on that.</p>

<p>Any type name in rvalue context is parsed as a single type value and expects no arguments following it. However, a type object responds to the function call interface, so you may use the name of a type with parentheses as if it were a function, and any argument supplied to the call is coerced to the type indicated by the type object. If there is no argument in the parentheses, the type object returns itself:</p>

<pre><code>my $type = Num;             # type object as a value
$num = $type($string)       # coerce to Num</code></pre>

<p>To get a real <code>Dog</code> object, call a constructor method such as <code>new</code>:</p>

<pre><code>my Dog $spot .= new;
my Dog $spot = $spot.new;   # .= is rewritten into this</code></pre>

<p>You can pass in arguments to the constructor as well:</p>

<pre><code>my Dog $cerberus .= new(heads =&#62; 3);
my Dog $cerberus = $cerberus.new(heads =&#62; 3);   # same thing</code></pre>

<p>Just like <a href="#Nil" class="podlinkpod"
>&#34;Nil&#34;</a>, type objects do not disappear in list context, but rely on something downstream to catch it or blow up. This allows type objects to be assigned to scalars, but to disappear in non-scalar contexts.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="Coercive_type_declarations"
>Coercive type declarations</a></h2>

<p>The parenthesized form of type coercion may be used in declarations where it makes sense to accept a wider set of types but coerce them to a narrow type. (This only works for one-way coercion, so you may not declare any <code>rw</code> parameter with a coercive type.) The type outside the parens indicates the desired end result, and subsequent code may depend on it being that type. The type inside the parens indicates the acceptable set of types that are allowed to be bound or assigned to this location via coercion. If the wide type is omitted, <code>Any</code> is assumed. In any case, the wide type is only indicative of permission to coerce; there must still be an available coercion routine from the wide type to the narrow type to actually perform the coercion.</p>

<pre><code>sub foo (Str(Any) $y) {...}
sub foo (Str()    $y) {...}    # same thing

my Num(Cool) $x = prompt &#34;Gimme a number&#34;;</code></pre>

<p>Coercions may also be specified on the return type:</p>

<pre><code>sub bar ($x, $y --&#62; Int()) { return 3.5 }  # returns 3</code></pre>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="Containers_of_Native_Types"
>Containers of Native Types</a></h2>

<p>If you say</p>

<pre><code>my int @array is MyArray;</code></pre>

<p>you are declaring that the elements of <code>@array</code> are native integers, but that the array itself is implemented by the <code>MyArray</code> class. Untyped arrays and hashes are still perfectly acceptable, but have the same performance issues they have in Perl 5.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="Methods_on_Arrays"
>Methods on Arrays</a></h2>

<p>To get the number of elements in an array, use the <code>.elems</code> method. You can also ask for the total string length of an array&#39;s elements, in codepoints or graphemes, using these methods, <code>.codes</code> or <code>.graphs</code> respectively on the array. The same methods apply to strings as well. (Note that <code>.codes</code> is not well-defined unless you know which canonicalization is in effect. Hence, it allows an optional argument to specify the meaning exactly if it cannot be known from context.)</p>

<p>There is no <code>.length</code> method for either arrays or strings, because <code>length</code> does not specify a unit.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="Built-in_Type_Conventions"
>Built-in Type Conventions</a></h2>

<p>Built-in object types start with an uppercase letter. This includes immutable types (e.g. <code>Int</code>, <code>Num</code>, <code>Complex</code>, <code>Rat</code>, <code>Str</code>, <code>Bit</code>, <code>Regex</code>, <code>Set</code>, <code>Block</code>, <code>Iterator</code>), as well as mutable (container) types, such as <code>Scalar</code>, <code>Array</code>, <code>Hash</code>, <code>Buf</code>, <code>Routine</code>, <code>Module</code>, and non-instantiable Roles such as <code>Callable</code> and <code>Integral</code>.</p>

<p>Non-object (native) types are lowercase: <code>int</code>, <code>num</code>, <code>complex</code>, <code>rat</code>, <code>buf</code>, <code>bit</code>. Native types are primarily intended for declaring compact array storage, that is, a sequence of storage locations of the specified type laid out in memory contiguously without pointer indirection. However, Perl will try to make those look like their corresponding uppercase types if you treat them that way. (In other words, it does autoboxing and autounboxing as necessary. Note, however, that repeated autoboxing and unboxing can make your program much slower, compared to a program that makes consistent use of either native types or object types.)</p>

<h3><a class='u' href='#___top' title='click to go to top of document'
name="The_.WHICH_Method_for_Value_Types"
>The <code>.WHICH</code> Method for Value Types</a></h3>

<p>Some object types can behave as value types. Every object can produce a &#34;WHICH&#34; value that uniquely identifies the object for hashing and other value-based comparisons. Normal objects some kind of unique ID as their identity, but if a class wishes to behave as a value type, it can define a <code>.WHICH</code> method that makes different objects look like the same object if they happen to have the same contents.</p>

<h3><a class='u' href='#___top' title='click to go to top of document'
name="The_ObjAt_Type"
>The <code>ObjAt</code> Type</a></h3>

<p>When we say that a normal object uses its location as its identity, we do <i>not</i> mean that it returns its address as a number. In the first place, not all objects are in the same memory space (see the literature on NUMA, for instance), and two objects should not accidentally have the same identity merely because they were stored at the same offset in two different memory spaces. We also do not want to allow accidental identity collisions with values that really are numbers (or strings, or any other mundane value type). Nor should we be encouraging people to think of object locations that way in any case. So <code>WHICH</code> still returns a value rather than another object, but that value must be of a special <code>ObjAt</code> type that prevents accidental confusion with normal value types, and at least discourages trivial pointer arithmetic.</p>

<p>Certainly, it is difficult to give a unique name to every possible address space, let alone every possible address within every such a space. In the absence of a universal naming scheme, it can only be made improbable that two addresses from two different spaces will collide. A sufficiently large random number may represent the current address space on output of an <code>ObjAt</code> to a different address space, or if serialized to YAML or XML. (This extra identity component need not be output for debugging messages that assume the current address space, since it will be the same big number consistently, unless your process really is running under a NUMA.)</p>

<p>Alternately, if an object is being serialized to a form that does not preserve object identity, there is no requirement to preserve uniqueness, since in this case the object is really being translated to a value type representation, and reconstituted on the other end as a different unique object.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="Variables_Containing_Undefined_Values"
>Variables Containing Undefined Values</a></h2>

<p>A variable with a non-native type constraint may contain an <i>undefined</i> value such as a type object, provided the undefined value meets the type constraint.</p>

<pre><code>my Int $x = Int;  # works
my Buf $x = Buf8; # works</code></pre>

<p>Variables with native types do not support undefinedness: it is an error to assign an undefined value to them:</p>

<pre><code>my int $y = Int;    # dies</code></pre>

<p>Since <code>num</code> can support the value <code>NaN</code> but not the general concept of undefinedness, you can coerce an undefined value like this:</p>

<pre><code>my num $n = computation() // NaN;</code></pre>

<p>Variables of non-native types start out containing a type object of the appropriate type unless explicitly initialized to a defined value.</p>

<p>Any container&#39;s default may be overridden by the <code>is default(VALUE)</code> trait. If the container&#39;s contents are deleted, the value is notionally set to the provided default value; this value may or may not be physically represented in memory, depending on the implementation of the container. You should officially not care about that (much).</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="The_HOW_Method"
>The <code>HOW</code> Method</a></h2>

<p>Every object supports a <code>HOW</code> function/method that returns the metaclass instance managing it, regardless of whether the object is defined:</p>

<pre><code>&#39;x&#39;.HOW.methods(&#39;x&#39;);   # get available methods for strings
Str.HOW.methods(Str);   # same thing with the prototype object Str
HOW(Str).methods(Str);  # same thing as function call

&#39;x&#39;.methods;        # this is likely an error - not a meta object
Str.methods;        # same thing</code></pre>

<p>(For a prototype system (a non-class-based object system), all objects are merely managed by the same meta object.)</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="Roles"
>Roles</a></h2>

<p>Perl supports generic types through what are called &#34;roles&#34; which represent capabilities or interfaces. These roles are generally not used directly as object types. For instance all the numeric types perform the <code>Numeric</code> role, and all string types perform the <code>Stringy</code> role, but there&#39;s no such thing as a &#34;Numeric&#34; object, since these are generic types that must be instantiated with extra arguments to produce normal object types. Common roles include:</p>

<pre><code>Stringy
Numeric
Real
Integral
Rational
Callable
Positional
Associative
Buf
Blob</code></pre>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="Numeric_Types"
><code>Numeric</code> Types</a></h2>

<p>Perl 6 intrinsically supports big integers and rationals through its system of type declarations. <code>Int</code> automatically supports promotion to arbitrary precision, as well as holding <code>Inf</code> and <code>NaN</code> values. Note that <code>Int</code> assumes 2&#39;s complement arithmetic, so <code>+^1 == -2</code> is guaranteed. (Native <code>int</code> operations need not support this on machines that are not natively 2&#39;s complement. You must convert to and from <code>Int</code> to do portable bitops on such ancient hardware.)</p>

<p><code>Num</code> must support the largest native floating point format that runs at full speed. It may be bound to an arbitrary precision type, but by default it is the same type as a native <code>num</code>. See below.</p>

<p><code>Rat</code> supports extended precision rational arithmetic. Dividing two <code>Integral</code> objects using <code>infix:&#60;/&#62;</code> produces a a <code>Rat</code>, which is generally usable anywhere a <code>Num</code> is usable, but may also be explicitly cast to <code>Num</code>. (Also, if either side is <code>Num</code> already, <code>infix:&#60;/&#62;</code> gives you a <code>Num</code> instead of a <code>Rat</code>.)</p>

<p><code>Rat</code> and <code>Num</code> both do the <code>Real</code> role.</p>

<p>Lowercase types like <code>int</code> and <code>num</code> imply the native machine representation for integers and floating-point numbers, respectively, and do not promote to arbitrary precision, though larger representations are always allowed for temporary values. Unless qualified with a number of bits, <code>int</code> and <code>num</code> types represent the largest native integer and floating-point types that run at full speed.</p>

<p>Because temporary values are biased in favor of correct semantics over compact storage, native numeric operators that might overflow must come in two variants, one which returns a guaranteed correct boxed value, and one of which returns a guaranteed fast native value. By default the boxing variant is selected (probably by virtue of hiding the native variants), but within a given lexical scope, the <code>use native</code> pragma will allow use of the dangerous but fast variants instead. Arguments to the pragma can be more specific about what types of return values are allowed, e.g. <code>use native &#39;int&#39;;</code> and such. (The optimizer is also allowed to substitute such variants when it can determine that the final destination would store natively in any case, or that the variant could not possibly malfunction given the arguments.) [Conjecture: we could allow an &#39;N&#39; metaoperator to select the native variant on a case by case basis.]</p>

<p>Numeric values in untyped variables use <code>Int</code> and <code>Num</code> semantics rather than <code>int</code> and <code>num</code>. Literals, on the other hand, may default to native storage formats if they reasonably can. We rely on the semantics of boxing temporary values by default (see above) to maintain correct semantics; the optimizer is of course allowed to box or unbox a literal at compile time (or cache a boxed/unboxed version of the value) whenever it seems appropriate. In any case, native literals should be preferred under <code>use native</code> semantics.</p>

<p>For pragmatic reasons, <code>Rat</code> values are guaranteed to be exact only up to a certain point. By default, this is the precision that would be represented by the <code>Rat64</code> type, which is an alias for <code>Rational[Int,Uint64]</code>, which has a numerator of <code>Int</code> but is limited to a denominator of <code>Uint64</code> (which may or may not be implemented as a native <code>uint64</code>, since small representations may be desirable for small denominators). A <code>Rat64</code> that would require more than 64 bits of storage in the denominator is automatically converted either to a <code>Num</code> or to a lesser-precision <code>Rat</code>, at the discretion of the implementation. (Native types such as <code>rat64</code> limit the size of both numerator and denominator, though not to the same size. The numerator should in general be twice the size of the denominator to support user expectations. For instance, a <code>rat8</code> actually supports <code>Rational[int16,uint8]</code>, allowing numbers like <code>100.01</code> to be represented, and a <code>rat64</code>, defined as <code>Rational[int128,uint64]</code>, can hold the number of seconds since the Big Bang with attosecond precision. Though perhaps not with attosecond accuracy...)</p>

<p>The limitation on <code>Rat</code> values is intended to be enforced only on user-visible types. Intermediate values used in the internal calculations of <code>Rat</code> operators may exceed this precision, or represent negative denominators. That is, the temporaries used in calculating the new numerator and denominator are (at least in the abstract) of <code>Int</code> type. After a new numerator and denominator are determined, any sign is forced to be represented only by the numerator. Then if the denominator exceeds the storage size of the unsigned integer used, the fraction is reduced via gcd. If the resulting denominator is still larger than the storage size, then and <i>only</i> then may the precision be reduced to fit into a <code>Rat</code> or <code>Num</code>.</p>

<p><code>Rat</code> addition and subtraction should attempt to preserve the denominator of the more precise argument if that denominator is an integral multiple of the less precise denominator. That is, in practical terms, adding a column of dollars and cents should generally end up with a result that has a denominator of 100, even if values like 42 and 3.5 were added in. With other operators, this guarantee cannot be made; in such cases, the user should probably be explicitly rounding to a particular denominator anyway.</p>

<p>For applications that really need arbitrary precision denominators as well as numerators at the cost of performance, <code>FatRat</code> may be used, which is defined as <code>Rational[Int,Int]</code>, that is, as arbitrary precision in both parts. There is no literal form for a <code>FatRat</code>, so it must be constructed using <code>FatRat.new($nu,$de)</code>. In general, only math operators with at least one <code>FatRat</code> argument will return another <code>FatRat</code>, to prevent accidental promotion of reasonably fast <code>Rat</code> values into arbitrarily slow <code>FatRat</code> values.</p>

<p>Although most rational implementations normalize or &#34;reduce&#34; fractions to their smallest representation immediately through a gcd algorithm, Perl allows a rational datatype to do so lazily at need, such as whenever the denominator would run out of precision, but avoid the overhead otherwise. Hence, if you are adding a bunch of <code>Rat</code>s that represent, say, dollars and cents, the denominator may stay 100 the entire way through. The <code>.nu</code> and <code>.de</code> methods will return these unreduced values. You can use <code>$rat.=norm</code> to normalize the fraction. (This also forces the sign on the denominator to be positive.) The <code>.perl</code> method will produce a decimal number if the denominator is a power of 10, or normalizable to a power of 10 (that is, having factors of only 2 and 5 (and -1)). Otherwise it will normalize and return a rational literal of the form <code>&#60;-47/3&#62;</code>. Stringifying a rational via <code>.gist</code> or <code>.Str</code> returns an exact decimal number if possible, and otherwise rounds off the repeated decimal based on the size of the denominator. For full details see the documentation of <code>Rat.gist</code> in S32.</p>

<p><code>Num.Str</code> and <code>Num.gist</code> both produce valid Num literals, so they must include the <code>e</code> for the exponential.</p>

<pre><code>say 1/5;    # 0.2 exactly
say 1/3;    # 0.333333 

say &#60;2/6&#62;.perl
            # &#60;1/3&#62;

say 3.14159_26535_89793
            # 3.141592653589793 including last digit

say 111111111111111111111111111111111111111111111.123
            # 111111111111111111111111111111111111111111111.123

say 555555555555555555555555555555555555555555555/5
            # 111111111111111111111111111111111111111111111

say &#60;555555555555555555555555555555555555555555555/5&#62;.perl
            # 111111111111111111111111111111111111111111111.0
say 2e2;    # 200e0 or 2e2 or 200.0e0 or 2.0e2</code></pre>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="Infinity_and_NaN"
>Infinity and <code>NaN</code></a></h2>

<p>Perl 6 by default makes standard IEEE floating point concepts visible, such as <code>Inf</code> (infinity) and <code>NaN</code> (not a number). Within a lexical scope, pragmas may specify the nature of temporary values, and how floating point is to behave under various circumstances. All IEEE modes must be lexically available via pragma except in cases where that would entail heroic efforts to bypass a braindead platform.</p>

<p>The default floating-point modes do not throw exceptions but rather propagate Inf and NaN. The boxed object types may carry more detailed information on where overflow or underflow occurred. Numerics in Perl are not designed to give the identical answer everywhere. They are designed to give the typical programmer the tools to achieve a good enough answer most of the time. (Really good programmers may occasionally do even better.) Mostly this just involves using enough bits that the stupidities of the algorithm don&#39;t matter much.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="Strings,_the_Str_Type"
>Strings, the <code>Str</code> Type</a></h2>

<p>A <code>Str</code> is a Unicode string object. There is no corresponding native <code>str</code> type. However, since a <code>Str</code> object may fill multiple roles, we say that a <code>Str</code> keeps track of its minimum and maximum Unicode abstraction levels, and plays along nicely with the current lexical scope&#39;s idea of the ideal character, whether that is bytes, codepoints, graphemes, or characters in some language.</p>

<h3><a class='u' href='#___top' title='click to go to top of document'
name="The_StrPos_Type"
>The <code>StrPos</code> Type</a></h3>

<p>For all builtin operations, all <code>Str</code> positions are reported as position objects, not integers. These <code>StrPos</code> objects point into a particular string at a particular location independent of abstraction level, either by tracking the string and position directly, or by generating an abstraction-level independent representation of the offset from the beginning of the string that will give the same results if applied to the same string in any context. This is assuming the string isn&#39;t modified in the meanwhile; a <code>StrPos</code> is not a &#34;marker&#34; and is not required to follow changes to a mutable string. For instance, if you ask for the positions of matches done by a substitution, the answers are reported in terms of the original string (which may now be inaccessible!), not as positions within the modified string.</p>

<h3><a class='u' href='#___top' title='click to go to top of document'
name="The_StrLen_Type"
>The <code>StrLen</code> Type</a></h3>

<p>The subtraction of two <code>StrPos</code> objects gives a <code>StrLen</code> object, which is also not an integer, because the string between two positions also has multiple integer interpretations depending on the units. A given <code>StrLen</code> may know that it represents 7 codepoints, 3 graphemes, and 1 letter in Malayalam, but it might only know this lazily because it actually just hangs onto the two <code>StrPos</code> endpoints within the string that in turn may or may not just lazily point into the string. (The lazy implementation of <code>StrLen</code> is much like a <code>Range</code> object in that respect.)</p>

<h3><a class='u' href='#___top' title='click to go to top of document'
name="Units_of_Position_Arguments"
>Units of Position Arguments</a></h3>

<p>If you use integers as arguments where position objects are expected, it will be assumed that you mean the units of the current lexically scoped Unicode abstraction level. (Which defaults to graphemes.) Otherwise you&#39;ll need to coerce to the proper units:</p>

<pre><code>substr($string, Bytes(42), ArabicChars(1))</code></pre>

<p>Of course, such a dimensional number will fail if used on a string that doesn&#39;t provide the appropriate abstraction level.</p>

<h3><a class='u' href='#___top' title='click to go to top of document'
name="Numeric_Coercion_of_StrPos_or_StrLen"
>Numeric Coercion of <code>StrPos</code> or <code>StrLen</code></a></h3>

<p>If a <code>StrPos</code> or <code>StrLen</code> is forced into a numeric context, it will assume the units of the current Unicode abstraction level. It is erroneous to pass such a non-dimensional number to a routine that would interpret it with the wrong units.</p>

<p>Implementation note: since Perl 6 mandates that the default Unicode processing level must view graphemes as the fundamental unit rather than codepoints, this has some implications regarding efficient implementation. It is suggested that all graphemes be translated on input to unique grapheme numbers and represented as integers within some kind of uniform array for fast substr access. For those graphemes that have a precomposed form, use of that codepoint is suggested. (Note that this means Latin-1 can still be represented internally with 8-bit integers.)</p>

<p>For graphemes that have no precomposed form, a temporary private id should be assigned that uniquely identifies the grapheme. If such ids are assigned consistently throughout the process, comparison of two graphemes is no more difficult than the comparison of two integers, and comparison of base characters no more difficult than a direct lookup into the id-to-NFD table.</p>

<p>Obviously, any temporary grapheme ids must be translated back to some universal form (such as NFD) on output, and normal precomposed graphemes may turn into either NFC or NFD forms depending on the desired output. Maintaining a particular grapheme/id mapping over the life of the process may have some GC implications for long-running processes, but most processes will likely see a limited number of non-precomposed graphemes.</p>

<p>If the program has a scope that wants a codepoint view rather than a grapheme view, the string visible to that lexical scope must also be translated to universal form, just as with output translation. Alternately, the temporary grapheme ids may be hidden behind an abstraction layer. In any case, codepoint scope should never see any temporary grapheme ids. (The lexical codepoint declaration should probably specify which normalization form it prefers to view strings under. Such a declaration could be applied to input translation as well.)</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="The_Buf_Type"
>The <code>Buf</code> Type</a></h2>

<p>A <code>Buf</code> is a stringish view of an array of integers, and has no Unicode or character properties without explicit conversion to some kind of <code>Str</code>. (The <code>buf8</code>, <code>buf16</code>, <code>buf32</code>, and <code>buf64</code> types are the native counterparts; native buf types are required to occupy contiguous memory for the entire buffer.) Typically a <code>Buf</code> is an array of bytes serving as a buffer. Bitwise operations on a <code>Buf</code> treat the entire buffer as a single large integer. Bitwise operations on a <code>Str</code> generally fail unless the <code>Str</code> in question can provide an abstract <code>Buf</code> interface somehow. Coercion to <code>Buf</code> should generally invalidate the <code>Str</code> interface. As a generic role <code>Buf</code> may be instantiated as any of <code>buf8</code>, <code>buf16</code>, or <code>buf32</code> (or as any type that provides the appropriate <code>Buf</code> interface), but when used to create a buffer <code>Buf</code> is punned to a class implementing <code>buf8</code> (actually <code>Buf[uint8]</code>).</p>

<p>Unlike <code>Str</code> types, <code>Buf</code> types prefer to deal with integer string positions, and map these directly to the underlying compact array as indices. That is, these are not necessarily byte positions--an integer position just counts over the number of underlying positions, where one position means one cell of the underlying integer type. Builtin string operations on <code>Buf</code> types return integers and expect integers when dealing with positions. As a limiting case, <code>buf8</code> is just an old-school byte string, and the positions are byte positions. Note, though, that if you remap a section of <code>buf32</code> memory to be <code>buf8</code>, you&#39;ll have to multiply all your positions by 4.</p>

<h3><a class='u' href='#___top' title='click to go to top of document'
name="Native_buf_Types"
>Native <code>buf</code> Types</a></h3>

<p>These native types are defined based on the <code>Buf</code> role, parameterized by the native integer type it is composed of:</p>

<pre><code>Name        Is really
====        =========
buf1        Buf[bit]
buf8        Buf[uint8]
buf16       Buf[uint16]
buf32       Buf[uint32]
buf64       Buf[uint64]</code></pre>

<p>There are no signed buf types provided as built-ins, but you may say</p>

<pre><code>Buf[int8]
Buf[int16]
Buf[int32]
Buf[int64]</code></pre>

<p>to get buffers of signed integers. It is also possible to define a <code>Buf</code> based on non-integers or on non-native types:</p>

<pre><code>Buf[complex64]
Buf[FatRat]
Buf[Int]</code></pre>

<p>However, no guarantee of memory contiguity can be made for non-native types.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="The_Whatever_Object"
>The <code>Whatever</code> Object</a></h2>

<p>The <code>*</code> character as a standalone term captures the notion of &#34;Whatever&#34;, the meaning of which can be decided lazily by whatever it is an argument to. Alternately, for those unary and binary operators that don&#39;t care to handle <code>*</code> themselves, it is automatically primed at compile time into a closure that takes one or two arguments. (See below.)</p>

<p>Generally, when an operator handles <code>*</code> itself, it can often be thought of as a &#34;glob&#34; that gives you everything it can in that argument position. For instance, here are some operators that choose to handle <code>*</code> and give it special meaning:</p>

<pre><code>if $x ~~ 1..* {...}                 # if 1 &#60;= $x &#60;= +Inf
my ($a,$b,$c) = &#34;foo&#34; xx *;         # an arbitrary long list of &#34;foo&#34;
if /foo/ ff * {...}                 # a latching flipflop
@slice = @x[*;0;*];                 # all indexes for 1st and 3rd dimensions
@slice = %x{*;&#39;foo&#39;};               # all keys in domain of 1st dimension
@array[*]                           # list of all values, unlike @array[]
(*, *, $x) = (1, 2, 3);             # skip first two elements
                                    # (same as lvalue &#34;undef&#34; in Perl 5)</code></pre>

<p><code>Whatever</code> is an undefined prototype object derived from <code>Any</code>. As a type it is abstract, and may not be instantiated as a defined object. When used for a particular MMD dispatch, and nothing in the MMD system claims it, it dispatches to as an <code>Any</code> with an undefined value, and (we hope) blows up constructively.</p>

<p>Since the <code>Whatever</code> object is effectively immutable, the optimizer is free to recognize <code>*</code> and optimize in the context of what operator it is being passed to. An operator can declare that it wants to handle <code>*</code> either by declaring one or more of its arguments for at least one of its candidates with an argument of type <code>Whatever</code>, or by marking the proto sub with the trait, <code>is like-Whatever-and-stuff</code>. [Conjecture: actually, this is negotiable--we might shorten it to <code>is like(Whatever)</code> or some such. <code>:-)</code>]</p>

<h3><a class='u' href='#___top' title='click to go to top of document'
name="Autopriming_of_Unary_and_Binary_Operators_with_Whatever"
>Autopriming of Unary and Binary Operators with Whatever</a></h3>

<p>Perl 6 has several ways of performing partial function application. Since this is an unwieldy term, we&#39;ve settled on calling it <i>priming</i>. (Many folks call this &#34;currying&#34;, but that&#39;s not really a correct technical usage of the term.) Most generally, priming is performed on a <code>Callable</code> object by calling its <code>.assuming</code> method, described elsewhere. This section is about a convenient syntactic sugar for that.</p>

<p>For any unary or binary operator (specifically, any prefix, postfix, and infix operator), if the operator has not specifically requested (via signature matching) to handle <code>*</code> itself, the compiler is required to translate directly to an appropriately primed closure at compile time. We call this <i>autopriming</i>. Most of the built-in numeric operators fall into this category. So:</p>

<pre><code>* - 1
&#39;.&#39; x *
* + *</code></pre>

<p>are autoprimed into closures of one or two arguments:</p>

<pre><code>{ $^x - 1 }
{ &#39;.&#39; x $^y }
{ $^x + $^y }</code></pre>

<p>This rewrite happens after variables are looked up in their lexical scope, and after declarator install any variables into the lexical scope, with the result that</p>

<pre><code>* + (state $s = 0)</code></pre>

<p>is effectively primed into:</p>

<pre><code>-&#62; $x { $x + (state $OUTER::s = 0) }</code></pre>

<p>rather than:</p>

<pre><code>-&#62; $x { $x + (state $s = 0) }</code></pre>

<p>In other words, <code>*</code> priming does not create a useful lexical scope. (Though it does have a dynamic scope when it runs.) This prevents the semantics from changing drastically if the operator in question suddenly decides to handle <code>Whatever</code> itself.</p>

<p>As a postfix operator, a method call is one of those operators that is automatically primed. Something like:</p>

<pre><code>*.meth(1,2,3)</code></pre>

<p>is rewritten as:</p>

<pre><code>{ $^x.meth(1,2,3) }</code></pre>

<p>In addition to priming a method call without an invocant, such primed methods are handy anywhere a smartmatcher is expected:</p>

<pre><code>@primes = grep *.is-prime, 2..*;
subset Duck where *.^can(&#39;quack&#39;);
when !*.defined {...}</code></pre>

<p>Metaoperators are treated as normal operators; the autopriming does not automatically distribute to the inner operator. For example,</p>

<pre><code>@array X* *</code></pre>

<p>does not make a list of closures, but is equivalent to</p>

<pre><code>-&#62; $arg { @array X* $arg }</code></pre>

<p>Postcircumfixes (with or without the dot) are also autoprimed, so we have</p>

<pre><code>*[$x]       -&#62; @a { @a[$x] }
*{$x}       -&#62; %h { %h[$x] }
*&#60;foo&#62;      -&#62; %h { %h&#60;foo&#62; }
*($x)       -&#62; &#38;c { &#38;c($x) }</code></pre>

<h3><a class='u' href='#___top' title='click to go to top of document'
name="The_WhateverCode_Types"
>The <code>WhateverCode</code> Types</a></h3>

<p>These returned closures are of type <code>WhateverCode:($)</code> or <code>WhateverCode:($,$)</code> rather than type <code>Whatever</code>, so constructs that do want to handle <code>*</code> or its derivative closures can distinguish them by type:</p>

<pre><code>@array[*]    # subscript is type Whatever, returns all elements
@array[*-1]  # subscript is type WhateverCode:($), returns last element

0, 1, *+1 ... *  # counting
0, 1, *+* ... *  # fibonacci</code></pre>

<p>For any prefix, infix, postfix, or postcircumfix operator that would be primed by a <code>Whatever</code>, a <code>WhateverCode</code> also autoprimes it, such that any noun phrase based on <code>*</code> as a head noun autoprimes transitively outward as far as it makes sense, including outward through metaoperators. Hence:</p>

<pre><code>* + 2 + 3   # { $^x + 2 + 3 }
* + 2 + *   # { $^x + 2 + $^y }
* + * + *   # { $^x + $^y + $^z }
(-*.abs)i   # { (-$^x.abs)i }
@a &#171;+&#187; *    # { @a &#171;+&#187; $^x }</code></pre>

<p>Note in particular that parentheses will autoprime on a <code>WhateverCode</code>, so</p>

<pre><code>*[0](1,2,3,4,5)</code></pre>

<p>means</p>

<pre><code>-&#62; @a { @a[0](1,2,3,4,5) }</code></pre>

<p>rather than</p>

<pre><code>(-&#62; @a { @a.[0] })(1,2,3,4,5)</code></pre>

<p>If you want the latter semantics for some reason, use a temporary:</p>

<pre><code>my $c = *[0]; $c(1,2,3,4,5);</code></pre>

<p>or just put the autoprime in parens:</p>

<pre><code>(*[0])(1,2,3,4,5)</code></pre>

<h3><a class='u' href='#___top' title='click to go to top of document'
name="Operators_with_idiosyncratic_Whatever"
>Operators with idiosyncratic Whatever</a></h3>

<p>The above is only for operators that are not <code>Whatever</code>-aware. There is no requirement that a <code>Whatever</code>-aware operator return a <code>WhateverCode</code> when <code>Whatever</code> is used as an argument; that&#39;s just the <i>typical</i> behavior for functions that have no intrinsic &#34;globbish&#34; meaning for <code>*</code>. If you want to prime one of these globbish operators, you&#39;ll need to write an explicit closure or do an explicit priming on the operator with <code>.assuming()</code>. Operators in this class, such as <code>infix:&#60;..&#62;</code> and <code>infix:&#60;xx&#62;</code>, typically <i>do</i> autoprime arguments of type <code>WhateverCode</code> even though they do not autoprime <code>Whatever</code>, so we have:</p>

<pre><code>&#34;foo&#34; xx *          # infinite supply of &#34;foo&#34;
&#34;foo&#34; xx *-1        # { &#34;foo&#34; xx $^a - 1 }
0 .. *              # half the real number line
0 .. * - 1          # { 0 .. $^a - 1 }
* - 3 .. * - 1      # { $^a - 3 .. $^b - 1 }</code></pre>

<p>(If the last is used as a subscript, the subscripter notices there are two arguments and passes that dimension&#39;s size twice.)</p>

<h3><a class='u' href='#___top' title='click to go to top of document'
name="Non-closure-returning_Operators_with_*"
>Non-closure-returning Operators with <code>*</code></a></h3>

<p>Operators that are known to return non-closure values with <code>*</code> include:</p>

<pre><code>0 .. *      # means 0 .. Inf
0 ... *     # means 0 ... Inf
&#39;a&#39; xx *    # means &#39;a&#39; xx Inf
1,*         # means 1,*  :)

$a = *      # just assigns Whatever
$a ~~ *     # just matches Whatever</code></pre>

<p>Note that the last two also do not autoprime <code>WhateverCode</code>, because assignment and smartmatching are not really normal binary operators, but syntactic sugar for underlying primitives. (Such pseudo operators may also place restrictions on which meta-operators work on them.)</p>

<p>Neither do the sequence operators <code>&#38;infix:&#60;...&#62;</code> and <code>&#38;infix:&#60;...^&#62;</code> autoprime <code>WhateverCode</code>, because we want to allow WhateverCode closures as the stopper:</p>

<pre><code>0 ...^ *&#62;5  # means 0, 1, 2, 3, 4, 5</code></pre>

<p>[Conjecture: it is possible that, for most of the above operators that take <code>*</code> to mean <code>Inf</code>, we could still actually return a closure that defaults that particular argument to <code>Inf</code>. However, this would work only if we provide a &#34;value list context&#34; that forbids closures, in the sense that it always calls any closure it finds in its list and replaces the closure in the list with its return value or values, and then rescans from that point (kinda like a text macro does), in case the closure returned a list containing a closure. So for example, the closure returned by <code>0..*</code> would interpolate a <code>Range</code> object into the list when called. Alternately, it could return the <code>0</code>, followed by another closure that does <code>1..*</code>. Even the <code>...</code> operator could likely be redefined in terms of a closure that regenerates itself, as long as we figure out some way of remembering the last N values each time.]</p>

<p>In any case, array indexes must behave as such a &#39;value list context&#39;, since you can&#39;t directly index an array with anything other than a number. The final element of an array is subscripted as <code>@a[*-1]</code>, which means that when the subscripting operation discovers a <code>Code:($)</code> object for a subscript, it calls it and supplies an argument indicating the number of elements in (that dimension of) the array. See S09.</p>

<h3><a class='u' href='#___top' title='click to go to top of document'
name="The_HyperWhatever_Type"
>The <code>HyperWhatever</code> Type</a></h3>

<p>A variant of <code>*</code> is the <code>**</code> term, which is of type <code>HyperWhatever</code>. It is generally understood to be a multidimension form of <code>*</code> when that makes sense. When modified by an operator that would turn <code>*</code> into a function of one argument, <code>WhateverCode:($)</code>, <code>**</code> instead turns into a function with one slurpy argument, <code>Code(*@)</code>, such that multiple arguments are distributed to some number of internal whatevers. That is:</p>

<pre><code>* - 1    means                -&#62; $x { $x - 1 }
** - 1   means   -&#62; *@x { map -&#62; $x { $x - 1 }, @x }</code></pre>

<p>Therefore <code>@array[^**]</code> represents <code>@array[{ map { ^* }, @_ }]</code>, that is to say, every element of the array, no matter how many dimensions. (However, <code>@array[**]</code> means the same thing because (as with <code>...</code> above), the subscript operator will interpret bare <code>**</code> as meaning all the subscripts, not the list of dimension sizes. The meaning of <code>Whatever</code> is always controlled by the first context it is bound into.)</p>

<p>Other uses for <code>*</code> and <code>**</code> will doubtless suggest themselves over time. These can be given meaning via the MMD system, if not the compiler. In general a <code>Whatever</code> should be interpreted as maximizing the degrees of freedom in a dwimmy way, not as a nihilistic &#34;don&#39;t care anymore--just shoot me&#34;.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="Native_types"
>Native types</a></h2>

<p>Values with these types autobox to their uppercase counterparts when you treat them as objects:</p>

<pre><code>bit         single native bit
int         native signed integer
uint        native unsigned integer (autoboxes to Int)
buf         native buffer (finite seq of native ints or uints, no Unicode)
rat         native rational
num         native floating point
complex     native complex number
bool        native boolean</code></pre>

<p>Since native types cannot represent Perl&#39;s concept of undefined values, in the absence of explicit initialization, native floating-point types default to NaN, while integer types (including <code>bit</code>) default to 0. The complex type defaults to NaN + NaN\i. A buf type of known size defaults to a sequence of 0 values.</p>

<p>You can set a different default on any container type by use of a trait such as <code>is default(42)</code>. Deleting or undefining such a container sets the contents back to the default value (or optionally removes it in cases where the default value can be autovivified on demand).</p>

<p>If you wish for a native declaration to attempt no initialization, but leave whatever garbage was in memory, you may use the <code>is default(*)</code> trait. There are several use cases for this, if you know you&#39;re going to initialize the memory otherwise, or you&#39;re doing some form of memory mapping.</p>

<p>If a buf type is initialized with a Unicode string value, the string is decomposed into Unicode codepoints, and each codepoint shoved into an integer element. If the size of the buf type is not specified, it takes its length from the initializing string. If the size is specified, the initializing string is truncated or 0-padded as necessary. If a codepoint doesn&#39;t fit into a buf&#39;s integer type, a parse error is issued if this can be detected at compile time; otherwise a warning is issued at run time and the overflowed buffer element is filled with an appropriate replacement character, either <code>U+FFFD</code> (REPLACEMENT CHARACTER) if the element&#39;s integer type is at least 16 bits, or <code>U+007f</code> (DELETE) if the larger value would not fit. If any other conversion is desired, it must be specified explicitly. In particular, no conversion to UTF-8 or UTF-16 is attempted; that must be specified explicitly. (As it happens, conversion to a buf type based on 32-bit integers produces valid UTF-32 in the native endianness.)</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="The_Mu_type"
>The <code>Mu</code> type</a></h2>

<p>Among other things, <code>Mu</code> is named after the eastern concept of &#34;Mu&#34; or &#28961; (see <a href="http://en.wikipedia.org/wiki/MU" class="podlinkurl"
>http://en.wikipedia.org/wiki/MU</a>, especially the &#34;Mu (negative)&#34; entry), so in Perl 6 it stands in for Perl 5&#39;s concept of &#34;undef&#34; when that is used as a noun. However, <code>Mu</code> is also the &#34;nothing&#34; from which everything else is derived via the undefined type objects, so it stands in for the concept of &#34;Object&#34; as used in languages like Java. Or think of it as a &#34;micro&#34; or &#181;-object that is the basis for all other objects, something atomic like a Muon. Or if acronyms make you happy, there are a variety to pick from:</p>

<pre><code>Most Universal
More Undefined
Modern Undef
Master Union
Meta Ur
Mega Up
...</code></pre>

<p>Or just think of it as a sound a cow makes, which simultaneously means everything and nothing.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="Undefined_types"
>Undefined types</a></h2>

<p>Perl 6 does not have a single value representing undefinedness. Instead, objects of various types can carry type information while nevertheless remaining undefined themselves. Whether an object is defined is determined by whether <code>.defined</code> returns true or not. These typed objects typically represent uninitialized values. Failure objects are also officially undefined despite carrying exception information; these may be created using the <code>fail</code> function, or by direct construction of a <code>Failure</code> object of some sort. (See S04 for how failures are handled.)</p>

<pre><code>Mu          Most Undefined
Failure     Failure (lazy exceptions, thrown if not handled properly)</code></pre>

<p>Whenever you declare any kind of type, class, module, or package, you&#39;re automatically declaring a undefined prototype value with the same name, known as the <i>type object</i>. The name itself returns that type object:</p>

<pre><code>Mu          Perl 6 object (default block parameter type, Any, Junction, or Each)
Any         Perl 6 object (default routine parameter type, excludes Junction, Nil, Failure)
Cool        Perl 6 Convenient OO Loopbacks
Whatever    Wildcard (like Any, but subject to do-what-I-mean via MMD)
Int         Any Int object
Widget      Any Widget object</code></pre>

<p>All user-defined classes derive from the <code>Any</code> class by default.</p>

<p>Type objects sometimes stringify to their name in parens, to indicate undefinedness. Note that type objects are not classes, but may be used to name classes when the type&#39;s associated meta-object allows it:</p>

<pre><code>Widget.new()        # create a new Widget</code></pre>

<p>The <code>Any</code> type encompasses all normal value and object types. It is the unit type, but includes units that are containers of multiple values. It is not the most general type, however. <code>Any</code> derives from <code>Mu</code>, which is the top type in Perl 6, and encompasses certain conceptual types that fall outside the realm of ordinary <code>Any</code> values. These conceptual types include:</p>

<pre><code>Junction    unordered superposition of data with and/or/one/none
Each        ordered superposition (conjectural)
Failure     a lazy exception</code></pre>

<p>Conceptual types rely on the failure to match an <code>Any</code> type in order to trigger various extraordinary behaviors. The <code>Junction</code> and <code>Each</code> types trigger an inside-out linguistic distribution of various list behaviors from inside a scalar expression that pretends a bunch of values are really a single value. (These are modeled on similar linguistic behaviors in English.) The distributional behavior triggered for these types is known as <i>autothreading</i>.</p>

<p>The <code>Failure</code> type is considered conceptual so that dynamic context can determine the treatment of failures that in other languages would always throw exceptions. This gives Perl 6 programs the flexibility to handle exceptions either in-band or out-of-band. It is particularly important to be able to handle exceptions in-band when you are trying to perform parallel operations, so that the failure of one computation does not result in fratricide of all its fellow computations. (You can think of this as analogous to the way <code>NaN</code> propagates through floating-point calculations.)</p>

<p>Single dispatch of a <code>Failure</code> invocant to any method not in <code>Failure</code> returns the same <code>Failure</code>, so that cascaded method calls can be checked with a single check:</p>

<pre><code>$object.fee.fie.[$foe].{$foo}.sic // die &#34;Oops: $!&#34;;</code></pre>

<p>Failures may only be passed into functions via parameters that allow <code>Mu</code> or <code>Failure</code>, and a failure may only be returned from a function whose return type permits it.</p>

<p>After the failure is returned, any subsequent attempt to use the failure in an <code>Any</code> context will be subject to further failure analysis, and will likely throw an exception immediately. Likewise, discarding the failure in sink context produces an immediate exception.</p>

<p>Note that a <code>Failure</code> object is undefined, but may contain one or more defined <code>Exception</code> objects, which are considered normal objects that just happen to be used in exception throwing and handling.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="Immutable_types"
>Immutable types</a></h2>

<p>Objects with these types behave like values, i.e. <code>$x === $y</code> is true if and only if their types and contents are identical (that is, if <code>$x.WHICH</code> eqv <code>$y.WHICH</code>).</p>

<pre><code>Str         Perl string (finite sequence of Unicode characters)
Bit         Perl single bit (allows traits, aliasing, undefinedness, etc.)
Int         Perl integer (allows Inf/NaN, arbitrary precision, etc.)
Num         Perl number (approximate Real, generally via floating point)
Rat         Perl rational (exact Real, limited denominator)
FatRat      Perl rational (unlimited precision in both parts)
Complex     Perl complex number
Bool        Perl boolean
Exception   Perl exception
Block       Executable objects that have lexical scopes
Range       A pair of Ordered endpoints
Set         Unordered collection of values that allows no duplicates
Bag         Unordered collection of values that allows duplicates
Mix         Unordered collection of values with weights
Enum        An immutable Pair
EnumMap     A mapping of Enums with no duplicate keys
Signature   Function parameters (left-hand side of a binding)
Parcel      Arguments in a comma list
LoL         Arguments in a semicolon list
Capture     Function call arguments (right-hand side of a binding)
Blob        An undifferentiated mass of ints, an immutable Buf
Instant     A point on the continuous atomic timeline
Duration    The difference between two Instants
HardRoutine A routine that is committed to not changing</code></pre>

<p><code>Set</code> values may be composed with the <code>set</code> listop or method. <code>Bag</code> values may be composed with the <code>bag</code> listop or method. <code>Mix</code> values may be composed with the <code>mix</code> listop or method.</p>

<p><code>Instant</code>s and <code>Duration</code>s are measured in atomic seconds with fractions. Notionally they are real numbers which may be implemented in any <code>Real</code> type of sufficient precision, preferably a <code>Rat</code> or <code>FatRat</code>. (Implementations that make fixed-point assumptions about the available subsecond precision are discouraged; the user interface must act like real numbers in any case.) Interfaces that take <code>Duration</code> arguments, such as sleep(), may also take <code>Real</code> arguments, but <code>Instant</code> arguments must be explicitly created via any of various culturally aware time specification APIs. A small number of <code>Instant</code> values that represent common epoch instant values are also available.</p>

<p>In numeric context a <code>Duration</code> happily returns a <code>Rat</code> or <code>FatRat</code> representing the number of seconds. <code>Instant</code> values, on the other hand, are largely opaque, numerically speaking, and in particular are epoch agnostic. (Any epoch is just a particular <code>Instant</code>, and all times related to that epoch are really <code>Instant</code> &#177; <code>Duration</code>, which returns a new <code>Instant</code>.) In order to facilitate the writing of culturally aware time modules, the <code>Instant</code> type provides <code>Instant</code> values corresponding to various commonly used epochs, such as the 1958 TAI epoch, the POSIX epoch, the Mac epoch, and perhaps the year 2000 epoch as UTC thinks of it. There&#39;s no reason to exclude any useful epoch that is well characterized in atomic seconds. All normal times can be calculated from those epoch instants using addition and subtraction of <code>Duration</code> values. Note that the <code>Duration</code> values are still just atomic time without any cultural deformations; in particular, the <code>Duration</code> formed of by subtracting <code>Instant::Epoch::POSIX</code> from the current instant will contain more seconds than the current POSIX <code>time()</code> due to POSIX&#39;s abysmal ignorance of leap seconds. This is not the fault of the universe, which is not fooled (neglecting relativistic considerations). <code>Instant</code>s and <code>Duration</code>s are always linear atomic seconds. Systems which cannot officially provide a steady time base, such as POSIX systems, will simply have to make their best guess as to the correct atomic time when asked to interconvert between cultural time and atomic time. Alternately, they may use some other less-official time mechanism to achieve steady clock behavior. Most Unix systems can count clock ticks, even if POSIX time types get confused.</p>

<p>Although the conceptual type of an <code>Instant</code> resembles <code>FatRat</code>, with arbitrarily large size in either numerator or denominator, the internal form may of course be optimized internally for &#34;nearby&#34; times, so that, if we know the year as an integer, the instant within the year can just be a <code>Rat</code> representing the offset from the beginning of the year. Calculations that fall within the same year can then be done in <code>Rat</code> rather than <code>FatRat</code>, or a table of yearly offsets can find the difference in integer seconds between two years, since (so far) nobody has had the nerve to propose fractional leap seconds. Or whatever. <code>Instant</code> is opaque, so we can swap implementations in and out without user-visible consequences.</p>

<p>The term <code>now</code> returns the current time as an <code>Instant</code>. As with the <code>rand</code> and <code>self</code> terms, it is not a function, so don&#39;t put parens after it. It also never looks for arguments, so the next token should be an operator or terminator.</p>

<pre><code>now + 300   # the instant five minutes from now</code></pre>

<p>Basic math operations are defined for instants and durations such that the sum of an instant and a duration is always an instant, while the difference of two instants is always a duration. Math on instants may only be done with durations (or numbers that will be taken as durations, as above); you may not add two instants.</p>

<pre><code>$instant + $instant      # WRONG
$instant - $instant      # ok, returns a duration
$instant + $duration     # ok, returns an instant</code></pre>

<p>Numeric operations on durations return <code>Duration</code> where that makes sense (addition, subtraction, modulus). The type returned for other numeric operations is unspecified; they may return normal numeric types or they may return other dimensional types that attempt to assist in dimensional analysis. (The latter approach should likely require explicit declaration for now, until we can demonstrate that it does not adversely impact the average programmer, and that it plays well with the concept of gradual typing.)</p>

<p>The <code>Blob</code> type is like an immutable buffer, and therefore responds both to array and (some) stringy operations. Note that, like a <code>Buf</code>, its size is measured in whatever the base unit is, which is not always bytes. If you have a <code>my Blob[bit] $blob</code>, then <code>$blob.elems</code> returns the number of bits in it. As with buffers, various native types are automatically derived from native unsigned int types:</p>

<pre><code>blob1       Blob[bit], a bit string
blob2       Blob[uint2], a DNA sequence?
blob3       Blob[uint[3]], an octal string
blob4       Blob[uint4], a hex string
blob8       Blob[uint8], a byte string
blob16      Blob[uint16]
blob32      Blob[uint32]
blob64      Blob[uint64]</code></pre>

<p>The <code>utf8</code> type is derived from <code>blob8</code>, with the additional constraint that it may only contain validly encoded UTF-8. Likewise, <code>utf16</code> is derived from <code>blob16</code>, and <code>utf32</code> from <code>blob32</code>.</p>

<p>Note that since these are type names, parentheses must always be used to call them as coercers, since the listop form is not allowed for coercions. That is:</p>

<pre><code>utf8 op $x</code></pre>

<p>is always parsed as</p>

<pre><code>(utf8) op $x</code></pre>

<p>and never as</p>

<pre><code>utf8(op $x)</code></pre>

<p>These types do (at least) the following roles:</p>

<pre><code>Class       Roles
=====       =====
Str         Stringy
Bit         Numeric Boolean Integral
Int         Numeric Real Integral
Num         Numeric Real
Rat         Numeric Real Rational
FatRat      Numeric Real Rational
Complex     Numeric
Bool        Boolean
Block       Callable
Range       Iterable
Set         Setty Iterable
Bag         Baggy Iterable
Mix         Mixy Iterable
Enum        Associative
EnumMap     Associative Positional Iterable
Signature   
Parcel      Positional
Capture     Positional Associative
Blob        Stringy Positional
Instant     Numeric Real
Duration    Numeric Real
HardRoutine Routine</code></pre>

<p>[Conjecture: <code>Stringy</code> may best be split into 2 roles where both <code>Str</code> and <code>Blob</code> compose the more general one and just <code>Str</code> composes a less general one. The more general of those would apply to what is common to any dense sequence (&#34;string&#34;) that <code>Str</code> and <code>Blob</code> both are (either of characters or bits or integers etc), and the string operators like catenation (<code>~</code>) and replication (<code>x</code>, <code>xx</code>) would be part of the more general role. The more specific role would apply to <code>Str</code> but not <code>Blob</code> and includes any specific operators that are specific to <i>characters</i> and don&#39;t apply to bits or integers etc. The other alternative is to more clearly distance character strings from bit strings, keeping <code>~</code>/etc for character strings only and adding an analogy for bit strings.]</p>

<p>The <code>Iterable</code> role indicates not that you can iterate the type directly, but that you can request the type to return an iterator. Iterable types may have multiple iterators (lists) running across them simultaneously, but an iterator/list itself has only one thread of consumption. Every time you do <code>get</code> on an iterator, a value disappears from its list.</p>

<p>Note that <code>Set</code> iterators return only the keys, not the boolean values. You must explicitly use <code>.pairs</code> to get key/value pairs. The <code>Bag</code> and <code>Mix</code> types, on the other hand, default to returning pairs, as a <code>Hash</code> does.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="Mutable_types"
>Mutable types</a></h2>

<p>Objects with these types have distinct <code>.WHICH</code> values that do not change even if the object&#39;s contents change. (Routines are considered mutable because they can be wrapped in place.)</p>

<pre><code>Iterator    Perl list
RangeIter   Iterator over a Range
Scalar      Perl scalar
Array       Perl array
Hash        Perl hash
SetHash     Setty QuantHash[Bool,False]
BagHash     Baggy QuantHash[UInt,0]
MixHash     Mixy  QuantHash[Real,0.0]
Pair        A single key-to-value association
Buf         Perl buffer (array of integers with some stringy features)
IO          Perl filehandle
Routine     Base class for all wrappable executable objects
Sub         Perl subroutine
Method      Perl method
Submethod   Perl subroutine acting like a method
Macro       Perl compile-time subroutine
Regex       Perl pattern
Match       Perl match, usually produced by applying a pattern
Stash       A symbol table hash (package, module, class, lexpad, etc)
SoftRoutine A routine that is committed to staying mutable</code></pre>

<p>The <code>QuantHash</code> role differs from a normal <code>Associative</code> hash in how it handles default values. If the value of a <code>QuantHash</code> element is set to the default value for the <code>QuantHash</code>, the element is deleted. If undeclared, the default default for a <code>QuantHash</code> is 0 for numeric types, <code>False</code> for boolean types, and the null string for string and buffer types. A <code>QuantHash</code> of an object type defaults to the undefined prototype for that type. More generally, the default default is whatever defined value a <code>Nil</code> would convert to for that value type. A <code>QuantHash</code> of <code>Scalar</code> deletes elements that go to either 0 or the null string. A <code>QuantHash</code> also autodeletes keys for normal undefined values (that is, those undefined values that do not contain an unthrown exception).</p>

<p>A <code>SetHash</code> is a <code>QuantHash</code> of booleans with a default of <code>False</code>. If you use the <code>Hash</code> interface and increment an element of a <code>SetHash</code> its value becomes true (creating the element if it doesn&#39;t exist already). If you decrement the element it becomes false and is automatically deleted. Decrementing a non-existing value results in a <code>False</code> value. Incrementing an existing value results in <code>True</code>. When not used as a <code>Hash</code> (that is, when used as an <code>Array</code> or list or <code>Set</code> object) a <code>SetHash</code> behaves as a <code>Set</code> of its keys. (Since the only possible value of a <code>SetHash</code> is the <code>True</code> value, it need not be represented in the actual implementation with any bits at all.)</p>

<p>A <code>BagHash</code> is a <code>QuantHash</code> of <code>UInt</code> with a default of 0. If you use the <code>Hash</code> interface and increment an element of a <code>BagHash</code> its value is increased by one (creating the element if it doesn&#39;t exist already). If you decrement the element the value is decreased by one; if the value goes to 0 the element is automatically deleted. An attempt to decrement a non-existing value returns an undefined value. When not used as a <code>Hash</code> (that is, when used as an <code>Array</code> or list or <code>Bag</code> object) a <code>BagHash</code> behaves as a <code>Bag</code> of its pairs.</p>

<p>A <code>MixHash</code> is a <code>QuantHash</code> of <code>Real</code> with a default of 0.0. If the value goes to 0 the element is automatically deleted. When not used as a <code>Hash</code> (that is, when used as an <code>Array</code> or list or <code>Mix</code> object) a <code>MixHash</code> behaves as a <code>Mix</code> of its pairs.</p>

<p>As with <code>Hash</code> types, <code>Pair</code> and <code>PairSeq</code> are mutable in their values but not in their keys. (A key can be a reference to a mutable object, but cannot change its <code>.WHICH</code> identity. In contrast, the value may be rebound to a different object, just as a hash element may.)</p>

<p>The following roles are supported:</p>

<pre><code>Iterator    List
Scalar      
Array       Positional Iterable
Hash        Associative
SetHash     Setty QuantHash[Bool]
BagHash     Baggy QuantHash[UInt]
MixHash     Mixy  QuantHash[Real]
Pair        Associative
PairSeq     Associative Positional Iterable
Buf         Stringy
IO          
Routine     Callable
Sub         Callable
Method      Callable
Submethod   Callable
Macro       Callable
Regex       Callable
Match       Positional Associative
Stash       Associative
SoftRoutine Routine</code></pre>

<p>Types that do the <code>List</code> role are generally hidden from casual view, since iteration is typically triggered by context rather than by explicit call to the iterator&#39;s <code>.get</code> method. Filehandles are a notable exception.</p>

<p>See <a href="http://search.cpan.org/perldoc?S06#Wrapping" class="podlinkpod"
>&#34;Wrapping&#34; in S06</a> for a discussion of soft vs. hard routines.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="Of_types"
>Of types</a></h2>

<p>Explicit types are optional. Perl variables have two associated types: their &#34;of type&#34; and their &#34;container type&#34;. (More generally, any container has a container type, including subroutines and modules.) The <code>of</code> type is stored as its <code>of</code> property, while the container type of the container is just the object type of the container itself. The word <code>returns</code> is allowed as an alias for <code>of</code>.</p>

<p>The <code>of</code> type specifies what kinds of values may be stored in the variable. An <code>of</code> type is given as a prefix or with the <code>of</code> keyword:</p>

<pre><code>my Dog $spot;
my $spot of Dog;</code></pre>

<p>In either case this sets the <code>of</code> property of the container to <code>Dog</code>. You may not mix these notations; if you do, a compiler error will result.</p>

<p>An <code>of</code> type on an array or hash specifies the type stored by each element:</p>

<pre><code>my Dog @pound;  # each element of the array stores a Dog

my Rat %ship;   # the value of each entry stores a Rat</code></pre>

<p>The key type of a hash may be specified as a shape trait--see S09.</p>

<p>Containers enforce type safety on setting, whereas subroutines enforce type safety on return. The <code>returns</code> declarations is an alias for the <code>of</code> type of a subroutine.</p>

<pre><code>sub get_pet() of Animal {...}       # of type, obviously
sub get_pet() returns Animal {...}  # of type
our Animal sub get_pet() {...}      # of type</code></pre>

<p>To coerce your return value, use a coercion type:</p>

<pre><code>sub get_pet() returns Pet(Animal) {...}  # coerce any Animal to Pet</code></pre>

<p>For a container, however, use of a coercion type as the <code>of</code> coerces upon setting rather than returning the value.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="Container_types"
>Container types</a></h2>

<p>The container type specifies how the variable itself is implemented. It is given as a trait of the variable:</p>

<pre><code>my $spot is Scalar;             # this is the default
my $spot is PersistentScalar;
my $spot is DataBase;</code></pre>

<p>Defining a container type is the Perl 6 equivalent to tying a variable in Perl 5. But Perl 6 variables are tied directly at declaration time, and for performance reasons may not be tied with a run-time <code>tie</code> statement unless the variable is explicitly declared with a container type that does the <code>Tieable</code> role.</p>

<p>However, package variables are always considered <code>Tieable</code> by default. As a consequence, all named packages are also <code>Tieable</code> by default. Classes and modules may be viewed as differently tied packages. Looking at it from the other direction, classes and modules that wish to be bound to a global package name must be able to do the <code>Package</code> role.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="Hierarchical_types"
>Hierarchical types</a></h2>

<p>A non-scalar type may be qualified, in order to specify what type of value each of its elements stores:</p>

<pre><code>my Egg $cup;                       # the value is an Egg
my Egg @carton;                    # each elem is an Egg
my Array of Egg @box;              # each elem is an array of Eggs
my Array of Array of Egg @crate;   # each elem is an array of arrays of Eggs
my Hash of Array of Recipe %book;  # each value is a hash of arrays of Recipes</code></pre>

<p>Each successive <code>of</code> makes the type on its right a parameter of the type on its left. Parametric types are named using square brackets, so:</p>

<pre><code>my Hash[Array[Recipe]] %book;</code></pre>

<p>actually means:</p>

<pre><code>my Hash of Array of Recipe %book;</code></pre>

<p>which is:</p>

<pre><code>my Hash:of(Array:of(Recipe)) %book;</code></pre>

<p>Because the actual variable can be hard to find when complex types are specified, there is a postfix form as well:</p>

<pre><code>my Hash of Array of Recipe %book;           # HoHoAoRecipe
my %book of Hash of Array of Recipe;        # same thing</code></pre>

<p>Alternately, the return type may be specified within the signature:</p>

<pre><code>my sub get_book ($key --&#62; Hash of Array of Recipe) {...}</code></pre>

<p>You may also specify the type as the <code>of</code> trait (with <code>returns</code> allowed as a synonym):</p>

<pre><code>my Hash of Array of Recipe sub get_book ($key) {...}
my sub get_book ($key) of Hash of Array of Recipe {...}
my sub get_book ($key) returns Hash of Array of Recipe {...}</code></pre>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="Parameter_types"
>Parameter types</a></h2>

<p>Parameters may be given types, just like any other variable:</p>

<pre><code>sub max (int @array is rw) {...}
sub max (@array of int is rw) {...}</code></pre>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="Generic_types"
>Generic types</a></h2>

<p>Within a declaration, a class variable (either by itself or following an existing type name) declares a new type name and takes its parametric value from the actual type of the parameter it is associated with. It declares the new type name in the same scope as that of the associated declaration.</p>

<pre><code>sub max (Num ::X @array) {
    push @array, X.new();
}</code></pre>

<p>The new type name is introduced immediately, so two such types in the same signature must unify compatibly if they have the same name:</p>

<pre><code>sub compare (Any ::T $x, T $y) {
    return $x eqv $y;
}</code></pre>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="The_Cool_class_(and_package)"
>The Cool class (and package)</a></h1>

<p>The <code>Cool</code> type is derived from <code>Any</code>, and contains all the methods that are &#34;cool&#34; (as in, &#34;I&#39;m cool with an argument of that type.&#34;).</p>

<p>More specifically, these are the methods that are culturally universal, insofar as the typical user will expect the name of the method to imply conversion to a particular built-in type that understands the method in question. For instance, <code>$x.abs</code> implies conversion to an appropriate numeric type if <code>$x</code> is &#34;cool&#34; but doesn&#39;t already support a method of that name. Conversely, <code>$x.substr</code> implies conversion to a string or buffer type.</p>

<p>The <code>Cool</code> module also contains all multisubs of last resort; these are automatically searched if normal multiple dispatch does not find a viable candidate. Note that the <code>Cool</code> package is mutable, and both single and multiple dispatch must take into account changes there for the purposes of run-time monkey patching. However, since the multiple dispatcher uses the <code>Cool</code> package only as a failover, compile-time analysis of such dispatches is largely unaffected for any arguments with an exact or close match. Likewise any single dispatch a method that is more specific than the <code>Cool</code> class is not affected by the mutability of <code>Cool</code>. User-defined classes don&#39;t derive from <code>Cool</code> by default, so such classes are also unaffected by changes to <code>Cool</code>.</p>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="Names_and_Variables"
>Names and Variables</a></h1>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="Apostrophe_separator"
>Apostrophe separator</a></h2>

<p>The <code>$Package&#39;var</code> syntax is gone. Use <code>$Package::var</code> instead. (Note, however, that identifiers may now contain an apostrophe or hyphen if followed by a character matching <code>&#60;.alpha&#62;</code>)</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="Sigils"
>Sigils</a></h2>

<p>Perl 6 includes a system of <b>sigils</b> to mark the fundamental structural type of a variable:</p>

<pre><code>$   scalar (object)
@   ordered array
%   unordered hash (associative array)
&#38;   code/rule/token/regex
::  package/module/class/role/subset/enum/type/grammar</code></pre>

<p>Within a declaration, the <code>&#38;</code> sigil also declares the visibility of the subroutine name without the sigil within the scope of the declaration:</p>

<pre><code>my &#38;func := sub { say &#34;Hi&#34; };
func;   # calls &#38;func</code></pre>

<p>Within a signature or other declaration, the <code>::</code> pseudo-sigil followed by an identifier marks a type variable that also declares the visibility of a package/type name without the sigil within the scope of the declaration. The first such declaration within a scope is assumed to be an unbound type, and takes the actual type of its associated argument. With subsequent declarations in the same scope the use of the pseudo-sigil is optional, since the bare type name is also declared.</p>

<p>A declaration nested within must not use the sigil if it wishes to refer to the same type, since the inner declaration would rebind the type. (Note that the signature of a pointy block counts as part of the inner block, not the outer block.)</p>

<h3><a class='u' href='#___top' title='click to go to top of document'
name="Sigils_indicate_interface"
>Sigils indicate interface</a></h3>

<p>Sigils indicate overall interface, not the exact type of the bound object. Different sigils imply different minimal abilities.</p>

<p><code>$x</code> may be bound to any object, including any object that can be bound to any other sigil. Such a scalar variable is always treated as a singular item in any kind of list context, regardless of whether the object is essentially composite or unitary. It will not automatically dereference to its contents unless placed explicitly in some kind of dereferencing context. In particular, when interpolating into list context, <code>$x</code> never expands its object to anything other than the object itself as a single item, even if the object is a container object containing multiple items.</p>

<p><code>@x</code> may be bound to an object of the <code>Array</code> class, but it may also be bound to any object that does the <code>Positional</code> role, such as a <code>Range</code>, <code>Buf</code>, <code>Parcel</code>, or <code>Capture</code>. The <code>Positional</code> role implies the ability to support <code>postcircumfix:&#60;[ ]&#62;</code>.</p>

<p>Likewise, <code>%x</code> may be bound to any object that does the <code>Associative</code> role, such as <code>Pair</code>, <code>Set</code>, <code>Bag</code>, <code>Mix</code>, or <code>Capture</code>. The <code>Associative</code> role implies the ability to support <code>postcircumfix:&#60;{ }&#62;</code>.</p>

<p><code>&#38;x</code> may be bound to any object that does the <code>Callable</code> role, such as any <code>Block</code> or <code>Routine</code>. The <code>Callable</code> role implies the ability to support <code>postcircumfix:&#60;( )&#62;</code>.</p>

<p>In any case, the minimal container role implied by the sigil is checked at binding time at the latest, and may fail earlier (such as at compile time) if a semantic error can be detected sooner. If you wish to bind an object that doesn&#39;t yet do the appropriate role, you must either stick with the generic <code>$</code> sigil, or mix in the appropriate role before binding to a more specific sigil.</p>

<p>An object is allowed to support both <code>Positional</code> and <code>Associative</code>. An object that does not support <code>Positional</code> may not be bound directly to <code>@x</code>. However, any construct such as <code>%x</code> that can interpolate the contents of such an object into list context can automatically construct a list value that may then be bound to an array variable. Subscripting such a list does not imply subscripting back into the original object.</p>

<h3><a class='u' href='#___top' title='click to go to top of document'
name="No_intervening_whitespace"
>No intervening whitespace</a></h3>

<p>Unlike in Perl 5, you may no longer put whitespace between a sigil and its following name or construct.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="Twigils"
>Twigils</a></h2>

<p>Ordinary sigils indicate normally scoped variables, either lexical or package scoped. Oddly scoped variables include a secondary sigil (a <b>twigil</b>) that indicates what kind of strange scoping the variable is subject to:</p>

<pre><code>$foo        ordinary scoping
$.foo       object attribute public accessor
$^foo       self-declared formal positional parameter
$:foo       self-declared formal named parameter
$*foo       dynamically overridable global variable
$?foo       compiler hint variable
$=foo       Pod variable
$&#60;foo&#62;      match variable, short for $/{&#39;foo&#39;}
$!foo       object attribute private storage
$~foo       the foo sublanguage seen by the parser at this lexical spot</code></pre>

<p>Most variables with twigils are implicitly declared or assumed to be declared in some other scope, and don&#39;t need a &#34;my&#34; or &#34;our&#34;. Attribute variables are declared with <code>has</code>, though.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="Scope_declarators"
>Scope declarators</a></h2>

<p>Normal names and variables are declared using a <i>scope declarator</i>:</p>

<pre><code>my          # introduces lexically scoped names
our         # introduces package-scoped names
has         # introduces attribute names
anon        # introduces names that are private to the construct
state       # introduces lexically scoped but persistent names
augment     # adds definitions to an existing name
supersede   # replaces definitions of an existing name</code></pre>

<p>Names may also be declared in the signature of a function. These are equivalent to a <code>my</code> declaration inside the block of the function, except that such parameters default to readonly.</p>

<p>The <code>anon</code> declarator allows a declaration to provide a name that can be used in error messages, but that isn&#39;t put into any external symbol table:</p>

<pre><code>my $secret = anon sub marine () {...}
$secret(42);  # too many arguments to sub marine</code></pre>

<p>However, the name is introduced into the scope of the declaration itself, so it may be used to call itself recursively:</p>

<pre><code>my $secret = anon sub tract($n) { say $n; tract($n-1) if $n };
$secret(5); # 5 4 3 2 1 0</code></pre>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="Invariant_sigils"
>Invariant sigils</a></h2>

<p>Sigils are now invariant. <code>$</code> always means a scalar variable, <code>@</code> an array variable, and <code>%</code> a hash variable, even when subscripting. In item context, variables such as <code>@array</code> and <code>%hash</code> simply return themselves as <code>Array</code> and <code>Hash</code> objects. (Item context was formerly known as scalar context, but we now reserve the &#34;scalar&#34; notion for talking about variables rather than contexts, much as arrays are disassociated from list context.)</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="List_stringification"
>List stringification</a></h2>

<p>In string contexts, lists and list-like objects automatically stringify to appropriate (white-space separated) string values. In numeric contexts, the number of elements in the container is returned. In boolean contexts, a true value is returned if and only if there are any elements in the container.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="The_.perl_method"
>The <code>.perl</code> method</a></h2>

<p>To get a Perlish representation of any object, use the <code>.perl</code> method. Like the <code>Data::Dumper</code> module in Perl 5, the <code>.perl</code> method will put quotes around strings, square brackets around list values, curlies around hash values, constructors around objects, properly handle circular references etc., so that Perl can evaluate the result back to the same object. The <code>.perl</code> method will return a representation of the object on the assumption that, if the code is reparsed at some point, it will be used to regenerate the object as a scalar in item context. If you wish to interpolate the regenerated object in a list context, it may be necessary to use <code>prefix:&#60;|&#62;</code> to force interpolation.</p>

<p>Note that <code>.perl</code> has a very specific definition, and it is expected that some modules will rely on the ability to roundtrip values with <code>EVAL</code>. As such, overriding <code>.perl</code> with a different format (globally using <code>MONKEY_TYPING</code>, or for specific classes unless special care is taken to maintain parsability) is unwise. Code which does not depend on <code>.perl</code>&#39;s definition should use <code>.gist</code> instead to allow more control.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="The_.gist_method"
>The <code>.gist</code> method</a></h2>

<p><code>.gist</code>, by contrast with <code>.perl</code>, returns a flexible form of an object intended for human interpretation. For example, when presented with a very long list or array, only the first 100 entries will be printed, followed by <code>...</code> to indicate there are more entries. If that&#39;s not what you want, stringify the list instead. This method is only supposed to give you the gist of the value, not the whole value.</p>

<p>Specific user classes are encouraged to override <code>.gist</code> to do something appropriate, and it is completely acceptable to monkey patch <code>.gist</code> methods while doing debugging, without risk of breaking any used module. <code>.gist</code>, like any method, will accept and ignore unrecognized named arguments; implementations of <code>.gist</code> are encouraged to standardize on a set of flags.</p>

<p>[Some conjectural suggestions:</p>

<pre><code>:oneline        Do not indent or linebreak output
:width($d)      Wrap output at $d chars
:charset($obj)  Represent unrecognized characters as escapes
:ascii          Short for some instantiation of :charset</code></pre>

<p>Conjecturally, <code>.gist</code> on system-defined classes could redispatch to <code>&#38;*PRETTYPRINTER</code> or some similar system, allowing for a more disciplined way to change pretty formats.</p>

<p>It may also be desirable to use a richer format for intermediate strings than simple <code>Str</code>, for instance using an object format that can handle intelligent line breaking. However, that&#39;s probably overkill.]</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="The_.fmt_method"
>The <code>.fmt</code> method</a></h2>

<p>To get a formatted representation of any scalar value, use the <code>.fmt(&#39;%03d&#39;)</code> method to do an implicit <code>sprintf</code> on the value.</p>

<p>To format an array value separated by commas, supply a second argument: <code>.fmt(&#39;%03d&#39;, &#39;, &#39;)</code>. To format a hash value or list of pairs, include formats for both key and value in the first string: <code>.fmt(&#39;%s: %s&#39;, &#34;\n&#34;)</code>.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="Subscripts"
>Subscripts</a></h2>

<p>Subscripts now consistently dereference the container produced by whatever was to their left. Whitespace is not allowed between a variable name and its subscript. However, there are two ways to stretch the construct out visually. Since a subscript is a kind of postfix operator, there is a corresponding <b>dot</b> form of each subscript (<code>@foo.[1]</code> and <code>%bar.{&#39;a&#39;}</code>) that makes the dereference a little more explicit. Constant string subscripts may be placed in angles, so <code>%bar.{&#39;a&#39;}</code> may also be written as <code>%bar&#60;a&#62;</code> or <code>%bar.&#60;a&#62;</code>. Additionally, you may insert extra whitespace using the unspace.</p>

<p>Slicing is specified by the nature of the subscript, not by the sigil.</p>

<h3><a class='u' href='#___top' title='click to go to top of document'
name="Subscripts_have_list_context"
>Subscripts have list context</a></h3>

<p>The context in which a subscript is evaluated is no longer controlled by the sigil either. Subscripts are always evaluated in list context. (More specifically, they are evaluated in a variant of list context known as <i>lol</i> context (List of List), which preserves dimensional information so that you can do multi-dimensional slices using semicolons. However, each slice dimension evaluates its sublist in normal list context, so functions called as part of a subscript don&#39;t see a lol context. See S09 for more on slicing.)</p>

<p>If you need to force inner context to item (scalar), we now have convenient single-character context specifiers such as + for numbers and ~ for strings:</p>

<pre><code>$x        =  g();       # item context for g()
@x[f()]   =  g();       # list context for f() and g()
@x[f()]   = +g();       # list context for f(), numeric item context for g()
@x[+f()]  =  g();       # numeric item context for f(), list context for g()

@x[f()]   =  @y[g()];   # list context for f() and g()
@x[f()]   = +@y[g()];   # list context for f() and g()
@x[+f()]  =  @y[g()];   # numeric item context for f(), list context for g()
@x[f()]   =  @y[+g()];  # list context for f(), numeric item context for g()

%x{~f()}  =  %y{g()};   # string item context for f(), list context for g()
%x{f()}   =  %y{~g()};  # list context for f(), string item context for g()</code></pre>

<p>Sigils used as functions with parenthesis also force context, so these also work:</p>

<pre><code>@x[$(g())]         # item context for g()
%x{$(g())}         # item context for g()</code></pre>

<p>But note that these don&#39;t do the same thing:</p>

<pre><code>@x[$g()]           # call function in $g
%x{$g()}           # call function in $g</code></pre>

<p>Array and Hash variables can be evaluated in item context by prefixing them with a single dollar sign:</p>

<pre><code>$@a               # same as  item @a
$%h               # same as  item %h</code></pre>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="List_assignment_and_binding"
>List assignment and binding</a></h2>

<p>There is a need to distinguish list assignment from list binding. List assignment works much like it does in Perl 5, copying the values. There&#39;s a new <code>:=</code> binding operator that lets you bind names to <code>Array</code> and <code>Hash</code> objects without copying, in the same way as subroutine arguments are bound to formal parameters. See S06 for more about binding.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="Parcels"
>Parcels</a></h2>

<p>A list of zero or more comma-separated objects may be grouped together by parentheses into a &#34;parenthesis cell&#34;, or <code>Parcel</code>. This kind of list should not be confused with the flattening list context. Instead, this is a raw syntactic list that has not yet committed to flattening; no interpretation is made of the list inside without knowing what context it will be evaluated in. For example, when you say:</p>

<pre><code>(1,2,3,:mice&#60;blind&#62;)</code></pre>

<p>the result is a <code>Parcel</code> object containing three <code>Int</code> objects and a <code>Pair</code> object, that is, four positional objects. When, however, you say something like:</p>

<pre><code>rhyme(1,2,3,:mice&#60;blind&#62;)</code></pre>

<p>the syntactic <code>Parcel</code> is translated (at compile time, in this case) into a <code>Capture</code> object with three positionals and one named argument in preparation for binding. More generally, a parcel is transmuted to a capture any time it is bound to a complete signature.</p>

<p>You may force immediate conversion to a <code>Capture</code> object by prefixing the parcel composer with a backslash:</p>

<pre><code>$args = \(1,2,3,:mice&#60;blind&#62;)</code></pre>

<p>Individual arguments in a parcel or capture composer are parsed as ordinary expressions, and any functions mentioned are called immediately, with each function&#39;s results placed as an argument (often a subparcel, if the function returns multiple values) within the outer parcel (or capture). Whether any given argument is flattened will depend on its eventual binding, and in general cannot be known at parcel/capture composition time.</p>

<p>We use &#34;argument&#34; here to mean anything that would be taken as a single argument if bound to a positional or named parameter:</p>

<pre><code>rhyme(1,2,3,:mice&#60;blind&#62;)     # rhyme has 4 arguments
rhyme((1,2),3,:mice&#60;blind&#62;)   # rhyme has 3 arguments
rhyme((1,2,3),:mice&#60;blind&#62;)   # rhyme has 2 arguments
rhyme((1,2),(3,:mice&#60;blind&#62;)) # rhyme has 2 arguments
rhyme((1,2,3,:mice&#60;blind&#62;))   # rhyme has 1 argument</code></pre>

<p>In these examples, the first argument to the function is a parcel in all but the first case, where it is simply the literal integer 1. An argument is either of:</p>

<ul>
<li>A parcel that groups together a sublist, or</li>

<li>Any other object that can function as a single argument.</li>
</ul>

<p>Looking at it the other way, all arguments that don&#39;t actually need to be wrapped up in a parcel are considered degenerate parcels in their own right when it comes to binding. Note that a capture is not considered a kind of parcel, so does not flatten in flat context.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="Parcels,_parameters,_and_Captures"
>Parcels, parameters, and Captures</a></h2>

<p>When a <code>Parcel</code> is bound to a parameter, the behavior depends on whether the parameter is &#34;flattening&#34; or &#34;argumentative&#34;. Positional parameters and slice parameters are argumentative and call <code>.getarg</code> on the internal iterator and just return the next syntactic argument (parcel or other object) without flattening. (A slice differs from an ordinary positional parameter in being &#34;slurpy&#34;, that is, it is intended to fetch multiple values from the variadic region of the surrounding capture. Slurpy contexts come in both flattening (<code>*</code> parameters) and slicing (<code>**</code> parameters) forms.)</p>

<p>The fact that a parameter is being bound implies that there is an outer capture being bound to a signature. The capture&#39;s iterator provides a <code>.get</code> and a <code>.getarg</code> method to tell the iterator what context to bind in. For positional/slice parameters, the <code>.getarg</code> method returns the entire next argument from the iterator. It returns other objects unchanged. In contrast, flat parameters call <code>.get</code> on the capture&#39;s iterator, which flattens any subparcels before pulling out the next item. In either case, no bare parcel object is seen as a normal bound argument. (There is a way to bind the underlying parcel using backslash, however. This is how internal routines can deal with parcels as real objects.)</p>

<p>In contrast to parameter binding, if a <code>Parcel</code> is bound to an entire signature (typically as part of a function or method call), it will be transformed first into a capture object, which is much like a parcel but has its arguments divvied up into positional and named subsets for faster binding. (Usually this transformation happens at compile time.) If the first positional is followed by a colon instead of a comma, it is marked as the invocant in case it finds itself in a context that cares. It&#39;s illegal to use the colon in place of the comma anywhere except after the first argument.</p>

<p>Explicit binding to an individual variable is considered a form of signature binding, which is to say a declarator puts implicit signature parens around the unparenthesized form:</p>

<pre><code>my (*@x) := foo(); # signature binding
my *@x := foo();   # same thing</code></pre>

<p>The parens are, of course, required if there is more than one parameter.</p>

<p><code>Capture</code> objects are immutable in the abstract, but evaluate their arguments lazily. Before everything inside a <code>Capture</code> is fully evaluated (which happens at compile time when all the arguments are constants), the eventual value may well be unknown. All we know is that we have the promise to make the bits of it immutable as they become known.</p>

<p><code>Capture</code> objects may contain multiple unresolved iterators such as feeds or parcels or lists of parcels. How these are resolved depends on what they are eventually bound to. Some bindings are sensitive to multiple dimensions while others are not. Binding to a list of lists is often known as &#34;slicing&#34;, because it&#39;s commonly used to index &#34;slices&#34; of a potentially multi-dimensional array.</p>

<p>You may retrieve parts from a <code>Capture</code> object with a prefix sigil operator:</p>

<pre><code>$args = \3;     # same as &#34;$args = \(3)&#34;
@$args;         # same as &#34;Array($args)&#34;
%$args;         # same as &#34;Hash($args)&#34;</code></pre>

<p>When cast into an array, you can access all the positional arguments; into a hash, all named arguments.</p>

<p>All prefix sigil operators accept one positional argument, evaluated in item context as a rvalue. They can interpolate in strings if called with parentheses. The special syntax form <code>$()</code> translates into <code>$( $/.made // Str($/) )</code> to operate on the current match object; similarly <code>@()</code> and <code>%()</code> can extract positional and named submatches.</p>

<p><code>Parcel</code> and <code>Capture</code> objects fill the ecological niche of references in Perl 6. You can think of them as &#34;fat&#34; references, that is, references that can capture not only the current identity of a single object, but also the relative identities of several related objects. Conversely, you can think of Perl 5 references as a degenerate form of <code>Capture</code> when you want to refer only to a single item.</p>

<p>The <code>sink</code> statement prefix will eagerly evaluate any block or statement, throw away the results, and instead return the empty <code>Parcel</code> value, <code>()</code>. This can be useful to peg some behavior to an empty list while still returning an empty list:</p>

<pre><code># Check that incoming argument list isn&#39;t null
@inclist = map { $_ + 1 }, @list || sink warn &#39;Nil input!&#39;;

@inclist = do for @list || sink { warn &#39;Nil input!&#39;; $warnings++; } {
    $_ + 1;
}

# Check that outgoing result list isn&#39;t null
@inclist = do map { $_ + 1 }, @list or sink warn &#39;Nil result!&#39;;

@inclist = do for @list {
    $_ + 1;
} or sink { warn &#39;Nil result&#39;; $warnings++; }</code></pre>

<p>Given <code>sink</code>, there&#39;s no need for an &#34;else&#34; clause on Perl 6&#39;s loops, and the <code>sink</code> construct works in any list, not just <code>for</code> loops.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="CaptureCursors"
>CaptureCursors</a></h2>

<p>A <code>CaptureCursor</code> object is a view into another capture with an associated start position. Such a cursor is essentially a pattern-matching state. Capture cursors are used for operations like <code>grep</code> and <code>map</code> and <code>for</code> loops that need to apply a short signature multiple times to a longer list of values supplied by the base capture. When we say &#34;capture&#34; we sometimes mean either <code>Capture</code> or <code>CaptureCursor</code>. <code>CaptureCursors</code> are also immutable. When pattern matching a signature against a cursor, you get a new cursor back which tells you the new position in the base capture.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="Signature_objects"
>Signature objects</a></h2>

<p>A signature object (<code>Signature</code>) may be created with colon-prefixed parens:</p>

<pre><code>my ::MySig ::= :(Int, Num, Complex, Status)</code></pre>

<p>Expressions inside the signature are parsed as parameter declarations rather than ordinary expressions. See S06 for more details on the syntax for parameters.</p>

<p>Declarators generally make the colon optional:</p>

<pre><code>my ($a,$b,$c);      # parsed as signature</code></pre>

<p>Signature objects bound to type variables (as in the example above) may be used within other signatures to apply additional type constraints. When applied to a capture argument, the signature allows you to take the types of the capture&#39;s arguments from <code>MySig</code>, but declare the (untyped) variable names yourself via an additional signature in parentheses:</p>

<pre><code>sub foo (Num  $num, MySig $a ($i,$j,$k,$mousestatus)) {...}
foo($mynum, \(1, 2.7182818, 1.0i, statmouse());</code></pre>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="Ampersand_and_invocation"
>Ampersand and invocation</a></h2>

<p>Unlike in Perl 5, the notation <code>&#38;foo</code> merely stands for the <code>foo</code> function as a <code>Routine</code> object without calling it. You may call any Code object by dereferencing it with parens (which may, of course, contain arguments):</p>

<pre><code>&#38;foo($arg1, $arg2);</code></pre>

<p>Whitespace is not allowed before the parens because it is parsed as a postfix. As with any postfix, there is also a corresponding <code>.()</code> operator, and you may use the &#34;unspace&#34; form to insert optional whitespace and comments between the backslash and either of the postfix forms:</p>

<pre><code>&#38;foo\   ($arg1, $arg2);
&#38;foo\   .($arg1, $arg2);
&#38;foo\#`[
    embedded comment
].($arg1, $arg2);</code></pre>

<p>Note however that the parentheses around arguments in the &#34;normal&#34; named forms of function and method calls are not postfix operators, so do not allow the <code>.()</code> form, because the dot is indicative of an actual dereferencing operation, which the named forms aren&#39;t doing. You may, however, use &#34;unspace&#34; to install extra space before the parens in the forms:</p>

<pre><code>foo()       # okay
foo\ ()     # okay
foo.()      # means foo().()

.foo()      # okay
.foo\ ()    # okay
.foo.()     # means .foo().()

$.foo()     # okay
$.foo\ ()   # okay
$.foo.()    # means $.foo().()</code></pre>

<p>If you <i>do</i> use the dotty form on these special forms, it will assume you wanted to call the named form without arguments, and then dereference the result of that.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="Specifying_a_dispatch_candidate"
>Specifying a dispatch candidate</a></h2>

<p>With multiple dispatch, <code>&#38;foo</code> is actually the name of a <code>dispatch</code> routine (instantiated from a <code>proto</code>) controlling a set of candidate functions (which you can use as if it were an ordinary function, because a <code>dispatch</code> is really an <code>only</code> function with pretensions to management of a dispatcher). However, in that case <code>&#38;foo</code> by itself is not sufficient to uniquely name a specific function. To do that, the type may be refined by using a signature literal as a postfix operator:</p>

<pre><code>&#38;foo:(Int,Num)</code></pre>

<p>Use of a signature that does not unambiguously select a single multi results in failure.</p>

<p>It still just returns a <code>Routine</code> object. A call may also be partially applied (primed) by using the <code>.assuming</code> method:</p>

<pre><code>&#38;foo.assuming(1,2,3,:mice&#60;blind&#62;)</code></pre>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="Multidimensional_slices_and_parcels"
>Multidimensional slices and parcels</a></h2>

<p>Slicing syntax is covered in S09. A multidimensional slice will be done with semicolons between individual slice sublists. The semicolons imply one extra level of tree-ness, where the top list is of type <code>LoL</code> and sublists are <code>Lists</code>s (or non-iterable items that can function as single-item parcels). So when you say</p>

<pre><code>@matrix[1..*; 0]</code></pre>

<p>really means</p>

<pre><code>@matrix[LoL.new( (1..*), 0 )]</code></pre>

<p>or more briefly,</p>

<pre><code>@matrix[lol (1..*), 0]</code></pre>

<p>Each such slice sub-parcel is evaluated lazily.</p>

<p>Just as parens and brackets can be used to compose parcels and arrays, if you put any semicolons into either form, it becomes a multi-dimensional composer:</p>

<pre><code>(1..*; 0)   # same as (lol (1..*), 0), that is LoL.new($(1..*), 0)
[1..*; 0]   # same as [lol (1..*), 0], that is Array.new($(1..*), 0)</code></pre>

<p>A consequence of this is that you may not put more than one statement inside parens or brackets expecting sequence semantics, that is, the way a normal block evaluates all but the final statement for declarations or side effects, then returns the value of the final statement. In order to do that in Perl 6, you need to use one of these constructs:</p>

<pre><code>do { my $x = 42; $x }
SEQ( my $x = 42; $x )
$( my $x = 42; $x )
@( my @x = 42,43; @x )
%( my %x = a =&#62; 42; %x )</code></pre>

<p>Note that the first one limits the scope of the declaration to the block, while the parenthesized forms are parasitic on the outer lexical scope.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="Subscript_adverbs"
>Subscript adverbs</a></h2>

<p>To make a slice subscript return something other than values, append an appropriate adverb to the subscript.</p>

<pre><code>@array = &#60;A B&#62;;
@array[0,1,2];      # returns &#39;A&#39;, &#39;B&#39;, (Any)
@array[0,1,2] :p;   # returns 0 =&#62; &#39;A&#39;, 1 =&#62; &#39;B&#39;
@array[0,1,2] :kv;  # returns 0, &#39;A&#39;, 1, &#39;B&#39;
@array[0,1,2] :k;   # returns 0, 1
@array[0,1,2] :v;   # returns &#39;A&#39;, &#39;B&#39;

%hash = (:a&#60;A&#62;, :b&#60;B&#62;);
%hash&#60;a b c&#62;;       # returns &#39;A&#39;, &#39;B&#39;, (Any)
%hash&#60;a b c&#62; :p;    # returns a =&#62; &#39;A&#39;, b =&#62; &#39;B&#39;
%hash&#60;a b c&#62; :kv;   # returns &#39;a&#39;, &#39;A&#39;, &#39;b&#39;, &#39;B&#39;
%hash&#60;a b c&#62; :k;    # returns &#39;a&#39;, &#39;b&#39;
%hash&#60;a b c&#62; :v;    # returns &#39;A&#39;, &#39;B&#39;</code></pre>

<p>These adverbial forms all weed out non-existing entries if the adverb is true; if not, they leave them in, just as an ordinary slice would. So:</p>

<pre><code>@array[0,1,2] :!p;  # returns 0 =&#62; &#39;A&#39;, 1 =&#62; &#39;B&#39;, 2 =&#62; (Any)
%hash&#60;a b c&#62;  :!kv; # returns &#39;a&#39;, &#39;A&#39;, &#39;b&#39;, &#39;B&#39;, &#39;c&#39;, (Any)</code></pre>

<p>Likewise,</p>

<pre><code>my ($a,$b,$c) = %hash&#60;a b c&#62; :delete;</code></pre>

<p>deletes the entries <i>en passant</i> while returning them. (Of course, any of these forms also work in the degenerate case of a slice containing a single index.) Note that these forms work by virtue of the fact that the subscript is the topmost previous operator. You may have to parenthesize or force list context if some other operator that is tighter than comma would appear to be topmost:</p>

<pre><code>1 + (%hash{$x} :delete);
$x = (%hash{$x} :delete);
($x) = %hash{$x} :delete;</code></pre>

<p>(The situation does not often arise for the slice modifiers above because they are usually used in list context, which operates at comma precedence.)</p>

<p>The element is deleted only if the adverb is true. While <code>:!delete</code> is essentially a no-op; you could conditionally delete entries <i>en passant</i> based on passing a flag such as in <code>:delete($kill&#39;em)</code>. In either case, the values are returned.</p>

<p>You may also perform an existence test, either on a single item or a junction of items:</p>

<pre><code>if %hash&#60;foo&#62; :exists {...}
if %hash{any &#60;a b c&#62;} :exists {...}
if %hash{all &#60;a b c&#62;} :exists {...}
if %hash{one &#60;a b c&#62;} :exists {...}
if %hash{none &#60;a b c&#62;} :exists {...}</code></pre>

<p>Using the <code>:exists</code> adverb together with a list slice results in in a <code>Parcel</code> of <code>Bool</code>, which you could also put in a junction with similar semantics:</p>

<pre><code>if any %hash&#60;a b c&#62; :exists {...}
if all %hash&#60;a b c&#62; :exists {...}
if one %hash&#60;a b c&#62; :exists {...}
if none %hash&#60;a b c&#62; :exists {...}</code></pre>

<p>although with different optimization options for the compiler.</p>

<p>You may use :!exists to test for non-existence. This is specifically handy because of precedence rules making <code>!%hash&#60;a</code>:exists&#62; apply the :exists to the prefix <code>!</code>. <code>%hash&#60;a</code>:!exists&#62; does not have that problem.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="Combining_subscript_adverbs"
>Combining subscript adverbs</a></h2>

<p>Like named parameters in a call, there is no order in handling multiple adverbs with subscripts. Some combinations make sense, such as:</p>

<pre><code>  %a = %b{@keys-to-extract} :delete :p; # same as :p :delete</code></pre>

<p>would slice out pairs for the given the keys out of one hash into another. Whereas</p>

<pre><code>  @actually-deleted = %h{@keys-to-extract} :delete :k; # same as :k :delete</code></pre>

<p>would return the <i>keys</i> that were actually deleted from the hash.</p>

<p>The adverbs that specify a return type only, can <b>not</b> be combined, because combinations such as <i>:kv:p</i> or <i>:v:k</i> simply do not make sense.</p>

<p>These combinations are considered legal and mean the following:</p>

<pre><code>  :delete :kv            delete, return key/values of actually deleted keys
  :delete :!kv           delete, return key/values of all keys attempted
  :delete :p             delete, return pairs of actually deleted keys
  :delete :!p            delete, return pairs of all keys attempted
  :delete :k             delete, return actually deleted keys
  :delete :!k            delete, return all keys attempted to delete
  :delete :v             delete, return values of actually deleted keys
  :delete :!v            delete, return values of all keys attempted
  :delete :exists        delete, return Bools indicating keys existed
  :delete :!exists       delete, return Bools indicating keys did not exist
  :delete :exists :kv    delete, return list with key,True for key existed
  :delete :!exists :kv   delete, return list with key,False for key existed
  :delete :exists :!kv   delete, return list with key,Bool whether key existed
  :delete :!exists :!kv  delete, return list with key,!Bool whether key existed
  :delete :exists :p     delete, return pairs with key/True for key existed
  :delete :!exists :p    delete, return pairs with key/False for key existed
  :delete :exists :!p    delete, return pairs with key/Bool whether key existed
  :delete :!exists :!p   delete, return pairs with key/!Bool whether key existed
  :exists :kv            return pairs with key,True for key exists
  :!exists :kv           return pairs with key,False for key exists
  :exists :!kv           return pairs with key,Bool for key exists
  :!exists :!kv          return pairs with key,!Bool for key exists
  :exists :p             return pairs with key/True for key exists
  :!exists :p            return pairs with key/False for key exists
  :exists :!p            return pairs with key/Bool for key exists
  :!exists :!p           return pairs with key/!Bool for key exists</code></pre>

<p>An implementation is free to silently ignore any other combinations or silently prefer one of the adverbs given above any other.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="Numeric_and_boolean_context_of_hashes"
>Numeric and boolean context of hashes</a></h2>

<p>In numeric context (i.e. when cast into <code>Int</code> or <code>Num</code>), a <code>Hash</code> object becomes the number of pairs contained in the hash. In a boolean context, a Hash object is true if there are any pairs in the hash.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="List_sorting"
>List sorting</a></h2>

<p>Sorting a list of pairs should sort on their keys by default, then on their values. Sorting a list of lists should sort on the first elements, then the second elements, etc. For more on <code>sort</code> see S29.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="Special_variables"
>Special variables</a></h2>

<p>Many of the special variables of Perl 5 are going away. Those that apply to some object such as a filehandle will instead be attributes of the appropriate object. Those that are truly global will have global alphabetic names, such as <code>$*PID</code> or <code>@*ARGS</code>.</p>

<p>Any remaining special variables will be lexically scoped. This includes <code>$_</code> and <code>@_</code>, as well as the new <code>$/</code>, which is the return value of the last regex match. <code>$0</code>, <code>$1</code>, <code>$2</code>, etc., are aliases into the <code>$/</code> object.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="Array_end_index"
>Array end index</a></h2>

<p>The <code>$#foo</code> notation is dead. Use <code>@foo.end</code> or <code>@foo[*-1]</code> instead. (Or <code>@foo.shape[$dimension]</code> for multidimensional arrays.)</p>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="Names"
>Names</a></h1>

<p>An <i>identifier</i> is composed of an alphabetic character followed by any sequence of alphanumeric characters. The definitions of alphabetic and numeric include appropriate Unicode characters. Underscore is always considered alphabetic. An identifier may also contain isolated apostrophes or hyphens provided the next character is alphabetic.</p>

<p>A <i>name</i> is anything that is a legal part of a variable name (not counting the sigil). This includes</p>

<pre><code>$foo                # simple identifiers
$Foo::Bar::baz      # compound identifiers separated by ::
$Foo::($bar)::baz   # compound identifiers that perform interpolations
$42                 # numeric names
$!                  # certain punctuational variables</code></pre>

<p>When not used as a sigil, the semantic function of <code>::</code> within a name is to force the preceding portion of the name to be considered a package through which the subsequent portion of the name is to be located. If the preceding portion is null, it means the package is unspecified and must be searched for according to the nature of what follows. Generally this means that an initial <code>::</code> following the main sigil is a no-op on names that are known at compile time, though <code>::()</code> can also be used to introduce an interpolation (see below). Also, in the absence of another sigil, <code>::</code> can serve as its own sigil indicating intentional use of a not-yet-declared package name.</p>

<p>Unlike in Perl 5, if a sigil is followed by comma, semicolon, a colon not followed by an identifier, or any kind of bracket or whitespace (including Unicode brackets and whitespace), it will be taken to be a sigil without a name rather than a punctuational variable. This allows you to use sigils as coercion operators:</p>

<pre><code>print $( foo() )    # foo called in item context
print %( foo() )   # foo called in hash context</code></pre>

<p>In declarative constructs bare sigils may be used as placeholders for anonymous variables:</p>

<pre><code>my ($a, $, $c) = 1..3;
print unless (state $)++;</code></pre>

<p>Outside of declarative constructs you may use <code>*</code> for a placeholder:</p>

<pre><code>($a, *, $c) = 1..3;</code></pre>

<p>Attempts to say something like:</p>

<pre><code>($a, $, $c) = 1..3;</code></pre>

<p>will result in the message, &#34;Anonymous variable requires declarator&#34;.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="Package-qualified_names"
>Package-qualified names</a></h2>

<p>Ordinary package-qualified names look like they do in Perl 5:</p>

<pre><code>$Foo::Bar::baz      # the $baz variable in package Foo::Bar</code></pre>

<p>Sometimes it&#39;s clearer to keep the sigil with the variable name, so an alternate way to write this is:</p>

<pre><code>Foo::Bar::&#60;$baz&#62;</code></pre>

<p>This is resolved at compile time because the variable name is a constant.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="Pseudo-packages"
>Pseudo-packages</a></h2>

<p>The following pseudo-package names are reserved at the front of a name:</p>

<pre><code>MY          # Symbols in the current lexical scope (aka $?SCOPE)
OUR         # Symbols in the current package (aka $?PACKAGE)
CORE        # Outermost lexical scope, definition of standard Perl
GLOBAL      # Interpreter-wide package symbols, really UNIT::GLOBAL
PROCESS     # Process-related globals (superglobals)
COMPILING   # Lexical symbols in the scope being compiled
DYNAMIC     # Contextual symbols in my or any caller&#39;s lexical scope</code></pre>

<p>The following relative names are also reserved but may be used anywhere in a name:</p>

<pre><code>CALLER      # Contextual symbols in the immediate caller&#39;s lexical scope
OUTER       # Symbols in the next outer lexical scope
UNIT        # Symbols in the outermost lexical scope of compilation unit
SETTING     # Lexical symbols in the unit&#39;s DSL (usually CORE)
PARENT      # Symbols in this package&#39;s parent package (or lexical scope)</code></pre>

<p>Other all-caps names are semi-reserved. We may add more of them in the future, so you can protect yourself from future collisions by using mixed case on your top-level packages. (We promise not to break any existing top-level CPAN package, of course. Except maybe <code>ACME</code>, and then only for coyotes.)</p>

<p>The file&#39;s scope is known as <code>UNIT</code>, but there are one or more lexical scopes outside of that corresponding to the linguistic setting (often known as the prelude in other cultures). Hence, the <code>SETTING</code> scope is equivalent to <code>UNIT::OUTER</code>. For a standard Perl program <code>SETTING</code> is the same as <code>CORE</code>, but various startup options (such as <code>-n</code> or <code>-p</code>) can put you into a domain specific language, in which case <code>CORE</code> remains the scope of the standard language, while <code>SETTING</code> represents the scope defining the DSL that functions as the setting of the current file. See also the <code>-L</code>/<code>--language</code> switch described in <a href="http://search.cpan.org/perldoc?S19" class="podlinkpod"
>S19</a>. If a setting wishes to gain control of the main execution, it merely needs to declare a <code>MAIN</code> routine as documented in S06. In this case the ordinary execution of the user&#39;s code is suppressed; instead, execution of the user&#39;s code is entirely delegated to the setting&#39;s <code>MAIN</code> routine, which calls back to the user&#39;s lexically embedded code with <code>{YOU_ARE_HERE}</code>.</p>

<p>The <code>{YOU_ARE_HERE}</code> functions within the setting as a proxy for the user&#39;s <code>UNIT</code> block, so <code>-n</code> and <code>-p</code> may be implemented in a setting with:</p>

<pre><code>for $*ARGFILES.lines {YOU_ARE_HERE}                 # -n
map *.say, do for $*ARGFILES.lines {YOU_ARE_HERE}   # -p</code></pre>

<p>or</p>

<pre><code>map {YOU_ARE_HERE}, $*ARGFILES.lines;               # -n
map *.say, map {YOU_ARE_HERE}, $*ARGFILES.lines;    # -p</code></pre>

<p>and the user may use loop control phasers as if they were directly in the loop block. Any <code>OUTER</code> in the user&#39;s code refers to the block outside of <code>{YOU_ARE_HERE}</code>. If used as a standalone statement, <code>{YOU_ARE_HERE}</code> runs as if it were a bare block.</p>

<p>Note that, since the <code>UNIT</code> of an <code>EVAL</code> is the evaluated string itself, the <code>SETTING</code> of an <code>EVAL</code> is the language in effect at the point of the <code>EVAL</code>, not the language in effect at the top of the file. (You may, however, use <code>OUTER::SETTING</code> to get the setting of the code that is executing the <code>EVAL</code>.) In more traditional terms, the normal program is functioning as the &#34;prelude&#34; of the <code>EVAL</code>.</p>

<p>So the outermost lexical scopes nest like this, traversed via <code>OUTER</code>:</p>

<pre><code>CORE &#60;= SETTING &#60; UNIT &#60; (your_block_here)</code></pre>

<p>The outermost package scopes nest like this, traversed via <code>PARENT</code>:</p>

<pre><code>GLOBAL &#60;  (your_package_here)</code></pre>

<p>Your main program starts up in the <code>GLOBAL</code> package and the <code>UNIT</code> lexical scope. Whenever anything is declared with &#34;our&#34; semantics, it inserts a name into both the current package and the current lexical scope. (And &#34;my&#34; semantics only insert into the current lexical scope.) Note that the standard setting, <code>CORE</code>, is a lexical scope, not a package; the various items that are defined within (or imported into) <code>CORE</code> are *not* in <code>GLOBAL</code>, which is pretty much empty when your program starts compiling, and mostly only contains things you either put there yourself, or some other module put there because you used that module. In general things defined within (or imported into) <code>CORE</code> should only be declared or imported with &#34;my&#34; semantics. All Perl code can see <code>CORE</code> anyway as the outermost lexical scope, so there&#39;s no need to also put such things into <code>GLOBAL</code>.</p>

<p>The <code>GLOBAL</code> package itself is accessible via <code>UNIT::GLOBAL</code>. The <code>PROCESS</code> package is accessible via <code>UNIT::PROCESS</code>. The <code>PROCESS</code> package is not the parent of <code>GLOBAL</code>. However, searching up the dynamic stack for dynamic variables will look in all nested dynamic scopes (mapped automatically to each call&#39;s lexical scope, not package scope) out to the main dynamic scope; once all the dynamic scopes are exhausted, it also looks in the <code>GLOBAL</code> package and then in the <code>PROCESS</code> package, so <code>$*OUT</code> typically finds the process&#39;s standard output handle. Hence, <code>PROCESS</code> and <code>GLOBAL</code> serve as extra outer dynamic scopes, much like <code>CORE</code> and <code>SETTING</code> function as extra outer lexical scopes.</p>

<p>Extra <code>SETTING</code> scopes keep their identity and their nesting within <code>CORE</code>, so you may have to go to <code>OUTER</code> several times from <code>UNIT</code> before you get to <code>CORE</code>. Normally, however, there is only the core setting, in which case <code>UNIT::OUTER</code> ends up meaning the same as <code>SETTING</code> which is the same as <code>CORE</code>.</p>

<p>Extra <code>GLOBAL</code> scopes are treated differently. Every compilation unit has its own associated <code>UNIT::GLOBAL</code> package. As the currently compiling compilation unit expresses the need for various other compilation units, the global names known to those other units must be merged into the new unit&#39;s <code>UNIT::GLOBAL</code>. (This includes the names in all the packages within the global package.) If two different units use the same global name, they must generally be taken to refer to the same item, but only if the type signatures can be meshed (and augmentation rules followed, in the case of package names). If two units provide package names with incompatible type signatures, the compilation of the unit fails. In other words, you may not use incompatible global types to provide a union type. However, if one or the other unit underspecifies the type in a compatible way, the underspecified type just takes on the extra type information as it learns it. (Presumably some combination of Liskov substitution, duck-typing, and run-time checking will prevent tragedy in the unit that was compiled with the underspecified type. Alternately, the compiler is allowed to recompile or re-examine the unit with the new type constraints to see if any issues are certain to arise at run time, in which case the compiler is free to complain.)</p>

<p>Any dynamic variable declared with <code>our</code> in the user&#39;s main program (specifically, the part compiled with <code>GLOBAL</code> as the current package) is accessible (by virtue of being in <code>GLOBAL</code>) as a dynamic variable even if not directly in the dynamic call chain. Note that dynamic vars do *not* look in <code>CORE</code> for anything. (They <i>might</i> look in <code>SETTING</code> if you&#39;re running under a setting distinct from <code>CORE</code>, if that setting defines a dynamic scope outside your main program, such as for the <code>-n</code> or <code>-p</code> switch.) Context variables declared with <code>our</code> in the <code>GLOBAL</code> or <code>PROCESS</code> packages do not need to use the <code>*</code> twigil, since the twigil is stripped before searching those packages. Hence, your environment variables are effectively declared without the sigil:</p>

<pre><code>augment package GLOBAL { our %ENV; }</code></pre>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="Interpolating_into_names"
>Interpolating into names</a></h2>

<p>You may interpolate a string into a package or variable name using <code>::($expr)</code> where you&#39;d ordinarily put a package or variable name. The string is allowed to contain additional instances of <code>::</code>, which will be interpreted as package nesting. You may only interpolate entire names, since the construct starts with <code>::</code>, and either ends immediately or is continued with another <code>::</code> outside the parens. Most symbolic references are done with this notation:</p>

<pre><code>$foo = &#34;Bar&#34;;
$foobar = &#34;Foo::Bar&#34;;
$::($foo)           # lexically-scoped $Bar
$::(&#34;MY::$foo&#34;)     # lexically-scoped $Bar
$::(&#34;OUR::$foo&#34;)    # package-scoped $Bar
$::(&#34;GLOBAL::$foo&#34;) # global $Bar
$::(&#34;PROCESS::$foo&#34;)# process $Bar
$::(&#34;PARENT::$foo&#34;) # current package&#39;s parent&#39;s $Bar
$::($foobar)        # $Foo::Bar
$::($foobar)::baz   # $Foo::Bar::baz
$::($foo)::Bar::baz # $Bar::Bar::baz
$::($foobar)baz     # ILLEGAL at compile time (no operator baz)</code></pre>

<p>Note that unlike in Perl 5, initial <code>::</code> doesn&#39;t imply global. Here as part of the interpolation syntax it doesn&#39;t even imply package. After the interpolation of the <code>::()</code> component, the indirect name is looked up exactly as if it had been there in the original source code, with priority given first to leading pseudo-package names, then to names in the lexical scope (searching scopes outwards, ending at <code>CORE</code>). The current package is searched last.</p>

<p>Use the <code>MY</code> pseudopackage to limit the lookup to the current lexical scope, and <code>OUR</code> to limit the scopes to the current package scope.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="Strict_lookup"
>Strict lookup</a></h2>

<p>When &#34;strict&#34; is in effect (which is the default except for one-liners), non-qualified variables (such as <code>$x</code> and <code>@y</code>) are only looked up from lexical scopes, but never from package scopes.</p>

<p>To bind package variables into a lexical scope, simply say <code>our ($x, @y)</code>. To bind global variables into a lexical scope, predeclare them with <code>use</code>:</p>

<pre><code>use PROCESS &#60;$IN $OUT&#62;;</code></pre>

<p>Or just refer to them as <code>$*IN</code> and <code>$*OUT</code>.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="Direct_lookup"
>Direct lookup</a></h2>

<p>To do direct lookup in a package&#39;s symbol table without scanning, treat the package name as a hash:</p>

<pre><code>Foo::Bar::{&#39;&#38;baz&#39;}  # same as &#38;Foo::Bar::baz
PROCESS::&#60;$IN&#62;      # Same as $*IN
Foo::&#60;::Bar&#62;&#60;::Baz&#62; # same as Foo::Bar::Baz</code></pre>

<p>The <code>::</code> before the subscript is required here, because the <code>Foo::Bar{...}</code> syntax is reserved for attaching a &#34;WHENCE&#34; initialization closure to an autovivifiable type object. (see S12).</p>

<p>Unlike <code>::()</code> symbolic references, this does not parse the argument for <code>::</code>, nor does it initiate a namespace scan from that initial point. In addition, for constant subscripts, it is guaranteed to resolve the symbol at compile time.</p>

<p>The null pseudo-package is reserved to mean the same search list as an ordinary name search. That is, the following are all identical in meaning:</p>

<pre><code>$foo
$::{&#39;foo&#39;}
::{&#39;$foo&#39;}
$::&#60;foo&#62;
::&#60;$foo&#62;</code></pre>

<p>That is, each of them scans lexical scopes outward, and then the current package scope (though the package scope is then disallowed when &#34;strict&#34; is in effect).</p>

<p>As a result of these rules, you can write any arbitrary variable name as either of:</p>

<pre><code>$::{&#39;!@#$#@&#39;}
::{&#39;$!@#$#@&#39;}</code></pre>

<p>You can also use the <code>::&#60;&#62;</code> form as long as there are no spaces in the name.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="Symbol_tables"
>Symbol tables</a></h2>

<p>The current lexical symbol table is now accessible through the pseudo-package <code>MY</code>. The current package symbol table is visible as pseudo-package <code>OUR</code>. The <code>OUTER</code> name refers to the <code>MY</code> symbol table immediately surrounding the current <code>MY</code>, and <code>OUTER::OUTER</code> is the one surrounding that one.</p>

<pre><code>our $foo = 41;
say $::foo;         # prints 41, :: is no-op
{
    my $foo = 42;
    say MY::&#60;$foo&#62;;         # prints &#34;42&#34;
    say $MY::foo;           # same thing
    say $::foo;             # same thing, :: is no-op here

    say OUR::&#60;$foo&#62;;        # prints &#34;41&#34;
    say $OUR::foo;          # same thing

    say OUTER::&#60;$foo&#62;;      # prints &#34;41&#34; (our $foo is also lexical)
    say $OUTER::foo;        # same thing
}</code></pre>

<p>You may not use any lexically scoped symbol table, either by name or by reference, to add symbols to a lexical scope that is done compiling. (We reserve the right to relax this if it turns out to be useful though.)</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="Dynamic_lookup"
>Dynamic lookup</a></h2>

<p>The <code>CALLER</code> package refers to the lexical scope of the (dynamically scoped) caller. The caller&#39;s lexical scope is allowed to hide any user-defined variable from you. In fact, that&#39;s the default, and a lexical variable must have the trait &#34;<code>is dynamic</code>&#34; to be visible via <code>CALLER</code>. (<code>$_</code>, <code>$!</code> and <code>$/</code> are always dynamic, as are any variables whose declared names contain a <code>*</code> twigil.) If the variable is not visible in the caller, it returns <code>Failure</code>. Variables whose names are visible at the point of the call but that come from outside that lexical scope are controlled by the scope in which they were originally declared as dynamic. Hence the visibility of <code>CALLER::&#60;$*foo&#62;</code> is determined where <code>$*foo</code> is actually declared, not by the caller&#39;s scope (unless that&#39;s where it happens to be declared). Likewise <code>CALLER::CALLER::&#60;$x&#62;</code> depends only on the declaration of <code>$x</code> visible in your caller&#39;s caller.</p>

<p>User-defined dynamic variables should generally be initialized with <code>::=</code> unless it is necessary for variable to be modified. (Marking dynamic variables as readonly is very helpful in terms of sharing the same value among competing threads, since a readonly variable need not be locked.)</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="DYNAMIC"
><code>DYNAMIC</code></a></h2>

<p>The <code>DYNAMIC</code> pseudo-package is just like <code>CALLER</code> except that it starts in the current dynamic scope and from there scans outward through all dynamic scopes (frames) until it finds a dynamic variable of that name in that dynamic frame&#39;s associated lexical pad. (This search is implied for variables with the <code>*</code> twigil; hence <code>$*FOO</code> is equivalent to <code>DYNAMIC::&#60;$*FOO&#62;</code>.) If, after scanning outward through all those dynamic scopes, there is no variable of that name in any immediately associated lexical pad, it strips the <code>*</code> twigil out of the name and looks in the <code>GLOBAL</code> package followed by the <code>PROCESS</code> package. If the value is not found, it returns failure.</p>

<p>Unlike <code>CALLER</code>, <code>DYNAMIC</code> will see a dynamic variable that is declared in the current scope, since it starts search 0 scopes up the stack rather than 1. You may, however, use <code>CALLER::&#60;$*foo&#62;</code> to bypass a dynamic definition of <code>$*foo</code> in your current scope, such as to initialize it with the outer dynamic value:</p>

<pre><code>my $*foo ::= CALLER::&#60;$*foo&#62;;</code></pre>

<p>The <code>temp</code> declarator may be used (without an initializer) on a dynamic variable to perform a similar operation:</p>

<pre><code>temp $*foo;</code></pre>

<p>The main difference is that by default it initializes the new <code>$*foo</code> with its current value, rather than the caller&#39;s value. Also, it is allowed only on read/write dynamic variables, since the only reason to make a copy of the outer value would be because you&#39;d want to override it later and then forget the changes at the end of the current dynamic scope.</p>

<p>You may also use <code>OUTER::&#60;$*foo&#62;</code> to mean you want to start the search in your outer lexical scope, but this will succeed only if that outer lexical scope also happens to be one of your current <i>dynamic</i> scopes. That is, the same search is done as with the bare <code>$*foo</code>, but any &#34;hits&#34; are ignored until we&#39;ve got to the <code>OUTER</code> scope in our traversal.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="Package_lookup"
>Package lookup</a></h2>

<p>There is no longer any special package hash such as <code>%Foo::</code>. Just subscript the package object itself as a hash object, the key of which is the variable name, including any sigil. The package object can be derived from a type name by use of the <code>::</code> postfix:</p>

<pre><code>MyType::&#60;$foo&#62;</code></pre>

<p>(Directly subscripting the type with either square brackets or curlies is reserved for various generic type-theoretic operations. In most other matters type names and package names are interchangeable.)</p>

<p>Typeglobs are gone. Use binding (<code>:=</code> or <code>::=</code>) to do aliasing. Individual variable objects are still accessible through the hash representing each symbol table, but you have to include the sigil in the variable name now: <code>MyPackage::{&#39;$foo&#39;}</code> or the equivalent <code>MyPackage::&#60;$foo&#62;</code>.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="Globals"
>Globals</a></h2>

<p>Interpreter globals live in the <code>GLOBAL</code> package. The user&#39;s program starts in the <code>GLOBAL</code> package, so &#34;our&#34; declarations in the mainline code go into that package by default. Process-wide variables live in the <code>PROCESS</code> package. Most predefined globals such as <code>$*UID</code> and <code>$*PID</code> are actually process globals.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="The_PROCESS_package"
>The <code>PROCESS</code> package</a></h2>

<p>There is only ever a single <code>PROCESS</code> package. For an ordinary Perl program running by itself, there is only one <code>GLOBAL</code> package as well. However, in certain situations (such as shared hosting under a webserver), the actual process may contain multiple virtual processes or interpreters, each running its own &#34;main&#34; code. In this case, the <code>GLOBAL</code> namespace holds variables that properly belong to the individual virtual process, while the <code>PROCESS</code> namespace holds variables that properly belong to the actual process as a whole. From the viewpoint of the program there is little difference as long as all global variables are accessed as if they were dynamic variables (by using the <code>*</code> twigil). The process as a whole may place restrictions on the mutability of process variables as seen by the individual subprocesses. Also, individual subprocesses may not create new process variables. If the process wishes to grant subprocesses the ability to communicate via the <code>PROCESS</code> namespace, it must supply a writeable dynamic variable to all the subprocesses granted that privilege.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="Dynamic_variable_creation"
>Dynamic variable creation</a></h2>

<p>It is illegal to assign or bind a dynamic variable that does not already exist. It will not be created in <code>GLOBAL</code> (or <code>PROCESS</code>) automatically, nor is it created in any lexical scope. Instead, you must assign directly using the package name to get that to work:</p>

<pre><code>GLOBAL::&#60;$mynewvar&#62; = $val;</code></pre>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="The_magic_input_handle"
>The magic input handle</a></h2>

<p>The magic command-line input handle is <code>$*ARGFILES</code>. The arguments themselves come in <code>@*ARGS</code>. See also &#34;Declaring a MAIN subroutine&#34; in S06.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="Magical_access_to_documentation"
>Magical access to documentation</a></h2>

<p>The Pod documentation in a file is accessible from code in the same file via variables with a <code>=</code> secondary sigil. <code>$=data</code> is the accessor for your <code>=data</code> section(s), for instance. All Pod structures are available as a hierarchical data structure, through <code>$=pod</code>. As with <code>*</code>, the <code>=</code> may also be used as a package name: <code>$=::data</code>.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="Magical_lexically_scoped_values"
>Magical lexically scoped values</a></h2>

<p>Magical lexically scoped values live in variables with a <code>?</code> secondary sigil. These are all values that are known to the compiler, and may in fact be dynamically scoped within the compiler itself, and only appear to be lexically scoped because dynamic scopes of the compiler resolve to lexical scopes of the program. All <code>$?</code> variables are considered constants, and may not be modified after being compiled in. The user is also allowed to define or (redefine) such constants:</p>

<pre><code>constant $?TABSTOP = 4;     # assume heredoc tabs mean 4 spaces</code></pre>

<p>(Note that the constant declarator always evaluates its initialization expression at compile time.)</p>

<p><code>$?FILE</code> and <code>$?LINE</code> are your current file and line number, for instance. Instead of <code>$?OUTER::FOO</code> you probably want to write <code>OUTER::&#60;$?FOO&#62;</code>. Within code that is being run during the compile, such as <code>BEGIN</code> blocks, or macro bodies, or constant initializers, the compiler variables must be referred to as (for instance) <code>COMPILING::&#60;$?LINE&#62;</code> if the bare <code>$?LINE</code> would be taken to be the value during the compilation of the currently running code rather than the eventual code of the user&#39;s compilation unit. For instance, within a macro body <code>$?LINE</code> is the line within the macro body, but <code>COMPILING::&#60;$?LINE&#62;</code> is the line where the macro was invoked. See below for more about the <code>COMPILING</code> pseudo package.</p>

<p>Here are some possibilities:</p>

<pre><code>$?FILE      Which file am I in?
$?LINE      Which line am I at?
&#38;?ROUTINE   Which routine am I in?
&#38;?BLOCK     Which block am I in?
%?LANG      What is the current set of interwoven languages?</code></pre>

<p>The following return objects that contain all pertinent info:</p>

<pre><code>$?KERNEL    Which kernel am I compiled for?
$?DISTRO    Which OS distribution am I compiling under
$?VM        Which virtual machine am I compiling under
$?XVM       Which virtual machine am I cross-compiling for
$?PERL      Which Perl am I compiled for?
$?SCOPE     Which lexical scope am I in?
$?PACKAGE   Which package am I in?
$?MODULE    Which module am I in?
$?CLASS     Which class am I in? (as variable)
$?ROLE      Which role am I in? (as variable)
$?GRAMMAR   Which grammar am I in?
%?META      The META6.json data associated with the module
%?RESOURCE  Associated resource files, shortcut for %?META&#60;resource&#62;</code></pre>

<p>It is relatively easy to smartmatch these constant objects against pairs to check various attributes such as name, version, or authority:</p>

<pre><code>given $?VM {
    when :name&#60;Parrot&#62; :ver(v2) { ... }
    when :name&#60;CLOS&#62;            { ... }
    when :name&#60;SpiderMonkey&#62;    { ... }
    when :name&#60;JVM&#62; :ver(v6.*)  { ... }
}</code></pre>

<p>Matches of constant pairs on constant objects may all be resolved at compile time, so dead code can be eliminated by the optimizer.</p>

<p>Note that some of these things have parallels in the <code>*</code> space at run time:</p>

<pre><code>$*KERNEL    Which kernel I&#39;m running under
$*DISTRO    Which OS distribution I&#39;m running under
$*VM        Which VM I&#39;m running under
$*PERL      Which Perl I&#39;m running under</code></pre>

<p>You should not assume that these will have the same value as their compile-time cousins.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="The_COMPILING_pseudopackage"
>The <code>COMPILING</code> pseudopackage</a></h2>

<p>While <code>$?</code> variables are constant to the run time, the compiler has to have a way of changing these values at compile time without getting confused about its own <code>$?</code> variables (which were frozen in when the compile-time code was itself compiled). The compiler can talk about these compiler-dynamic values using the <code>COMPILING</code> pseudopackage.</p>

<p>References to <code>COMPILING</code> variables are automatically hoisted into the lexical scope currently being compiled. Setting or temporizing a <code>COMPILING</code> variable sets or temporizes the incipient <code>$?</code> variable in the surrounding lexical scope that is being compiled. If nothing in the context is being compiled, an exception is thrown.</p>

<pre><code>BEGIN { COMPILING::&#60;$?FOO&#62; = 42 }
say $?FOO;                  # prints 42
{
    say $?FOO;              # prints 42
}
{
    BEGIN { temp COMPILING::&#60;$?FOO&#62; = 43 } # temporizes to *compiling* block
    say $?FOO;              # prints 43
}
{
    BEGIN {
        COMPILING::&#60;$?FOO&#62; = 44;
        say COMPILING::&#60;$?FOO&#62;; # prints 44, but $?FOO probably undefined
    }
    say $?FOO;              # prints 44
}
say $?FOO;                  # prints 42 (left scope of temp above)
$?FOO = 45;                 # always an error
COMPILING::&#60;$?FOO&#62; = 45;    # an error unless we are compiling something</code></pre>

<p>Note that <code>CALLER::&#60;$?FOO&#62;</code> might discover the same variable as <code>COMPILING::&#60;$?FOO</code>&#62;, but only if the compiling scope is the immediate caller. Likewise <code>OUTER::&#60;$?FOO&#62;</code> might or might not get you to the right place. In the abstract, <code>COMPILING::&#60;$?FOO</code>&#62; goes outwards dynamically until it finds a compiling scope, and so is guaranteed to find the &#34;right&#34; <code>$?FOO</code>. (In practice, the compiler hopefully keeps track of its current compiling scope anyway, so no scan is needed.)</p>

<p>Perceptive readers will note that this subsumes various &#34;compiler hints&#34; proposals. Crazy readers will wonder whether this means you could set an initial value for other lexicals in the compiling scope. The answer is yes. In fact, this mechanism is probably used by the exporter to bind names into the importer&#39;s namespace.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="Switching_parsers"
>Switching parsers</a></h2>

<p>The currently compiling Perl parser is switched by modifying one of the braided languages in <code>COMPILING::&#60;%?LANG&#62;</code>. Lexically scoped parser changes should temporize the modification. Changes from here to end-of-compilation unit can just assign or bind it. In general, most parser changes involve deriving a new grammar and then pointing one of the <code>COMPILING::&#60;%?LANG&#62;</code> entries at that new grammar. Alternately, the tables driving the current parser can be modified without derivation, but at least one level of anonymous derivation must intervene from the preceding Perl grammar, or you might be messing up someone else&#39;s grammar. Basically, the current set of grammars in <code>%?LANG</code> has to belong only to the current compiling scope. It may not be shared, at least not without explicit consent of all parties. No magical syntax at a distance. Consent of the governed, and all that.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="Slangs"
>Slangs</a></h2>

<p>Individual sublanguages (&#34;slangs&#34;) may be referred to using the <code>~</code> twigil. The following are useful:</p>

<pre><code>$~MAIN       the current main language (e.g. Perl statements)
$~Quote      the current root of quoting language
$~Quasi      the current root of quasiquoting language
$~Regex      the current root of regex language
$~Trans      the current root of transliteration language
$~P5Regex    the current root of the Perl 5 regex language</code></pre>

<p>Hence, when you are defining a normal Perl macro, you&#39;re replacing <code>$~MAIN</code> with a derived language, but when you define a new regex backslash sequence, you&#39;re replacing <code>$~Regex</code> with a derived language. (There may or may not be a syntax in the main language to do this.) Note that such changes are automatically scoped to the lexical scope; as with real slang, the definitions are temporary and embedded in a larger language inherited from the surrounding culture.</p>

<p>Instead of defining macros directly you may also mix in one or more grammar rules by lexically scoped declaration of a new sublanguage:</p>

<pre><code>augment slang Regex {  # derive from $~Regex and then modify $~Regex
    token backslash:std&#60;\Y&#62; { YY };
}</code></pre>

<p>This tends to be more efficient since it only has to do one mixin at the end of the block. Note that the slang declaration has nothing to do with package <code>Regex</code>, but only with <code>$~Regex</code>. Sublanguages are in their own namespace (inside the current value of <code>%?LANG</code>, in fact). Hence <code>augment</code> is modifying one of the local strands of a braided language, not a package somewhere else.</p>

<p>You may also supersede a sublang entirely if, for example, you just want to disable that sublanguage in the current lexical scope:</p>

<pre><code>supersede slang P5Regex {}
m:P5/./;             # kaboom</code></pre>

<p>If you supersede <code>MAIN</code> then you&#39;re replacing the Perl parser entirely. This might be done by, say, the &#34;use COBOL&#34; declaration. <code>:-)</code></p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="Extended_identifiers"
>Extended identifiers</a></h2>

<p>It is often convenient to have names that contain arbitrary characters or other data structures. Typically these uses involve situations where a set of entities shares a common &#34;short&#34; name, but still needs for each of its elements to be identifiable individually. For example, you might use a module whose short name is <code>ThatModule</code>, but the complete long name of a module includes its version, naming authority, and perhaps even its source language. Similarly, sets of operators work together in various syntactic categories with names like <code>prefix</code>, <code>infix</code>, <code>postfix</code>, etc. The long names of these operators, however, often contain characters that are excluded from ordinary identifiers.</p>

<p>For all such uses, an identifier followed by a subscript-like adverbial form (see below) is considered an <i>extended identifier</i>:</p>

<pre><code>infix:&#60;+&#62;    # the official name of the operator in $a + $b
infix:&#60;*&#62;    # the official name of the operator in $a * $b
infix:&#171;&#60;=&#187;   # the official name of the operator in $a &#60;= $b
prefix:&#60;+&#62;   # the official name of the operator in +$a
postfix:&#60;--&#62; # the official name of the operator in $a--</code></pre>

<p>This name is to be thought of semantically, not syntactically. That is, the bracketing characters used do not count as part of the name; only the quoted data matters. These are all the same name:</p>

<pre><code>infix:&#60;+&#62;
infix:&#60;&#60;+&#62;&#62;
infix:&#171;+&#187;
infix:[&#39;+&#39;]</code></pre>

<p>Despite the appearance as a subscripting form, these names are resolved not at run time but at compile time. The pseudo-subscripts need not be simple scalars. These are extended with the same two-element list:</p>

<pre><code>circumfix:&#171;&#60;&#60; &#62;&#62;&#187;
circumfix:[&#39;&#60;&#60;&#39;,&#39;&#62;&#62;&#39;]</code></pre>

<p>An identifier may be extended with multiple named identifier extensions, in which case the names matter but their order does not. These name the same module:</p>

<pre><code>use ThatModule:auth&#60;Somebody&#62;:ver&#60;2.7.18.28.18&#62;
use ThatModule:ver&#60;2.7.18.28.18&#62;:auth&#60;Somebody&#62;</code></pre>

<p>Adverbial syntax will be described more fully later.</p>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="Literals"
>Literals</a></h1>

<p>Perl 6 has a rich set of literal forms, many of which can be used for textual input as well. For those forms simple enough to be allowed, the <code>val()</code> function treats such a string value as if it were a literal in the program. In some cases the <code>val()</code> function will be applied on your behalf, and in other cases you must do so explicitly. The rationale for this function is that there are many cases where the programmer or user is forced to use a string type to represent a value that is intended to become a numeric type internally. Committing pre-emptively to either a string type or a numeric type is likely to be wrongish, so Perl 6 instead provides the concept of <i>allomorphic</i> literals. How these work is described below in <a href="#Allomorphic_value_semantics" class="podlinkpod"
>&#34;Allomorphic value semantics&#34;</a>.</p>

<p>When used as literals in a program, most of these forms produce an exact type, and are not subject to <code>val()</code> processing. The exceptions will be noted as we go.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="Underscores"
>Underscores</a></h2>

<p>A single underscore is allowed only between any two digits in a literal number, where the definition of digit depends on the radix. (A single underscore is also allowed between a radix prefix and a following digit, as explained in the next section.) Underscores are not allowed anywhere else in any numeric literal, including next to the radix point or exponentiator, or at the beginning or end.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="Radix_markers"
>Radix markers</a></h2>

<p>Initial <code>0</code> no longer indicates octal numbers by itself. You must use an explicit radix marker for that. Pre-defined radix prefixes include:</p>

<pre><code>0b          base 2, digits 0..1
0o          base 8, digits 0..7
0d          base 10, digits 0..9
0x          base 16, digits 0..9,a..f (case insensitive)</code></pre>

<p>Each of these allows an optional underscore after the radix prefix but before the first digit. These all mean the same thing:</p>

<pre><code>0xbadcafe
0xbad_cafe
0x_bad_cafe</code></pre>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="General_radices"
>General radices</a></h2>

<p>The general radix form of a number involves prefixing with the radix in adverbial form:</p>

<pre><code>:10&#60;42&#62;             same as 0d42 or 42
:16&#60;DEAD_BEEF&#62;      same as 0xDEADBEEF
:8&#60;177777&#62;          same as 0o177777 (65535)
:2&#60;1.1&#62;             same as 0b1.1 (0d1.5)</code></pre>

<p>Extra digits are assumed to be represented by <code>a</code>..<code>z</code> and <code>A</code>..<code>Z</code>, so you can go up to base 36. (Use <code>A</code> and <code>B</code> for base twelve, not <code>T</code> and <code>E</code>.) Alternately you can use a list of digits in decimal:</p>

<pre><code>:60[12,34,56]       # 12 * 3600 + 34 * 60 + 56
:100[3,&#39;.&#39;,14,16]   # pi</code></pre>

<p>All numbers representing digits must be less than the radix, or an error will result (at compile time if constant-folding can catch it, or at run time otherwise).</p>

<p>Any radix may include a fractional part. A dot is never ambiguous because you have to tell it where the number ends:</p>

<pre><code>:16&#60;dead_beef.face&#62; # fraction
:16&#60;dead_beef&#62;.face # method call</code></pre>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="Exponentials"
>Exponentials</a></h2>

<p>Only base 10 (in any form) allows an additional exponentiator starting with &#39;e&#39; or &#39;E&#39;. All other radixes must either rely on the constant folding properties of ordinary multiplication and exponentiation, or supply the equivalent two numbers as part of the string, which will be interpreted as they would outside the string, that is, as decimal numbers by default:</p>

<pre><code>:16&#60;dead_beef&#62; * 16**8
:16&#60;dead_beef*16**8&#62;</code></pre>

<p>It&#39;s true that only radixes that define <code>e</code> as a digit are ambiguous that way, but with any radix it&#39;s not clear whether the exponentiator should be 10 or the radix, and this makes it explicit:</p>

<pre><code>0b1.1e10                    ILLEGAL, could be read as any of:

:2&#60;1.1&#62; * 2 ** 10           1536
:2&#60;1.1&#62; * 10 ** 10          15,000,000,000
:2&#60;1.1&#62; * :2&#60;10&#62; ** :2&#60;10&#62;  6</code></pre>

<p>So we write those as</p>

<pre><code>:2&#60;1.1*2**10&#62;               1536
:2&#60;1.1*10**10&#62;              15,000,000,000
:2&#171;1.1*:2&#60;10&#62;**:2&#60;10&#62;&#187;      6</code></pre>

<p>The generic string-to-number converter will recognize all of these forms (including the * form, since constant folding is not available to the run time). Also allowed in strings are leading plus or minus, and maybe a trailing Units type for an implied scaling. Leading and trailing whitespace is ignored. Note also that leading <code>0</code> by itself <i>never</i> implies octal in Perl 6.</p>

<p>In all these cases, the type produced will be the narrowest of Int, Rat, or Num that can accurately represent the number. If no type can represent it exactly, it should be returned as either a Rat or a Num, whichever is more accurate. (Rat64 will tend to be more accurate for numbers of normal or large magnitude, while Num64 may be more accurate for numbers of very small magnitude, since the Rat&#39;s size mismatch of numerator and denominator will eventually cost more accuracy than the Num&#39;s exponent overhead. As a limiting case, a Rat64 cannot represent any number smaller than :10&#60;1*2**-64&#62;.)</p>

<p>A consequence of the preceding is that you cannot make a FatRat using colon notation. You must rely on constructors and constant folding:</p>

<pre><code>FatRat.new(1,2) ** 128
FatRat.new(1, 2 ** 128)     # same thing</code></pre>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="Conversion_functions"
>Conversion functions</a></h2>

<p>Any of the adverbial forms may be used as a function:</p>

<pre><code>:2($x)      # &#34;bin2num&#34;
:8($x)      # &#34;oct2num&#34;
:10($x)     # &#34;dec2num&#34;
:16($x)     # &#34;hex2num&#34;</code></pre>

<p>Think of these as setting the default radix, not forcing it. Like Perl 5&#39;s old <code>oct()</code> function, any of these will recognize a number starting with a different radix marker and switch to the other radix. However, note that the <code>:16()</code> converter function will interpret leading <code>0b</code> or <code>0d</code> as hex digits, not radix switchers.</p>

<p>Use of the functional form on anything that is not a string will throw an exception explaining that the user has confused a number with the textual representation of a number. This is to catch errors such as a <code>:8(777)</code> that should have been <code>:8&#60;777&#62;</code>, or the attempt to use the function in reverse to produce a textual representation from a number.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="Rational_literals"
>Rational literals</a></h2>

<p>Rational literals are indicated by separating two integer literals (in any radix) with a slash, and enclosing the whole in angles:</p>

<pre><code>&#60;1/2&#62;       # one half literal Rat</code></pre>

<p>Whitespace is not allowed on either side of the slash or it will be split under normal quote-words semantics:</p>

<pre><code>&#60; 1 / 2 &#62;   # (&#39;1&#39;, &#39;/&#39;, &#39;2&#39;)
&#60; 1/2 &#62;     # okay, same as &#60;1/2&#62;</code></pre>

<p>Because of constant folding, you may often get away with leaving out the angles:</p>

<pre><code>1/2         # 1 divided by 2</code></pre>

<p>However, in that case you have to pay attention to precedence and associativity. The following does <i>not</i> cube <code>2/3</code>:</p>

<pre><code>2/3**3      # 2/(3**3), not (2/3)**3</code></pre>

<p>Decimal fractions not using &#34;e&#34; notation are also treated as literal <code>Rat</code> values:</p>

<pre><code>6.02e23.WHAT     # Num
1.23456.WHAT     # Rat
0.11 == 11/100   # True</code></pre>

<p>Literals specified in angle brackets are always subject to <code>val()</code> processing, so <code>&#60;1/2&#62;</code> produces a value that is both a <code>Rat</code> and a <code>Str</code>. See <a href="#Allomorphic_value_semantics" class="podlinkpod"
>&#34;Allomorphic value semantics&#34;</a> below.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="Complex_literals"
>Complex literals</a></h2>

<p>Complex literals are similarly indicated by writing an addition or subtraction of two real numbers (again, without spaces around the operators) inside angles:</p>

<pre><code>&#60;5.2+1e42i&#62;
&#60; -3-1i &#62;</code></pre>

<p>As with rational literals, constant folding would produce the same complex number, but this form parses as a single term, ignoring surrounding precedence.</p>

<p>(Note that these are not actually special syntactic forms: both rational and complex literal forms fall out naturally from the semantic rules of qw quotes described below.)</p>

<p>Literals specified in angle brackets are always subject to <code>val()</code> processing, so <code>&#60;1+2i&#62;</code> produces a value that is both a <code>Complex</code> and a <code>Str</code>. See <a href="#Allomorphic_value_semantics" class="podlinkpod"
>&#34;Allomorphic value semantics&#34;</a> below.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="Blob_literals"
><code>Blob</code> literals</a></h2>

<p><code>Blob</code> literals look similar to integer literals with radix markers, but use curlies instead of angles:</p>

<pre><code>:2{0010_1110_1000_10}   a blob1, base 2, 1 bit per column
:4{}                    a blob2, 2 bits per column
:8{5235 0437 6}         a blob3, 3 bits per column
:16{A705E}              a blob4, 4 bits per column</code></pre>

<p>Whitespace and underscores are allowed but ignored.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="Radix_interpolation"
>Radix interpolation</a></h2>

<p>Characters indexed by hex numbers can be interpolated into strings by introducing with <code>&#34;\x&#34;</code>, followed by either a bare hex number (<code>&#34;\x263a&#34;</code>) or a hex number in square brackets (<code>&#34;\x[263a]&#34;</code>). Similarly, <code>&#34;\o12&#34;</code> and <code>&#34;\o[12]&#34;</code> interpolate octals--but generally you should be using hex in the world of Unicode. Multiple characters may be specified within any of the bracketed forms by separating the numbers with comma: <code>&#34;\x[41,42,43]&#34;</code>. You must use the bracketed form to disambiguate if the unbracketed form would &#34;eat&#34; too many characters, because all of the unbracketed forms eat as many characters as they think look like digits in the radix specified. None of these notations work in normal Perl code. They work only in interpolations and regexes and the like.</p>

<p>Note that the inside of the brackets is not an expression, and you may not interpolate there, since that would be a double interpolation. Use curlies to interpolate the values of expressions.</p>

<p>The old <code>\123</code> form is now illegal, as is the <code>\0123</code> form. Only <code>\0</code> remains, and then only if the next character is not in the range <code>&#39;0&#39;..&#39;7&#39;</code>. Octal characters must use <code>\o</code> notation. Note also that backreferences are no longer represented by <code>\1</code> and the like--see S05.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="Angle_quotes_(quote_words)"
>Angle quotes (quote words)</a></h2>

<p>The <code>qw/foo bar/</code> quote operator now has a bracketed form: <code>&#60;foo bar&#62;</code>. When used as a subscript it performs a slice equivalent to <code>{&#39;foo&#39;,&#39;bar&#39;}</code>. Elsewhere it is equivalent to a parenthesized list of strings: <code>(&#39;foo&#39;,&#39;bar&#39;)</code>. Since parentheses are generally reserved just for precedence grouping, they merely autointerpolate in flat list context. Therefore</p>

<pre><code>@a = 1, &#60; x y &#62;, 2;</code></pre>

<p>is equivalent to:</p>

<pre><code>@a = 1, (&#39;x&#39;, &#39;y&#39;), 2;</code></pre>

<p>which is the same as:</p>

<pre><code>@a = 1, &#39;x&#39;, &#39;y&#39;, 2;</code></pre>

<p>In item context, the implied grouping parentheses are still there, so</p>

<pre><code>$a = &#60; a b &#62;;</code></pre>

<p>is equivalent to:</p>

<pre><code>$a = (&#39;a&#39;, &#39;b&#39;);</code></pre>

<p>which assigns a <code>Parcel</code> to the variable. On the other hand, if you backslash the parcel:</p>

<pre><code>$a = \&#60;a b&#62;;</code></pre>

<p>it is like:</p>

<pre><code>$a = \(&#39;a&#39;, &#39;b&#39;);</code></pre>

<p>and ends up storing a <code>Capture</code> object (which weeds out any named arguments into a separate structure, in contrast to a <code>Parcel</code>, which keeps everything in its original list).</p>

<p>Binding is different from assignment. If bound to a signature, the <code>&#60;a b&#62;</code> parcel will be promoted to a <code>Capture</code> object, but if bound to a parameter, it will make the flattening/slicing decision based on the nature of the individual parameter. That is, if you pass <code>&#60;a b&#62;</code> as an argument, it will bind as a single item to a positional or slice parameter, and as two items to a slurpy parameter.</p>

<p>But note that under the parenthesis-rewrite rule, a single value will still act like a single value. These are all the same:</p>

<pre><code>$a = &#60; a &#62;;
$a = (&#39;a&#39;);
$a = &#39;a&#39;;</code></pre>

<p>Strings within angle brackets are subject to <code>val()</code> processing, and any component that parses successfully as a numeric literal will become both a string and a number. See <a href="#Allomorphic_value_semantics" class="podlinkpod"
>&#34;Allomorphic value semantics&#34;</a> below.</p>

<h3><a class='u' href='#___top' title='click to go to top of document'
name="Explicit_Parcel_construction"
>Explicit Parcel construction</a></h3>

<p>As the previous section shows, a parcel is not automatically constructed by parens; the parcel is actually constructed by the comma, not by the parens. To force a single value to become a composite object in item context, either add a comma inside parens, or use an appropriate constructor or composer for clarity as well as correctness:</p>

<pre><code>$a = (&#60; a &#62;,);
$a = (&#39;a&#39;,);
$a = Parcel.new(&#39;a&#39;);
$a = [&#39;a&#39;];</code></pre>

<h3><a class='u' href='#___top' title='click to go to top of document'
name="Empty_Parcel"
>Empty Parcel</a></h3>

<p>Even though there is no comma in it, the empty parcel is represented by <code>()</code>. Normally, one could itemize this by prefixing a <code>$</code> (as in <code>$()</code>), but that translates to the special syntax form <code>$( $/.made // Str($/) )</code>. Instead, one can <code>().item</code>, or less legibly, introduce a space as in <code>$( )</code>.</p>

<h3><a class='u' href='#___top' title='click to go to top of document'
name="Disallowed_forms"
>Disallowed forms</a></h3>

<p>The degenerate case <code>&#60;&#62;</code> is disallowed as a probable attempt to do IO in the style of Perl 5; that is now written <code>lines()</code>. (<code>&#60;STDIN&#62;</code> is also disallowed.) Empty lists are better written with <code>()</code> in any case because <code>&#60;&#62;</code> will often be misread as meaning <code>(&#39;&#39;)</code>. (Likewise the subscript form <code>%foo&#60;&#62;</code> should be written <code>%foo{}</code> to avoid misreading as <code>@foo{&#39;&#39;}</code>.) If you really want the angle form for stylistic reasons, you can suppress the error by putting a space inside: <code>&#60; &#62;</code>.</p>

<h3><a class='u' href='#___top' title='click to go to top of document'
name="Relationship_between_&#60;&#62;_and_&#171;&#187;"
>Relationship between &#60;&#62; and &#171;&#187;</a></h3>

<p>Much like the relationship between single quotes and double quotes, single angles do not interpolate while double angles do. The double angles may be written either with French quotes, <code>&#171;$foo @bar[]&#187;</code>, or with &#34;Texas&#34; quotes, <code>&#60;&#60;$foo @bar[]&#62;&#62;</code>, as the ASCII workaround. The implicit split is done after interpolation, but respects quotes in a shell-like fashion, so that <code>&#171;&#39;$foo&#39; &#34;@bar[]&#34;&#187;</code> is guaranteed to produce a list of two &#34;words&#34; equivalent to <code>(&#39;$foo&#39;, &#34;@bar[]&#34;)</code>. <code>Pair</code> notation is also recognized inside <code>&#171;...&#187;</code> and such &#34;words&#34; are returned as <code>Pair</code> objects.</p>

<p>Colon pairs (but not arrow pairs) are recognized within double angles. In addition, the double angles allow for comments beginning with <code>#</code>. These comments work exactly like ordinary comments in Perl code. Unlike in the shells, any literal <code>#</code> must be quoted, even ones without whitespace in front of them, but note that this comes more or less for free with a colon pair like <code>:char&#60;#x263a&#62;</code>, since comments only work in double angles, not single.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="Adverbial_Pair_forms"
>Adverbial Pair forms</a></h2>

<p>There is now a generalized adverbial form of Pair notation. The following table shows the correspondence to the &#34;fatarrow&#34; notation:</p>

<pre><code>Fat arrow           Adverbial pair  Paren form
=========           ==============  ==========
a =&#62; True           :a
a =&#62; False          :!a
a =&#62; 0              :a(0)
a =&#62; $x             :a($x)
a =&#62; &#39;foo&#39;          :a&#60;foo&#62;         :a(&#60;foo&#62;)
a =&#62; &#60;foo bar&#62;      :a&#60;foo bar&#62;     :a(&#60;foo bar&#62;)
a =&#62; &#171;$foo @bar&#187;    :a&#171;$foo @bar&#187;   :a(&#171;$foo @bar&#187;)
a =&#62; {...}          :a{...}         :a({...})
a =&#62; [...]          :a[...]         :a([...])
a =&#62; $a             :$a
a =&#62; @a             :@a
a =&#62; %a             :%a
a =&#62; &#38;a             :&#38;a
a =&#62; $$a            :$$a
a =&#62; @$$a           :@$$a (etc.)
a =&#62; %foo&#60;a&#62;        %foo&#60;a&#62;:p</code></pre>

<p>The fatarrow construct may be used only where a term is expected because it&#39;s considered an expression in its own right, since the fatarrow itself is parsed as a normal infix operator (even when autoquoting an identifier on its left). Because the left side is a general expression, the fatarrow form may be used to create a Pair with <i>any</i> value as the key. On the other hand, when used as above to generate <code>Pair</code> objects, the adverbial forms are restricted to the use of identifiers as keys. You must use the fatarrow form to generate a <code>Pair</code> where the key is not an identifier.</p>

<p>Despite that restriction, it&#39;s possible for other things to come between a colon and its brackets; however, all of the possible non-identifier adverbial keys are reserved for special syntactical forms. Perl 6 currently recognizes decimal numbers and the null key. In the following table the first and second columns do <i>not</i> mean the same thing:</p>

<pre><code>Simple pair         DIFFERS from    which means
===========         ============    ===========
2 =&#62; &#60;101010&#62;       :2&#60;101010&#62;      radix literal 0b101010
8 =&#62; &#60;123&#62;          :8&#60;123&#62;         radix literal 0o123
16 =&#62; &#60;deadbeef&#62;    :16&#60;deadbeef&#62;   radix literal 0xdeadbeef
16 =&#62; $somevalue    :16($somevalue) radix conversion function
&#39;&#39; =&#62; $x            :($x)           signature literal
&#39;&#39; =&#62; ($x,$y)       :($x,$y)        signature literal
&#39;&#39; =&#62; &#60;x&#62;           :&#60;x&#62;            name extension
&#39;&#39; =&#62; &#171;x&#187;           :&#171;x&#187;            name extension
&#39;&#39; =&#62; [$x,$y]       :[$x,$y]        name extension
&#39;&#39; =&#62; { .say }      :{ .say }       adverbial block (not allowed on names)</code></pre>

<p>All of the adverbial forms (including the normal ones with identifier keys) are considered special tokens and are recognized in various positions in addition to term position. In particular, when used where an infix would be expected they modify the previous topmost operator that is tighter in precedence than &#34;loose unary&#34; (see S03):</p>

<pre><code>1 == 100 :fuzz(3)     # calls: infix:&#60;==&#62;(1, 100, fuzz =&#62; 3)</code></pre>

<p>Within declarations the adverbial form is used to rename parameter declarations:</p>

<pre><code>sub foo ( :externalname($myname) ) {...}</code></pre>

<p>Adverbs modify the meaning of various quoting forms:</p>

<pre><code>q:x &#39;cat /etc/passwd&#39;</code></pre>

<p>When appended to an identifier (that is, in postfix position), the adverbial syntax is used to generate unique variants of that identifier; this syntax is used for naming operators such as <code>infix:&#60;+&#62;</code> and multiply-dispatched grammatical rules such as <code>statement_control:if</code>. When so used, the adverb is considered an integral part of the name, so <code>infix:&#60;+&#62;</code> and <code>infix:&#60;-&#62;</code> are two different operators. Likewise <code>prefix:&#60;+&#62;</code> is different from <code>infix:&#60;+&#62;</code>. (The notation also has the benefit of grouping distinct identifiers into easily accessible sets; this is how the standard Perl 6 grammar knows the current set of infix operators, for instance.)</p>

<p>Only identifiers that produce a list of one or more values (preferably strings) are allowed as name extensions; in particular, closures do not qualify as values, so the <code>:{...}</code> form is not allowed as a name extender. In particular, this frees up the block form after a method name, so it allows us to parse a block as a method argument:</p>

<pre><code>@stuff.sort:{ +$_ }.map:{ $_ * 2 }</code></pre>

<p>These might look like it is using pairs, but it is really equivalent to</p>

<pre><code>@stuff.sort: { +$_ }.map: { $_ * 2 }</code></pre>

<p>and the colons are not introducing pairs, but rather introducing the argument list of the method. (In any other location, <code>:{...}</code> would be taken as a pair mapping the null key to a closure.)</p>

<p>Either fatarrow or adverbial pair notation may be used to pass named arguments as terms to a function or method. After a call with parenthesized arguments, only the adverbial syntax may be used to pass additional arguments. This is typically used to pass an extra block:</p>

<pre><code>find($directory) :{ when not /^\./ }</code></pre>

<p>This just naturally falls out from the preceding rules because the adverbial block is in operator position, so it modifies the &#34;find operator&#34;. (Parens aren&#39;t considered an operator.)</p>

<p>Note that (as usual) the <code>{...}</code> form (either identifier-based or special) can indicate either a closure or a hash depending on the contents. It does <i>not</i> indicate a subscript, since <code>:key{}</code> is really equivalent to <code>key =&#62; {}</code>, and the braces are not behaving as a postfix at all. (The function to which it is passed can <i>use</i> the value as a subscript if it chooses, however.)</p>

<p>Note also that the <code>&#60;a b&#62;</code> form is not a subscript and is therefore equivalent not to <code>.{&#39;a&#39;,&#39;b&#39;}</code> but rather to <code>(&#39;a&#39;,&#39;b&#39;)</code>. Bare <code>&#60;a&#62;</code> turns into <code>(&#39;a&#39;)</code> rather than <code>(&#39;a&#39;,)</code>. (However, as with the other bracketed forms, the value may end up being used as a subscript depending on context.)</p>

<p>Two or more adverbs can always be strung together without intervening punctuation anywhere a single adverb is acceptable. When used as named arguments in an argument list, you <i>may</i> put comma between, because they&#39;re just ordinary named arguments to the function, and a fatarrow pair would work the same. However, this comma is allowed only when the first pair occurs where a term is expected. Where an infix operator is expected, the adverb is always taken as modifying the nearest preceding operator that is not hidden within parentheses, and if you string together multiple such pairs, you may not put commas between, since that would cause subsequent pairs to look like terms. (The fatarrow form is not allowed at all in operator position.) See S06 for the use of adverbs as named arguments.</p>

<p>The negated form (<code>:!a</code>) and the sigiled forms (<code>:$a</code>, <code>:@a</code>, <code>:%a</code>) never take an argument and don&#39;t care what the next character is. They are considered complete. These forms require an identifier to serve as the key.</p>

<p>For identifiers that take a non-negative integer argument, it is allowed to abbreviate, for example, <code>:sweet(16)</code> to <code>:16sweet</code>. (This is distinguishable from the :16&#60;deadbeef&#62; form, which never has an alphabetic character following the number.) Only literal non-negative integers numbers may be swapped this way. Please note that this abbreviation allows:</p>

<pre><code>  s:2nd/foo/bar/  # or 3rd, 4th, 5th etc.</code></pre>

<p>The other forms of adverb (including the bare <code>:a</code> form) <i>always</i> look for an immediate bracketed argument, and will slurp it up. If that&#39;s not intended, you must use whitespace between the adverb and the opening bracket. The syntax of individual adverbs is the same everywhere in Perl 6. There are no exceptions based on whether an argument is wanted or not. (There is a minor exception for quote and regex adverbs, which accept <i>only</i> parentheses as their bracketing operator, and ignore other brackets, which must be placed in parens if desired. See &#34;Paren form&#34; in the table above.)</p>

<p>Except as noted above, the parser always looks for the brackets. Despite not indicating a true subscript, the brackets are similarly parsed as postfix operators. As postfixes the brackets may be separated from their initial <code>:foo</code> with either unspace or dot (or both), but nothing else.</p>

<p>Regardless of syntax, adverbs used as named arguments (in either term or infix position) generally show up as optional named parameters to the function in question--even if the function is an operator or macro. The function in question neither knows nor cares how weird the original syntax was.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="Q_forms"
><code>Q</code> forms</a></h2>

<p>In addition to <code>q</code> and <code>qq</code>, there is now the base form <code>Q</code> which does <i>no</i> interpolation unless explicitly modified to do so. So <code>q</code> is really short for <code>Q:q</code> and <code>qq</code> is short for <code>Q:qq</code>. In fact, all quote-like forms derive from <code>Q</code> with adverbs:</p>

<pre><code>q//         Q :q //
qq//        Q :qq //
rx//        Q :regex //
s///        Q :subst ///
tr///       Q :trans ///</code></pre>

<p>Adverbs such as <code>:regex</code> change the language to be parsed by switching to a different parser. This can completely change the interpretation of any subsequent adverbs as well as the quoted material itself.</p>

<pre><code>q:s//       Q :q :scalar //
rx:s//      Q :regex :sigspace //</code></pre>

<p>Just as <code>q[...]</code> has the short form <code>&#39;...&#39;</code>, and <code>qq[...]</code> has the short form <code>&#34;...&#34;</code>, the completely quoted <code>Q[...]</code> has a short form that uses halfwidth corner brackets: <code>&#65378;...&#65379;</code>.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="Adverbs_on_quotes"
>Adverbs on quotes</a></h2>

<p>Generalized quotes may now take adverbs:</p>

<pre><code>Short       Long            Meaning
=====       ====            =======
:x          :exec           Execute as command and return results
:w          :words          Split result on words (no quote protection)
:ww         :quotewords     Split result on words (with quote protection)
:v          :val            Evaluate word or words for value literals
:q          :single         Interpolate \\, \q and \&#39; (or whatever)
:qq         :double         Interpolate with :s, :a, :h, :f, :c, :b
:s          :scalar         Interpolate $ vars
:a          :array          Interpolate @ vars
:h          :hash           Interpolate % vars
:f          :function       Interpolate &#38; calls
:c          :closure        Interpolate {...} expressions
:b          :backslash      Interpolate \n, \t, etc. (implies :q at least)
:to         :heredoc        Parse result as heredoc terminator
            :regex          Parse as regex
            :subst          Parse as substitution
            :trans          Parse as transliteration
            :code           Quasiquoting
:p          :path           Return a Path object (see S16 for more options)</code></pre>

<p>You may omit the first colon by joining an initial <code>Q</code>, <code>q</code>, or <code>qq</code> with a single short form adverb, which produces forms like:</p>

<pre><code>qw /a b c/;                         # P5-esque qw// meaning q:w
Qc &#39;...{$x}...&#39;;                    # Q:c//, interpolate only closures
qqx/$cmd @args[]/                   # equivalent to P5&#39;s qx//</code></pre>

<p>(Note that <code>qx//</code> doesn&#39;t interpolate.)</p>

<p>If you want to abbreviate further, just define a macro:</p>

<pre><code>macro qx { &#39;qq:x &#39; }          # equivalent to P5&#39;s qx//
macro qTO { &#39;qq:x:w:to &#39; }    # qq:x:w:to//
macro quote:&#60;&#10096; &#10097;&#62; ($text) { quasi { {{{$text}}}.quoteharder } }</code></pre>

<p>All the uppercase adverbs are reserved for user-defined quotes. All Unicode delimiters above Latin-1 are reserved for user-defined quotes.</p>

<p>A consequence of the above is that we can now say:</p>

<pre><code>%hash = qw:c/a b c d {@array} {%hash}/;</code></pre>

<p>or</p>

<pre><code>%hash = qq:w/a b c d {@array} {%hash}/;</code></pre>

<p>to interpolate items into a <code>qw</code>. Conveniently, arrays and hashes interpolate with only whitespace separators by default, so the subsequent split on whitespace still works out. (But the built-in <code>&#171;...&#187;</code> quoter automatically does interpolation equivalent to <code>qq:ww:v/.../</code>. The built-in <code>&#60;...&#62;</code> is equivalent to <code>q:w:v/.../</code>.)</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="The_:val_modifier"
>The <code>:val</code> modifier</a></h2>

<p>The <code>:v</code>/<code>:val</code> modifier runs each word through the <code>val()</code> function, which will attempt to recognize literals as defined by the current slang. (See <a href="#Allomorphic_value_semantics" class="podlinkpod"
>&#34;Allomorphic value semantics&#34;</a> below.) Only pure literals such as numbers, versions, and enums are so recognized; all other words are left as strings. In any case, use of such an intuited value as a string will reproduce the original string including any leading or trailing whitespace:</p>

<pre><code>say +val(&#39; +2/4 &#39;)   # &#39;0.5&#39;
say ~val(&#39; +2/4 &#39;)   # &#39; +2/4 &#39;</code></pre>

<p>Of course, words derived from <code>:w</code> and <code>:ww</code> will not have any whitespace, since that is what the words are split apart on.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="Whitespace_before_adverbs"
>Whitespace before adverbs</a></h2>

<p>Whitespace is allowed between the &#34;q&#34; and its adverb: <code>q :w /.../</code>.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="Delimiters_of_quoting_forms"
>Delimiters of quoting forms</a></h2>

<p>For these &#34;q&#34; forms the choice of delimiters has no influence on the semantics. That is, <code>&#39;&#39;</code>, <code>&#34;&#34;</code>, <code>&#60;&#62;</code>, <code>&#171;&#187;</code>, <code>``</code>, <code>()</code>, <code>[]</code>, and <code>{}</code> have no special significance when used in place of <code>//</code> as delimiters. There may be whitespace before the opening delimiter. (Which is mandatory for parens because <code>q()</code> is a subroutine call and <code>q:w(0)</code> is an adverb with arguments). A colon may never be used as the delimiter since it will always be taken to mean another adverb regardless of what&#39;s in front of it. Nor may a <code>#</code> character be used as the delimiter since it is always taken as whitespace (specifically, as a comment). You may not use whitespace or alphanumerics for delimiters.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="Quotes_from_Macros"
>Quotes from Macros</a></h2>

<p>New quoting constructs may be declared as macros:</p>

<pre><code>macro quote:&#60;qX&#62; (*%adverbs) {...}</code></pre>

<p>Note: macro adverbs are automatically evaluated at macro call time if the adverbs are included in the parse. If an adverb needs to affect the parsing of the quoted text of the macro, then an explicit named parameter may be passed on as a parameter to the <code>is parsed</code> subrule, or used to select which subrule to invoke.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="Interpolating_into_a_single-quoted_string"
>Interpolating into a single-quoted string</a></h2>

<p>You may interpolate double-quotish text into a single-quoted string using the <code>\qq[...]</code> construct. Other &#34;q&#34; forms also work, including user-defined ones, as long as they start with &#34;q&#34;. Otherwise you&#39;ll just have to embed your construct inside a <code>\qq[...]</code>.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="Interpolation_rules"
>Interpolation rules</a></h2>

<p>Bare scalar variables always interpolate in double-quotish strings. Bare array, hash, and subroutine variables may <i>never</i> be interpolated. However, any scalar, array, hash or subroutine variable may start an interpolation if it is followed by a sequence of one or more bracketed dereferencers: that is, any of:</p>

<dl>
<dt><a name="1._An_array_subscript"
>1. An array subscript</a></dt>

<dd>
<dt><a name="2._A_hash_subscript"
>2. A hash subscript</a></dt>

<dd>
<dt><a name="3._A_set_of_parentheses_indicating_a_function_call"
>3. A set of parentheses indicating a function call</a></dt>

<dd>
<dt><a name="4._Any_of_1_through_3_in_their_dot_form"
>4. Any of 1 through 3 in their <b>dot</b> form</a></dt>

<dd>
<dt><a name="5._A_method_call_that_includes_argument_parentheses"
>5. A method call that includes argument parentheses</a></dt>

<dd>
<dt><a name="6._A_sequence_of_one_or_more_unparenthesized_method_call,_followed_by_any_of_1_through_5"
>6. A sequence of one or more unparenthesized method call, followed by any of 1 through 5</a></dt>
</dl>

<p>In other words, this is legal:</p>

<pre><code>&#34;Val = $a.ord.fmt(&#39;%x&#39;)\n&#34;</code></pre>

<p>and is equivalent to</p>

<pre><code>&#34;Val = { $a.ord.fmt(&#39;%x&#39;) }\n&#34;</code></pre>

<p>However, no interpolated postfix may start with a backslash, so any backslash or unspace is not recognized, but instead will be assumed to be part of the string outside of the interpolation, and subject to the normal backslashing rules of that quote context:</p>

<pre><code>my $a = 42;
&#34;Val = $a\[junk\]&#34;;  # Val = 42[junk]
&#34;Val = $a\[junk]&#34;;   # Val = 42[junk]
&#34;Val = $a\ [junk]&#34;;  # Val = 42 [junk]
&#34;Val = $a\.[junk]&#34;;  # Val = 42.[junk]</code></pre>

<h3><a class='u' href='#___top' title='click to go to top of document'
name="Arrays"
>Arrays</a></h3>

<p>In order to interpolate an entire array, it&#39;s necessary now to subscript with empty brackets:</p>

<pre><code>print &#34;The answers are @foo[]\n&#34;</code></pre>

<p>Note that this fixes the spurious &#34;<code>@</code>&#34; problem in double-quoted email addresses.</p>

<p>As with Perl 5 array interpolation, the elements are separated by a space. (Except that a space is not added if the element already ends in some kind of whitespace. In particular, a list of pairs will interpolate with a tab between the key and value, and a newline after the pair.)</p>

<h3><a class='u' href='#___top' title='click to go to top of document'
name="Hashes"
>Hashes</a></h3>

<p>In order to interpolate an entire hash, it&#39;s necessary to subscript with empty braces or angles:</p>

<pre><code>print &#34;The associations are:\n%bar{}&#34;
print &#34;The associations are:\n%bar&#60;&#62;&#34;</code></pre>

<p>Note that this avoids the spurious &#34;<code>%</code>&#34; problem in double-quoted printf formats.</p>

<p>By default, keys and values are separated by tab characters, and pairs are terminated by newlines. (This is almost never what you want, but if you want something polished, you can be more specific.)</p>

<h3><a class='u' href='#___top' title='click to go to top of document'
name="Sub_calls"
>Sub calls</a></h3>

<p>In order to interpolate the result of a sub call, it&#39;s necessary to include both the sigil and parentheses:</p>

<pre><code>print &#34;The results are &#38;baz().\n&#34;</code></pre>

<h3><a class='u' href='#___top' title='click to go to top of document'
name="Method_calls"
>Method calls</a></h3>

<p>In order to interpolate the result of a method call without arguments, it&#39;s necessary to include parentheses or extend the call with something ending in brackets:</p>

<pre><code>print &#34;The attribute is $obj.attr().\n&#34;
print &#34;The attribute is $obj.attr&#60;Jan&#62;.\n&#34;</code></pre>

<p>The method is called in item context. (If it returns a list, that list is interpolated as if it were an array.)</p>

<p>It is allowed to have a cascade of argumentless methods as long as the last one ends with parens:</p>

<pre><code>print &#34;The attribute is %obj.keys.sort.reverse().\n&#34;</code></pre>

<p>(The cascade is basically counted as a single method call for the end-bracket rule.)</p>

<h3><a class='u' href='#___top' title='click to go to top of document'
name="Multiple_dereferencers"
>Multiple dereferencers</a></h3>

<p>Multiple dereferencers may be stacked as long as each one ends in some kind of bracket or is a bare method:</p>

<pre><code>print &#34;The attribute is @baz[3](1, 2, 3).gethash.{$xyz}&#60;blurfl&#62;.attr().\n&#34;</code></pre>

<p>Note that the final period above is not taken as part of the expression since it doesn&#39;t introduce a bracketed dereferencer. The parens are not required on the <code>.gethash</code>, but they are required on the <code>.attr()</code>, since that terminates the entire interpolation.</p>

<p>In no case may any of the top-level components be separated by whitespace or unspace. (These are allowed, though, inside any bracketing constructs, such as in the <code>(1, 2, 3)</code> above.)</p>

<h3><a class='u' href='#___top' title='click to go to top of document'
name="Closures"
>Closures</a></h3>

<p>A bare closure also interpolates in double-quotish context. It may not be followed by any dereferencers, since you can always put them inside the closure. The expression inside is evaluated in string item context. You can force list context on the expression using the <code>list</code> operator if necessary. A closure in a string establishes its own lexical scope. (Expressions that sneak in without curlies, such as <code>$(...)</code>, do not establish their own lexical scope, but use the outer scope, and may even declare variables in the outer scope, since all the code inside (that isn&#39;t in an <code>EVAL</code>) is seen at compile time.)</p>

<p>The following means the same as the previous example.</p>

<pre><code>print &#34;The attribute is { @baz[3](1,2,3).gethash.{$xyz}&#60;blurfl&#62;.attr }.\n&#34;</code></pre>

<p>The final parens are unnecessary since we&#39;re providing &#34;real&#34; code in the curlies. If you need to have double quotes that don&#39;t interpolate curlies, you can explicitly remove the capability:</p>

<pre><code>qq:c(0) &#34;Here are { $two uninterpolated } curlies&#34;;</code></pre>

<p>or equivalently:</p>

<pre><code>qq:!c &#34;Here are { $two uninterpolated } curlies&#34;;</code></pre>

<p>Alternately, you can build up capabilities from single quote to tell it exactly what you <i>do</i> want to interpolate:</p>

<pre><code>q:s &#39;Here are { $two uninterpolated } curlies&#39;;</code></pre>

<h3><a class='u' href='#___top' title='click to go to top of document'
name="Twigils"
>Twigils</a></h3>

<p>Secondary sigils (twigils) have no influence over whether the primary sigil interpolates. That is, if <code>$a</code> interpolates, so do <code>$^a</code>, <code>$*a</code>, <code>$=a</code>, <code>$?a</code>, <code>$.a</code>, etc. It only depends on the <code>$</code>.</p>

<h3><a class='u' href='#___top' title='click to go to top of document'
name="Other_expressions"
>Other expressions</a></h3>

<p>No other expressions interpolate. Use curlies.</p>

<h3><a class='u' href='#___top' title='click to go to top of document'
name="Class_methods"
>Class methods</a></h3>

<p>A class method may not be directly interpolated. Use curlies:</p>

<pre><code>print &#34;The dog bark is {Dog.bark}.\n&#34;</code></pre>

<h3><a class='u' href='#___top' title='click to go to top of document'
name="Old_disambiguation"
>Old disambiguation</a></h3>

<p>The old disambiguation syntax:</p>

<pre><code>${foo[$bar]}
${foo}[$bar]</code></pre>

<p>is dead. Use closure curlies instead:</p>

<pre><code>{$foo[$bar]}
{$foo}[$bar]</code></pre>

<p>(You may be detecting a trend here...)</p>

<h3><a class='u' href='#___top' title='click to go to top of document'
name="Topical_methods"
>Topical methods</a></h3>

<p>To interpolate a topical method, use curlies: <code>&#34;{.bark}&#34;</code>.</p>

<h3><a class='u' href='#___top' title='click to go to top of document'
name="Function_calls"
>Function calls</a></h3>

<p>To interpolate a function call without a sigil, use curlies: <code>&#34;{abs $var}&#34;</code>.</p>

<h3><a class='u' href='#___top' title='click to go to top of document'
name="Backslash_sequences"
>Backslash sequences</a></h3>

<p>Backslash sequences still interpolate, but there&#39;s no longer any <code>\v</code> to mean <i>vertical tab</i>, whatever that is... (<code>\v</code> now matches vertical whitespace in a regex.) Literal character representations are:</p>

<pre><code>\a          BELL
\b          BACKSPACE
\t          TAB
\n          LINE FEED
\f          FORM FEED
\r          CARRIAGE RETURN
\e          ESCAPE</code></pre>

<h3><a class='u' href='#___top' title='click to go to top of document'
name="Other_functions"
>Other functions</a></h3>

<p>There&#39;s also no longer any <code>\L</code>, <code>\U</code>, <code>\l</code>, <code>\u</code>, or <code>\Q</code>. Use curlies with the appropriate function instead: <code>&#34;{tclc $word}&#34;</code>.</p>

<h3><a class='u' href='#___top' title='click to go to top of document'
name="Unicode_codepoints"
>Unicode codepoints</a></h3>

<p>You may interpolate any Unicode codepoint by name using <code>\c</code> and square brackets:</p>

<pre><code>&#34;\c[NEGATED DOUBLE VERTICAL BAR DOUBLE RIGHT TURNSTILE]&#34;</code></pre>

<p>Multiple codepoints constituting a single character may be interpolated with a single <code>\c</code> by separating the names with comma:</p>

<pre><code>&#34;\c[LATIN CAPITAL LETTER A, COMBINING RING ABOVE]&#34;</code></pre>

<p>Whether that is regarded as one character or two depends on the Unicode support level of the current lexical scope. It is also possible to interpolate multiple codepoints that do not resolve to a single character:</p>

<pre><code>&#34;\c[LATIN CAPITAL LETTER A, LATIN CAPITAL LETTER B]&#34;</code></pre>

<p>[Note: none of the official Unicode character names contains comma.]</p>

<p>You may also put one or more decimal numbers inside the square brackets:</p>

<pre><code>&#34;\c[13,10]&#34; # CRLF</code></pre>

<p>Any single decimal number may omit the brackets:</p>

<pre><code>&#34;\c8&#34; # backspace</code></pre>

<p>(Within a regex you may also use <code>\C</code> to match a character that is not the specified character.)</p>

<p>If the character following <code>\c</code> or <code>\C</code> is neither a left square bracket nor a decimal digit, the single following character is turned into a control character by the usual trick of XORing the 64 bit. This allows <code>\c@</code> for NULL and <code>\c?</code> for DELETE, but note that the ESCAPE character may not be represented that way; it must be represented something like:</p>

<pre><code>\e
\c[ESCAPE]
\c27
\x1B
\o33</code></pre>

<p>Obviously <code>\e</code> is preferred when brevity is needed.</p>

<h3><a class='u' href='#___top' title='click to go to top of document'
name="Backslashing"
>Backslashing</a></h3>

<p>Any character that <i>would</i> start an interpolation in the current quote context may be protected from such interpolation by prefixing with backslash. The backslash is always removed in this case.</p>

<p>The treatment of backslashed characters that would <i>not</i> have introduced an interpolation varies depending on the type of quote:</p>

<ol>
<li>Any quoting form that includes <code>qq</code> or <code>:qq</code> in its semantic derivation (including the normal double quote form) assumes that all backslashes are to be considered meaningful. The meaning depends on whether the following character is alphanumeric; if it is, the non-interpolating sequence produces a compile-time error. If the character is non-alphanumeric, the backslash is silently removed, on the assumption that the string was backslashed using <code>quotemeta()</code> or some such.</li>

<li>All other quoting forms (including standard single quotes) assume that non-interpolating sequences are to be left unaltered because they are probably intended to pass through to the result. Backslashes are removed <i>only</i> for the terminating quote or for characters that would interpolate if unbackslashed. (In either case, a special exception is made for brackets; if the left bracket would interpolate, the right bracket may optionally also be backslashed, and if so, the backslash will be removed. If brackets are used as the delimiters, both left and right <code>must</code> be backslashed the same, since they would otherwise be counted wrong in the bracket count.)</li>
</ol>

<p>As a consequence, these all produce the same literal string:</p>

<pre><code>&#34; \{ this is not a closure } &#34;
&#34; \{ this is not a closure \} &#34;
q:c / \{ this is not a closure } /
q:c / \{ this is not a closure \} /
q:c { \{ this is not a closure \} }
q { { this is not a closure } }
q { \{ this is not a closure \} }</code></pre>

<p>(Of course, matching backslashes is likely to make your syntax highlighter a bit happier, along with any other na&#239;ve bracket counting algorithms...)</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="Bare_identifiers"
>Bare identifiers</a></h2>

<p>There are no barewords in Perl 6. An undeclared bare identifier will always be taken to mean a subroutine name, and be parsed as a list operator. (Class names (and other type names) are predeclared, or prefixed with the <code>::</code> type sigil when you&#39;re declaring a new one.) A consequence of this is that there&#39;s no longer any &#34;<code>use strict &#39;subs&#39;</code>&#34;. Since the syntax for method calls is distinguished from sub calls, it is only unrecognized sub calls that must be treated specially.</p>

<p>You still must declare your subroutines, but a bareword with an unrecognized name is provisionally compiled as a subroutine call, on the assumption that such a declaration will occur by the end of the current compilation unit:</p>

<pre><code>foo;         # provisional call if neither &#38;foo nor ::foo is defined so far
foo();       # provisional call if &#38;foo is not defined so far
foo($x);     # provisional call if &#38;foo is not defined so far
foo($x, $y); # provisional call if &#38;foo is not defined so far

$x.foo;      # not a provisional call; it&#39;s a method call on $x
foo $x:;     # not a provisional call; it&#39;s a method call on $x
foo $x: $y;  # not a provisional call; it&#39;s a method call on $x</code></pre>

<p>If a postdeclaration is not seen, the compile fails at <code>CHECK</code> time, that is, at the end of compilation for this compilation unit. (You are still free to predeclare subroutines explicitly, of course.) The postdeclaration may be in any lexical or package scope that could have made the declaration visible to the provisional call had the declaration occurred before rather than after the provisional call.</p>

<p>This fixup is done only for provisional calls. If there is <i>any</i> real predeclaration visible, it always takes precedence.</p>

<p>If the unrecognized subroutine name is followed by <code>postcircumfix:&#60;( )&#62;</code>, it is compiled as a provisional function call of the parenthesized form. If it is not, it is compiled as a provisional function call of the list operator form, which may or may not have an argument list. When in doubt, the attempt is made to parse an argument list. As with any list operator, an immediate postfix operator is illegal unless it is a form of parentheses, whereas anything following whitespace will be interpreted as an argument list if possible.</p>

<p>Some examples of how listops, methods and labels interact syntactically:</p>

<pre><code>foo.bar             # foo().bar
foo .bar            # foo($_.bar)   -- no postfix starts with whitespace
foo\ .bar           # foo().bar
foo++               # foo()++
foo 1,2,3           # foo(1,2,3)    -- args always expected after listop
foo + 1             # foo(+1)       -- term always expected after listop
foo;                # foo();        -- no postfix, but no args either
foo:                #   label       -- must be label at statement boundary.
                                    -- ILLEGAL otherwise
foo: bar:           #   two labels in a row, okay
.foo: 1             # $_.foo: 1     -- must be &#34;dot&#34; method with : args
.foo(1)             # $_.foo(1)     -- must be &#34;dot&#34; method with () args
.foo                # $_.foo()      -- must be &#34;dot&#34; method with no args
.$foo: 1            # $_.$foo: 1    -- indirect &#34;dot&#34; method with : args
foo bar: 1          # bar.foo(1)    -- bar must be predecl as class
                                    -- sub bar allowed here only if 0-ary
                                    -- otherwise you must say (bar):
foo bar 1           # foo(bar(1))   -- both subject to postdeclaration
                                    -- never taken as indirect object
foo $bar: 1         # $bar.foo(1)   -- indirect object even if declared sub
                                    -- $bar considered one token
foo (bar()): 1      # bar().foo(1)  -- even if foo declared sub
foo bar():          # ILLEGAL       -- bar() is two tokens.
foo .bar:           # foo(.bar:)    -- colon chooses .bar to listopify
foo bar baz: 1      # foo(baz.bar(1)) -- colon controls &#34;bar&#34;, not foo.
foo (bar baz): 1    # bar(baz()).foo(1) -- colon controls &#34;foo&#34;
$foo $bar           # ILLEGAL       -- two terms in a row
$foo $bar:          # ILLEGAL       -- use $bar.&#34;$foo&#34;() for indirection
(foo bar) baz: 1    # ILLEGAL       -- use $baz.$(foo bar) for indirection</code></pre>

<p>The indirect object colon only ever dominates a simple term, where &#34;simple&#34; includes classes and variables and parenthesized expressions, but explicitly not method calls, because the colon will bind to a trailing method call in preference. An indirect object that parses as more than one token must be placed in parentheses, followed by the colon.</p>

<p>In short, only an identifier followed by a simple term followed by a postfix colon is <code>ever</code> parsed as an indirect object, but that form will <code>always</code> be parsed as an indirect object regardless of whether the identifier is otherwise declared.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="Dereferences"
>Dereferences</a></h2>

<p>There&#39;s also no &#34;<code>use strict &#39;refs&#39;</code>&#34; because symbolic dereferences are now syntactically distinguished from hard dereferences. <code>@($array)</code> must now provide an actual array object, while <code>@::($string)</code> is explicitly a symbolic reference. (Yes, this may give fits to the P5-to-P6 translator, but I think it&#39;s worth it to separate the concepts. Perhaps the symbolic ref form will admit real objects in a pinch.)</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="Hash_subscripts_and_bare_keys"
>Hash subscripts and bare keys</a></h2>

<p>There is no hash subscript autoquoting in Perl 6. Use <code>%x&#60;foo&#62;</code> for constant hash subscripts, or the old standby <code>%x{&#39;foo&#39;}</code>. (It also works to say <code>%x&#171;foo&#187;</code> as long as you realized it&#39;s subject to interpolation.)</p>

<p>But <code>=&#62;</code> still autoquotes any bare identifier to its immediate left (horizontal whitespace allowed but not comments). The identifier is not subject to keyword or even macro interpretation. If you say</p>

<pre><code>$x = do {
    call_something();
    if =&#62; 1;
}</code></pre>

<p>then <code>$x</code> ends up containing the pair <code>(&#34;if&#34; =&#62; 1)</code>. Always. (Unlike in Perl 5, where version numbers didn&#39;t autoquote.)</p>

<p>You can also use the :key($value) form to quote the keys of option pairs. To align values of option pairs, you may use the &#34;unspace&#34; postfix forms:</p>

<pre><code>:longkey\  ($value)
:shortkey\ &#60;string&#62;
:fookey\   { $^a &#60;=&#62; $^b }</code></pre>

<p>These will be interpreted as</p>

<pre><code>:longkey($value)
:shortkey&#60;string&#62;
:fookey{ $^a &#60;=&#62; $^b }</code></pre>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="Double-underscore_forms"
>Double-underscore forms</a></h2>

<p>The double-underscore forms are going away:</p>

<pre><code>Old                 New
---                 ---
__LINE__            $?LINE
__FILE__            $?FILE
__PACKAGE__         $?PACKAGE
__SUB__             &#38;?ROUTINE
__END__             =begin finish
__DATA__            =begin data</code></pre>

<p>The <code>=begin finish</code> Pod stream (usually written as just <code>=finish</code>) is special in that it assumes there&#39;s no corresponding <code>=end finish</code> before end of file. Anything in a source file after a <code>=finish</code> is always treated as Pod.</p>

<p>There is no longer any special <code>DATA</code> stream--any Pod block in the current file can be accessed via a Pod object, such as <code>$=data</code> or <code>$=SYNOPSIS</code> or <code>$=UserBlock</code> etc. That is: a variable with the same name of the desired block, and a <code>=</code> twigil.</p>

<p>These Pod objects can be used as Positionals (indexed by their block sequence). They can also be treated as Associatives (indexed by <code>:key</code> options specified with the block). Either way, each Positional or Associative element represents the entire contents of the corresponding Pod block. You have to split those contents into lines yourself. Each chunk has a <code>.range</code> property that indicates its line number range within the source file.</p>

<p>[Speculative] It may also be possible to treat a Pod object as an IO, to read the Pod information line-by-line (like the <code>DATA</code> filehandle in Perl 5, but for <i>any</i> Pod block).</p>

<p>The lexical routine itself is <code>&#38;?ROUTINE</code>; you can get its name with <code>&#38;?ROUTINE.name</code>. The current block is <code>&#38;?BLOCK</code>. If the block has any labels, those shows up in <code>&#38;?BLOCK.labels</code>. Within the lexical scope of a statement with a label, the label is a pseudo-object representing the <i>dynamically</i> visible instance of that statement. (If inside multiple dynamic instances of that statement, the label represents the innermost one.) This is known as <i>lexotic</i> semantics.</p>

<p>When you say:</p>

<pre><code>next LINE;</code></pre>

<p>it is really a method on this pseudo-object, and</p>

<pre><code>LINE.next;</code></pre>

<p>would work just as well. You can exit any labeled block early by saying</p>

<pre><code>MyLabel.leave(@results);</code></pre>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="Heredocs"
>Heredocs</a></h2>

<p>Heredocs are no longer written with <code>&#60;&#60;</code>, but with an adverb on any other quote construct:</p>

<pre><code>print qq:to/END/;
    Give $amount to the man behind curtain number $curtain.
    END</code></pre>

<p>Other adverbs are also allowed, as are multiple heredocs within the same expression:</p>

<pre><code>print q:c:to/END/, q:to/END/;
    Give $100 to the man behind curtain number {$curtain}.
    END
    Here is a $non-interpolated string
    END</code></pre>

<h3><a class='u' href='#___top' title='click to go to top of document'
name="Optional_whitespace"
>Optional whitespace</a></h3>

<p>Heredocs allow optional whitespace both before and after terminating delimiter. Leading whitespace equivalent to the indentation of the delimiter will be removed from all preceding lines. If a line is deemed to have less whitespace than the terminator, only whitespace is removed, and a warning may be issued. (Hard tabs will be assumed to align to the next multiple of <code>($?TABSTOP // 8)</code> spaces, but as long as tabs and spaces are used consistently that doesn&#39;t matter.) A null terminating delimiter terminates on the next line consisting only of whitespace, but such a terminator will be assumed to have no indentation. (That is, it&#39;s assumed to match at the beginning of any whitespace.)</p>

<h3><a class='u' href='#___top' title='click to go to top of document'
name="One-pass_heredoc_parsing"
>One-pass heredoc parsing</a></h3>

<p>There are two possible ways to parse heredocs. One is to look ahead for the newline and grab the lines corresponding to the heredoc, and then parse the rest of the original line. This is how Perl 5 does it. Unfortunately this suffers from the problem pervasive in Perl 5 of multi-pass parsing, which is masked somewhat because there&#39;s no way to hide a newline in Perl 5. In Perl 6, however, we can use &#34;unspace&#34; to hide a newline, which means that an algorithm looking ahead to find the newline must do a full parse (with possible untoward side effects) in order to locate the newline.</p>

<p>Instead, Perl 6 takes the one-pass approach, and just lazily queues up the heredocs it finds in a line, and waits until it sees a &#34;real&#34; newline to look for the text and attach it to the appropriate heredoc. The downside of this approach is a slight restriction--you may not use the actual text of the heredoc in code that must run before the line finishes parsing. Mostly that just means you can&#39;t write:</p>

<pre><code>BEGIN { say q:to/END/ }
    Say me!
    END</code></pre>

<p>You must instead put the entire heredoc into the <code>BEGIN</code>:</p>

<pre><code>BEGIN {
    say q:to/END/;
    Say me!
    END
}</code></pre>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="Version_literals"
>Version literals</a></h2>

<p>A version literal is written with a &#39;v&#39; followed by the version number in dotted form. This always constructs a <code>Version</code> object, not a string. Only integers and certain wildcards are allowed; for anything fancier you must coerce a string to a <code>Version</code>:</p>

<pre><code>v1.2.3                      # okay
v1.2.*                      # okay, wildcard version
v1.2.3+                     # okay, wildcard version
v1.2.3beta                  # illegal
Version(&#39;1.2.3beta&#39;)        # okay</code></pre>

<p>Note though that most places that take a version number in Perl accept it as a named argument, in which case saying <code>:ver&#60;1.2.3beta&#62;</code> is fine. See S11 for more on using versioned modules.</p>

<p>Version objects have a predefined sort order that follows most people&#39;s intuition about versioning: each sorting position sorts numerically between numbers, alphabetically between alphas, and alphabetics in a position before numerics. Missing final positions are assumed to be &#39;.0&#39;. Except for &#39;0&#39; itself, numbers ignore leading zeros. For splitting into sort positions, if any alphabetics (including underscore) are immediately adjacent to a number, a dot is assumed between them. Likewise any non-alphanumeric character is assumed to be equivalent to a dot. So these are all equivalent:</p>

<pre><code>1.2.1alpha1.0
1.2.1alpha1
1.2.1.alpha1
1.2.1alpha.1
1.2.1.alpha.1
1.2-1+alpha/1</code></pre>

<p>And these are also equivalent:</p>

<pre><code>1.2.1_01
1.2.1_1
1.2.1._1
1.2.1_1
1.2.1._.1
001.0002.0000000001._.00000000001
1.2.1._.1.0.0.0.0.0</code></pre>

<p>So these are in sorted version order:</p>

<pre><code>1.2.0.999
1.2.1_01
1.2.1_2
1.2.1_003
1.2.1a1
1.2.1.alpha1
1.2.1b1
1.2.1.beta1
1.2.1.gamma
1.2.1&#945;1
1.2.1&#946;1
1.2.1&#947;
1.2.1</code></pre>

<p>Note how the last pair assume that an implicit .0 sorts after anything alphabetic, and that alphabetic is defined according to Unicode, not just according to ASCII. The intent of all this is to make sure that prereleases sort before releases. Note also that this is still a subset of the versioning schemes seen in the real world. Modules with such strange versions can still be used by Perl since by default Perl imports external modules by exact version number. (See S11.) Only range operations will be compromised by an unknown foreign collation order, such as a system that sorts &#34;delta&#34; before &#34;gamma&#34;.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="Allomorphic_value_semantics"
>Allomorphic value semantics</a></h2>

<p>When <code>val()</code> processing is attempted on any list of strings (typically on the individual words within angle brackets), the function attempts to determine if the intent of the programmer or user might have been to provide a numeric value.</p>

<p>For any item in the list that appears to be numeric, the literal is stored as an object with both a string and a numeric nature, where the string nature always returns the original string. This is implemented via multiple inheritance, to truly represent the allomorphic nature of a literal value that has not committed to which type the user intends. The numeric type chosen depends on the appearance of the literal. Hence:</p>

<pre><code>&#60; 1 1/2 6.02e23 1+2i &#62;</code></pre>

<p>produces objects of classes defined as:</p>

<pre><code>class IntStr is Int is Str {...}; IntStr(&#39;1&#39;)
class RatStr is Rat is Str {...}; RatStr(&#39;1/2&#39;)
class NumStr is Num is Str {...}; NumStr(&#39;6.02e23&#39;)
class ComplexStr is Complex is Str {...}; ComplexStr(&#39;1+2i&#39;)</code></pre>

<p>One purpose of this is to facilitate compile-time analysis of multi-method dispatch, when the user prefers angle notation as the most readable way to represent a list of numbers, which it often is. Due to the MI semantics, the new object is equally a string and a number, and can be bound as-is to either a string or a numeric parameter.</p>

<p>In case multiple dispatch determines that it could dispatch as either string or number, a tie results, which may result in an ambiguous dispatch error. You&#39;ll need to use prefix <code>+</code> or <code>~</code> on the argument to resolve the ambiguity in that case.</p>

<p>[Conjecture: we may someday find a way to make strings bind a little looser than the numeric types, but for now we conservatively outlaw the dispatch as ambiguous, and watch how this plays out in use.]</p>

<p>The allomorphic behavior of angle brackets is not a special case; it&#39;s actually an example of a more general process of figuring out type information by parsing text that comes from any situation where the user is forced to enter text when they really mean other kinds of values. A function prompting the user for a single value might usefully pass the result through <code>val()</code> to intuit the proper type.</p>

<p>The angle form with a single value serves as the literal form of numbers such as <code>Rat</code> and <code>Complex</code> that would otherwise have to be constructed via constant folding. It also gives us a reasonable way of visually isolating any known literal format as a single syntactic unit:</p>

<pre><code>&#60;-1+2i&#62;.polar
(-1+2i).polar       # same, but only by constant folding</code></pre>

<p>Any such literal, when written without spaces, produces a pure numeric value without a stringy allomorphism. Put spaces to override that:</p>

<pre><code>&#60;1/2&#62;       # a Rat
&#60; 1/2 &#62;     # a RatStr</code></pre>

<p>Or use the <code>&#171;&#187;</code> form of quotewords, which is always allomorphic:</p>

<pre><code>&#171;1/2&#187;       # a RatStr
&#171; 1/2 &#187;     # a RatStr</code></pre>

<h3><a class='u' href='#___top' title='click to go to top of document'
name="Allomorphic_Rats"
>Allomorphic Rats</a></h3>

<p>Any rational literal that would overflow a <code>Rat64</code> in the denominator is also stored as a string. (That is, angle brackets will be assumed in this case, producing a <code>RatStr</code>.) If a coercion to a wider type, such as <code>FatRat</code>, is requested, the literal reconverts from the entire original string, rather than just the value that would fit into a <code>Rat64</code>. (It may then cache that converted value for next time, of course.) So if you declare a constant with excess precision, it does not automatically become a <code>FatRat</code>, which would force all calculations into the pessimal <code>FatRat</code> type.</p>

<pre><code>constant pi is export = 3.14159_26535_89793_23846_26433_83279_50288;
say pi.norm.nude # 1570796326794896619 500000000000000000 (as Rat, reduced)
say pi.perl;     # 3.14159_26535_89793_23846_26433_83279_50288
say pi.Num       # 3.14159265358979 (approximately)
say pi.Str;      # 3.14159_26535_89793_23846_26433_83279_50288
say pi.FatRat;   # 3.14159265358979323846264338327950288</code></pre>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="Context"
>Context</a></h1>

<ul>
<li>Perl still has the three main contexts: sink (aka void), item (aka scalar), and list.</li>

<li>In addition to undifferentiated items, we also have these item contexts:
<pre><code>Context     Type    OOtype   Operator
-------     ----    ------   --------
boolean     bit     Bit      ?
integer     int     Integral int
numeric     num     Num      +
string      buf     Str      ~</code></pre>

<p>There are also various container contexts that require particular kinds of containers (such as slice and hash context; see S03 for details).</p>
</li>

<li>Unlike in Perl 5, objects are no longer always considered true. It depends on the state of their <code>.Bool</code> method, which may either be a synthetic attribute or an explicitly represented bit in the object. Classes get to decide which of their values are true and which are false. Individual objects can override the class definition:
<pre><code>return 0 but True;</code></pre>

<p>This overrides the <code>.Bool</code> method of the <code>0</code> without changing its official type (by mixing the method into an anonymous derived type).</p>
</li>

<li>The definition of <code>.Bool</code> for the most ancestral type (that is, the <code>Mu</code> type) is equivalent to <code>.defined</code>. Since type objects are considered undefined, all type objects (including <code>Mu</code> itself) are false unless the type overrides the definition of <code>.Bool</code> to include undefined values. Instantiated objects default to true unless the class overrides the definition. Note that if you could instantiate a <code>Mu</code> it would be considered defined, and thus true. (It is not clear that this is allowed, however.)</li>

<li>In general any container types should return false if they are empty, and true otherwise. This is true of all the standard container types except Scalar, which always defers the definition of truth to its contents. Non-container types define truthiness much as Perl 5 does.
<p>Just as with the standard types, user-defined types should feel free to partition their defined values into true and false values if such a partition makes sense in control flow using boolean contexts, since the separate <code>.defined</code> method is always there if you need it.</p>
</li>
</ul>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="Lists"
>Lists</a></h1>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="Lazy_flattening"
>Lazy flattening</a></h2>

<p>List context in Perl 6 is by default lazy. This means a list can contain infinite generators without blowing up. No flattening happens to a lazy list until it is bound to the signature of a function or method at call time (and maybe not even then). We say that such an argument list is &#34;lazily flattened&#34;, meaning that we promise to flatten the list on demand, but not before.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="list,_flat,_item,_and_.tree"
><code>list</code>, <code>flat</code>, <code>item</code>, and <code>.tree</code></a></h2>

<p>There is a &#34;<code>list</code>&#34; operator which imposes a list context on its arguments even if <code>list</code> itself occurs in a item context.</p>

<p>To force explicit flattening, use the <code>flat</code> contextualizer. This recursively flattens all parcels into a 1-dimensional list. When bound to a slurpy parameter, a capture flattens the rest of its positional arguments.</p>

<p>To reform a list so that sub-parcels turn into tree nodes, use the <code>.tree</code> method, which is essentially a level-sensitive <code>map</code>, with one closure provided for remapping the parcels at each level:</p>

<pre><code>$p.tree                # recursively set all levels to item
$p.tree(*)             # same thing
$p.tree(*.item)        # force level 1 parcels to item
$p.tree(1)             # same thing
$p.tree(*.item,*.list) # force level 1 parcels to item, level 2 to list
$p.tree(*.Array,*)     # Turn all subparcels into item recursively</code></pre>

<p>When bound to a slice parameter (indicated with <code>**</code>), a capture reforms the rest of its positional arguments with one level of &#34;treeness&#34;, equivalent to <code>@args.tree(1)</code>, that is, a list of lists, or <code>LoL</code>. The sublists are not automatically flattened; that is, if a sublist is a <code>Parcel</code>, it remains a list until subsequent processing decides how flat or treelike the sublist should be.</p>

<p>To force a non-flattening item context, use the &#34;<code>item</code>&#34; operator.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="Forcing_capture_context"
>Forcing capture context</a></h2>

<p>The <code>|</code> prefix operator may be used to force &#34;capture&#34; context on its argument and <i>also</i> defeat any scalar argument checking imposed by subroutine signature declarations. Any resulting list arguments are then evaluated lazily.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="The_eager_operator"
>The <code>eager</code> operator</a></h2>

<p>To force non-lazy list processing, use the <code>eager</code> list operator. List assignment is also implicitly eager. (Actually, when we say &#34;eager&#34; we usually mean &#34;mostly eager&#34; as defined in <a href="http://search.cpan.org/perldoc?S07" class="podlinkpod"
>S07</a>).</p>

<pre><code>eager $filehandle.lines;    # read all remaining lines</code></pre>

<p>By contrast,</p>

<pre><code>$filehandle.lines;</code></pre>

<p>makes no guarantee about how many lines ahead the iterator has read. Iterators feeding a list are allowed to process in batches, even when stored within an array. The array knows that it is extensible, and calls the iterator as it needs more elements. (Counting the elements in the array will also force eager completion.)</p>

<p>This operator is agnostic towards flattening or slicing. It merely changes the work-ahead policy for the value generator.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="The_hyper_operator"
>The <code>hyper</code> operator</a></h2>

<p>A variant of <code>eager</code> is the <code>hyper</code> list operator, which declares not only that you want all the values generated now, but that you want them badly enough that you don&#39;t care what order they&#39;re generated in, as long as the results come back in the right order. That is, <code>eager</code> requires sequential evaluation of the list, while <code>hyper</code> requests (but does not require) parallel evaluation. In any case, it declares that you don&#39;t care about the evaluation order, only the result order.</p>

<p>This operator is agnostic towards flattening or slicing. It merely changes the work-ahead policy for the value generator.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="The_race_operator"
>The <code>race</code> operator</a></h2>

<p>A further variant of <code>hyper</code> is the <code>race</code> list operator, which declares that you want the results so badly that you don&#39;t even care what order they come back in. Within its arguments, the <code>race</code> operator forces parallel evaluation of any iterator, hyper, or junction, such that if any single thread dies or hangs its computation, it does not block any other thread from returning its results to the race list. When the demand for the race list drops, hung threads may be killed. You can think of it as a <code>gather</code> with a &#39;<code>try take start {...}</code>&#39; on parallel computation. Note that exceptions are trapped by default; if your car crashes, you simply do not finish the race. If you want notifications of some sort back to the pit crew, you&#39;ll have to arrange them yourself.</p>

<p>This operator is agnostic towards flattening or slicing. It merely changes the work-ahead policy for the value generator. It is a transitive contextualizer insofar as iterators will have to pass on the policy to subiterators.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="The_=&#62;_operator"
>The <code>=&#62;</code> operator</a></h2>

<p>The <code>=&#62;</code> operator now constructs <code>Pair</code> objects rather than merely functioning as a comma. Both sides are in item context.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="The_.._operator"
>The <code>..</code> operator <!--
	INDEX: ..
--></a></h2>

<p>The <code>..</code> operator now constructs a <code>Range</code> object rather than merely functioning as an operator. Both sides are in item context. Semantically, the <code>Range</code> acts like a list of its values to the extent possible, but does so lazily, unlike Perl 5&#39;s eager range operator.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="Hash_assignment"
>Hash assignment</a></h2>

<p>There is no such thing as a hash list context. Assignment to a hash produces an ordinary list context. You may assign alternating keys and values just as in Perl 5. You may also assign lists of <code>Pair</code> objects, in which case each pair provides a key and a value. You may, in fact, mix the two forms, as long as the pairs come when a key is expected. If you wish to supply a <code>Pair</code> as a key, you must compose an outer <code>Pair</code> in which the key is the inner <code>Pair</code>:</p>

<pre><code>%hash = (($keykey =&#62; $keyval) =&#62; $value);</code></pre>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="The_anonymous_enum_function"
>The anonymous <code>enum</code> function</a></h2>

<p>The anonymous <code>enum</code> function takes a list of keys or pairs, and adds values to any keys that are not already part of a pair. The value added is one more than the previous key or pair&#39;s value. This works nicely with the new <code>qq:ww</code> form:</p>

<pre><code>%hash = enum &#60;&#60;:Mon(1) Tue Wed Thu Fri Sat Sun&#62;&#62;;
%hash = enum &#171; :Mon(1) Tue Wed Thu Fri Sat Sun &#187;;</code></pre>

<p>are the same as:</p>

<pre><code>%hash = ();
%hash&#60;Mon Tue Wed Thu Fri Sat Sun&#62; = 1..7;</code></pre>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="Hash_binding"
>Hash binding</a></h2>

<p>In contrast to assignment, binding to a hash requires a <code>Hash</code> (or <code>Pair</code>) object, or anything that does the <code>Associative</code> role.</p>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="Files"
>Files</a></h1>

<ul>
<li>Filename globs are no longer done with angle brackets. Use the <code>glob</code> function.</li>

<li>Input from a filehandle is no longer done with angle brackets. Instead of
<pre><code>while (&#60;HANDLE&#62;) {...}</code></pre>

<p>you now write</p>

<pre><code>for $handle.lines {...}</code></pre>
</li>
</ul>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="Grammatical_Categories"
>Grammatical Categories</a></h1>

<p>Lexing in Perl 6 is controlled by a system of grammatical categories. At each point in the parse, the lexer knows which subset of the grammatical categories are possible at that point, and follows the longest-token rule across all the active alternatives, including those representing any grammatical categories that are ready to match. See <a href="http://search.cpan.org/perldoc?S05" class="podlinkpod"
>S05</a> for a detailed description of this process.</p>

<p>To get a list of the current categories, grep &#39;token category:&#39; from STD.pm6.</p>

<p>Category names are used as the short name of both various operators and the rules that parse them, though the latter include an extra &#34;sym&#34;:</p>

<pre><code>infix:&#60;cmp&#62;           # the infix cmp operator
infix:sym&#60;cmp&#62;        # the rule that parses cmp</code></pre>

<p>As you can see, the extension of the name uses colon pair notation. The <code>:sym</code> typically takes an argument giving the string name of the operator; some of the &#34;circumfix&#34; categories require two arguments for the opening and closing strings. Since there are so many match rules whose symbol is an identifier, we allow a shorthand:</p>

<pre><code>infix:cmp             # same as infix:sym&#60;cmp&#62; (not infix:&#60;cmp&#62;)</code></pre>

<p>Conjecturally, we might also have other kinds of rules, such as tree rewrite rules:</p>

<pre><code>infix:match&#60;cmp&#62;      # rewrite a match node after reducing its arguments
infix:ast&#60;cmp&#62;        # rewrite an ast node after reducing its arguments</code></pre>

<p>Within a grammar, matching the proto subrule &#60;infix&#62; will match all visible rules in the infix category as parallel alternatives, as if they were separated by &#39;<code>|</code>&#39;.</p>

<p>Here are some of the names of parse rules in STD:</p>

<pre><code>category:sym&#60;prefix&#62;                           prefix:&#60;+&#62;
circumfix:sym&#60;[ ]&#62;                             [ @x ]
dotty:sym&#60;.=&#62;                                  $obj.=method
infix_circumfix_meta_operator:sym[&#39;&#187;&#39;,&#39;&#171;&#39;]     @a &#187;+&#171; @b
infix_postfix_meta_operator:sym&#60;=&#62;             $x += 2;
infix_prefix_meta_operator:sym&#60;!&#62;              $x !~~ 2;
infix:sym&#60;+&#62;                                   $x + $y
package_declarator:sym&#60;role&#62;                   role Foo;
postcircumfix:sym&#60;[ ]&#62;                         $x[$y] or $x.[$y]
postfix_prefix_meta_operator:sym(&#39;&#187;&#39;)          @array &#187;++
postfix:sym&#60;++&#62;                                $x++
prefix_circumfix_meta_operator:sym&#60;[ ]&#62;       [*]
prefix_postfix_meta_operator:sym(&#39;&#171;&#39;)          -&#171; @magnitudes
prefix:sym&#60;!&#62;                                  !$x (and $x.&#39;!&#39;)
quote:sym&#60;qq&#62;                                  qq/foo/
routine_declarator:sym&#60;sub&#62;                    sub foo {...}
scope_declarator:sym&#60;has&#62;                      has $.x;
sigil:sym&#60;%&#62;                                   %hash
special_variable:sym&#60;$!&#62;                       $!
statement_control:sym&#60;if&#62;                      if $condition { 1 } else { 2 }
statement_mod_cond:sym&#60;if&#62;                     .say if $condition
statement_mod_loop:sym&#60;for&#62;                    .say for 1..10
statement_prefix:sym&#60;gather&#62;                   gather for @foo { .take }
term:sym&#60;!!!&#62;                                  $x = { !!! }
trait_mod:sym&#60;does&#62;                            my $x does Freezable
twigil:sym&#60;?&#62;                                  $?LINE
type_declarator:sym&#60;subset&#62;                    subset Nybble of Int where ^16</code></pre>

<p>Note that some of these produce correspondingly named operators, but not all of them. When they do correspond (such as in the <code>cmp</code> example above), this is by convention, not by enforcement. (However, matching <code>&#60;sym&#62;</code> within one of these rules instead of the literal operator makes it easier to set up this correspondence in subsequent processing.)</p>

<p>The STD::Regex grammar also adds these:</p>

<pre><code>assertion:sym&#60;!&#62;                         /&#60;!before \h&#62;/
backslash:sym&#60;w&#62;                         /\w/ and /\W/
metachar:sym&#60;.&#62;                          /.*/
mod_internal:sym&#60;P5&#62;                     m:/ ... :P5 ... /
quantifier:sym&#60;*&#62;                        /.*/</code></pre>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="Deprecations"
>Deprecations</a></h1>

<p>A language that doesn&#39;t evolve, is a dead language. Constructs that seem like a good idea now, may turn out not to be such a good idea in the future. Such constructs will thus need to be deprecated. To mark a construct as being deprecated, one can add the &#34;is DEPRECATED($alternative)&#34; trait to a class, an attribute, or a sub / method. During execution, this will cause the caller sites to be recorded without any warnings. When execution finishes, a report should be printed to STDERR stating which deprecated features where called where.</p>

<!-- end doc -->

</body></html>
