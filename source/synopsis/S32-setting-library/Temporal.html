<!DOCTYPE html>
<html lang="ja">
<head>
<title>Temporal</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" >
<link rel="stylesheet" href="http://yandex.st/highlightjs/8.0/styles/github.min.css">
<link rel="stylesheet" href="../../default.css">
<script src="http://yandex.st/highlightjs/8.0/highlight.min.js"></script>
<script>hljs.configure( { languages: ['perl'] } ); hljs.initHighlightingOnLoad();</script>
</head>
<body class='pod'>
<!--
  generated by My::Pod v,
  using Pod::Simple::PullParser v3.28,
  under Perl v5.018002 at Sat Sep 27 10:05:35 2014 GMT.

 If you want to change this HTML document, you probably shouldn't do that
   by changing it directly.  Instead, see about changing the calling options
   to My::Pod, and/or subclassing My::Pod,
   then reconverting this document from the Pod source.
   When in doubt, email the author of My::Pod for advice.
   See 'perldoc My::Pod' for more info.

-->

<!-- start doc -->
<a name='___top' class='dummyTopAnchor' ></a>

<div class='indexgroup'>
<ul   class='indexList indexList1'>
  <li class='indexItem indexItem1'><a href='#TITLE'>TITLE</a>
  <li class='indexItem indexItem1'><a href='#AUTHORS'>AUTHORS</a>
  <li class='indexItem indexItem1'><a href='#VERSION'>VERSION</a>
  <li class='indexItem indexItem1'><a href='#Time_and_time_again'>Time and time again</a>
  <li class='indexItem indexItem1'><a href='#time'>time</a>
  <li class='indexItem indexItem1'><a href='#DateTime'>DateTime</a>
  <ul   class='indexList indexList2'>
    <li class='indexItem indexItem2'><a href='#Accessors'>Accessors</a>
  </ul>
  <li class='indexItem indexItem1'><a href='#Date'>Date</a>
  <ul   class='indexList indexList2'>
    <li class='indexItem indexItem2'><a href='#Constructors'>Constructors</a>
    <li class='indexItem indexItem2'><a href='#Instance_methods'>Instance methods</a>
    <li class='indexItem indexItem2'><a href='#Arithmetics'>Arithmetics</a>
  </ul>
  <li class='indexItem indexItem1'><a href='#FOOTNOTE'>FOOTNOTE</a>
</ul>
</div>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="TITLE"
>TITLE</a></h1>

<p>Synopsis 32: Setting Library - Temporal</p>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="AUTHORS"
>AUTHORS</a></h1>

<pre><code>Carl M&#228;sak &#60;cmasak@gmail.com&#62;
Martin Berends &#60;mberends@autoexec.demon.nl&#62;
Moritz Lenz &#60;moritz@faui2k3.org&#62;
Olivier Mengu&#233; &#60;dolmen@cpan.org&#62;
Kodi Arfer
(and others named in FOOTNOTE at bottom)</code></pre>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="VERSION"
>VERSION</a></h1>

<pre><code>Created: 19 Mar 2009

Last Modified: 10 May 2014
Version: 23</code></pre>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="Time_and_time_again"
>Time and time again</a></h1>

<p>Two chief aspects of a Perl 6 synopsis seem to contribute to it having some extra volatility: how far it sits from the rest of the data model of the language, and how everyday the topic in question is. <code>S32</code> has always been volatile for these reasons; <code>S32::Temporal</code> doubly so.</p>

<p>The truth is that while there are many interests to satisfy in the case of a <code>Temporal</code> module, and many details to take into account, there&#39;s also the danger of putting too much in. Therefore, Perl 6&#39;s <code>Temporal</code> module takes the <code>DateTime</code> module on CPAN as a starting point, adapts it to the Perl 6 OO system, and boils it down to bare essentials.</p>

<p>One of the unfortunate traditions that Perl 6 aims to break is that of having a set of &#34;core&#34; modules which could better serve the community on CPAN than in the Perl core. For this reason, this module doesn&#39;t handle all the world&#39;s time zones, locales, date formatters or calendars. Instead, it handles a number of &#34;natural&#34; operations well enough for most people to be happy, and shows how those who want more than that can load a module, or roll their own variants. Put differently, the below are the aspects of time that are felt to be stable enough to belong in the core.</p>

<p>Note that in this document, the term &#34;POSIX time&#34; means the number of seconds since midnight UTC of 1 January 1970, not counting leap seconds. This is the same as the output of the ISO C <code>time</code> function. Unlike in Perl 5, <code>time</code> does not return fractional seconds, since <code>POSIX</code> does not define the concept during leap seconds. You want to use <code>now</code> for that instead.</p>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="time"
><code>time</code></a></h1>

<p>Returns the current POSIX time as an <code>Int</code>. Use <code>now</code> for an epoch-agnostic measure of atomic seconds (i.e., an <code>Instant</code>). Note that both <code>time</code> and <code>now</code> are not functions, but terms of the pseudo-constant variety; as such they never take an argument. Saying <code>time()</code> doesn&#39;t work unless you happen to have a function of that name defined.</p>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="DateTime"
><code>DateTime</code></a></h1>

<p>A <code>DateTime</code> object, which is immutable, describes a moment in time as it would appear on someone&#39;s calendar and someone&#39;s clock. You can create a <code>DateTime</code> object from an <code>Instant</code> or from an <code>Int</code>; in the latter case, the argument is interpreted as POSIX time.</p>

<pre><code>my $now = DateTime.new(now);
my $now = DateTime.new(time);</code></pre>

<p>These two statements are equivalent except that <code>time</code> doesn&#39;t know about leap seconds or fractions of seconds. Ambiguous POSIX times (such as 915148800, which could refer to 1998-12-31T23:59:60Z or 1999-01-01T00:00:00Z) are interpreted as non-leap seconds (so in this case, the result would be 1999-01-01T00:00:00Z).</p>

<p>Or you can use named arguments:</p>

<pre><code>my $moonlanding = DateTime.new( :year(1969), :month(7), :day(16),
                                :hour(20), :minute(17) ); # UTC time</code></pre>

<p>This form allows the following arguments:</p>

<pre><code>:year       required
:month      defaults to 1   range 1..12
:day        defaults to 1   range 1..31
:hour       defaults to 0   range 0..23
:minute     defaults to 0   range 0..59
:second     defaults to 0   range 0.0..^62.0</code></pre>

<p>Another multi exists with <code>Date :date</code> instead of <code>:year</code>, <code>:month</code> and <code>:day</code> (and the same defaults as listed above).</p>

<p>All of the aforementioned forms of <code>new</code> accept two additional named arguments. <code>:formatter</code> is a callable object that takes a <code>DateTime</code> and returns a string. The default formatter creates an ISO 8601 timestamp (see below). <code>:timezone</code> must be an Int or an object that supports an .Int method. The Int value of <code>:timezone</code> must reflect the timezone offset, in seconds from UTC. The default time zone is <code>0</code> (i.e., UTC). The system&#39;s local time zone is available as <code>$*TZ</code>.</p>

<p>A shorter way to send in date and time information is to provide a single string with a full ISO 8601 date and time. The example from above would then be</p>

<pre><code>my $moonlanding = DateTime.new( &#39;1969-07-16T20:17:00Z&#39; ); # UTC time</code></pre>

<p>The general form is <code>[date]T[time][offset]</code>, with <code>[date]</code> given as <code>YYYY-MM-DD</code> and <code>[time]</code> given as <code>hh:mm:ss</code>. The final <code>Z</code> is a short form for <code>+0000</code>, meaning UTC. (Note that while this form of <code>new</code> accepts all of <code>+0000</code>, <code>-0000</code>, and <code>Z</code>, the default formatter for <code>DateTime</code> always expresses UTC as <code>Z</code>.) The general notation for the <code>[offset]</code> is <code>+hhmm</code> or <code>-hhmm</code>. The time zone of the new object is assumed to be a static offset equal to the <code>[offset]</code>. The <code>[offset]</code> is optional; if omitted, a <code>:timezone</code> argument is permitted; if this too is omitted, UTC is assumed. Finally, the constructor also accepts a <code>:formatter</code> argument.</p>

<p>With all the above constructors, if you attempt to pass in values that are outside of the ranges specified in the list above, you&#39;ll get an exception. An exception will also be thrown if the given day (like 31 April 2000 or 29 February 2006) or second (like 23:59:60 on 1 January 2000) doesn&#39;t exist. The same checks are run when you produce an object with <code>clone</code>:</p>

<pre><code>my $dt = DateTime.new(:year(1999), :month(1), :day(29));
say $dt.clone(:year(2000), :month(2)); # 2000-02-29T00:00:00Z
say $dt.clone(:year(1999), :month(2)); # WRONG; 1999 was a common year</code></pre>

<p>To convert an object from one time zone to another, use the <code>in-timezone</code> method:</p>

<pre><code>my $dt = DateTime.new(&#39;2005-02-01T15:00:00+0900&#39;);
say $dt.hour;                       # 15
$dt = $dt.in-timezone(6 * 60 * 60); # 6 hours ahead of UTC
say $dt.hour;                       # 12</code></pre>

<p>The <code>utc</code> method is shorthand for <code>in-timezone(0)</code>, and the <code>local</code> method is short for <code>in-timezone($*TZ)</code>.</p>

<p>The <code>truncated-to</code> constructor allows you to &#34;clear&#34; a number of time values below a given resolution:</p>

<pre><code>my $dt = DateTime.new(&#39;2005-02-01T15:20:35Z&#39;);
say $dt.truncated-to(&#39;hour&#39;); # 2005-02-01T15:00:00Z</code></pre>

<p>Arguments to <code>truncated-to</code> is one of the following string values:</p>

<pre><code>second  seconds
minute  minutes
hour    hours
day     days
week    weeks
month   months
year    years</code></pre>

<p>An argument of <code>&#39;week&#39;</code> to <code>truncated-to</code> yields an object with the date of the last Monday (or the same date, if it already is a Monday) and with hours, minutes, and seconds all set to zero:</p>

<pre><code>say $dt.truncated-to(&#39;week&#39;); # 2005-01-31T00:00:00Z</code></pre>

<p>The <code>later</code> and <code>earlier</code> constructors allows you to move a number of time units forward or backward in time.</p>

<pre><code>$dt.later(minutes =&#62; 44);
$dt.earlier(week =&#62; 1);</code></pre>

<p>(Both <code>later</code> and <code>earlier</code> accept zero or negative integers, with the obvious extended semantics.)</p>

<p>There&#39;s one additional constructor: <code>now</code>. It works just like <code>DateTime.new(now)</code> except that there is no positional parameter and the <code>:timezone</code> argument defaults to <code>$*TZ</code>.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="Accessors"
>Accessors</a></h2>

<p>There are methods <code>year</code>, <code>month</code>, <code>day</code>, <code>hour</code>, <code>minute</code>, <code>second</code>, <code>timezone</code>, and <code>formatter</code>, giving you the corresponding values of the <code>DateTime</code> object. The <code>day</code> method also has the synonym <code>day-of-month</code>.</p>

<p>The method <code>Instant</code> returns an <code>Instant</code>, and the method <code>posix</code> returns a POSIX time.</p>

<p>The method <code>week</code> returns two values, the <i>week year</i> and <i>week number</i>. (These are also available through the methods <code>week-year</code> and <code>week-number</code>, respectively.) The first week of the year is defined by ISO as the one which contains the fourth day of January. Thus, dates early in January often end up in the last week of the prior year, and similarly, the final few days of December may be placed in the first week of the next year.</p>

<p>There&#39;s a <code>day-of-week</code> method, which returns the day of the week as a number 1..7, with 1 being Monday and 7 being Sunday.</p>

<p>The <code>day-of-week-in-month</code> method returns a number 1..5 indicating the number of times a particular day-of-week has occurred so far during that month, the day itself included. For example, June 9, 2003 is the second Monday of the month, and so this method returns 2 for that day.</p>

<p>The <code>days-in-month</code> method returns the number of days in the current month of the current year. So in the case of January, <code>days-in-month</code> always returns 31, whereas in the case of February, <code>days-in-month</code> returns 28 or 29 depending on the year.</p>

<p>The <code>day-of-year</code> method returns the day of the year, a value between 1 and 366.</p>

<p>The method <code>is-leap-year</code> returns a <code>Bool</code>, which is true if and only if the current year is a leap year in the Gregorian calendar.</p>

<p>The method <code>whole-second</code> returns the second truncated to an integer.</p>

<p>The <code>Date</code> method returns a <code>Date</code> object, and is the same as <code>Date.new($dt.year, $dt.month, $dt.day)</code>.</p>

<p>The method <code>offset</code> returns the object&#39;s current offset from UTC in seconds. This returns the Int value of <code>:timezone</code>.</p>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="Date"
><code>Date</code></a></h1>

<p><code>Date</code> objects represent a day without a time component. Like <code>DateTime</code> objects, they are immutable. They allow easier manipulation by assuming that integers always mean days.</p>

<p>Days, Months and days of week are 1-based.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="Constructors"
>Constructors</a></h2>

<pre><code>Date.today();               # today&#39;s date
Date.new(DateTime.now);     # same
Date.new(&#39;2010-12-20&#39;);     # YYYY-MM-DD format
Date.new(:year(2010), :month(12), :day(20));
Date.new(2010, 12, 20);
Date.new(2010, 1, 20).clone(month =&#62; 12);
Date.new(2010, 12, 24).truncated-to(&#39;week&#39;);
Date.new(2010, 12, 24).later(weeks =&#62; 10);</code></pre>

<p>The constructors die with a helpful error message if month or day are out of range.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="Instance_methods"
>Instance methods</a></h2>

<p><code>Date</code> objects support all of the following accessors, which work just like their <code>DateTime</code> equivalents:</p>

<pre><code>year
month
day
day-of-month
day-of-week
week
week-year
week-number
day-of-week
day-of-week-in-month
days-in-month
day-of-year
is-leap-year</code></pre>

<p>The <code>Str</code> method returns a string of the form &#39;yyyy-mm-dd&#39;.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="Arithmetics"
>Arithmetics</a></h2>

<pre><code>$d.succ                     # Date.new(&#39;2010-12-25&#39;)
$d.pred                     # Date.new(&#39;2010-12-23&#39;)
$d - Date.new(&#39;1984-03-02&#39;) # 9793      # (difference in days)
$d - 42                     # Date.new(&#39;2010-11-12&#39;)
$d + 3                      # Date.new(&#39;2010-12-27&#39;)
3  + $d                     # Date.new(&#39;2010-12-27&#39;)</code></pre>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="FOOTNOTE"
>FOOTNOTE</a></h1>

<p>The authors of the current rewrite want to mention, with thanks, the indirect contribution made by the previous authors:</p>

<pre><code>The authors of the related Perl 5 docs
Rod Adams &#60;rod@rodadams.net&#62;
Larry Wall &#60;larry@wall.org&#62;
Aaron Sherman &#60;ajs@ajs.com&#62;
Mark Stosberg &#60;mark@summersault.com&#62;
Carl M&#228;sak &#60;cmasak@gmail.com&#62;
Moritz Lenz &#60;moritz@faui2k3.org&#62;
Tim Nelson &#60;wayland@wayland.id.au&#62;
Daniel Ruoso &#60;daniel@ruoso.com&#62;
Dave Rolsky &#60;autarch@urth.org&#62;
Matthew (lue) &#60;rnddim@gmail.com&#62;</code></pre>

<!-- end doc -->

</body></html>
