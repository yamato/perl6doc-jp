<!DOCTYPE html>
<html lang="ja">
<head>
<title>S22-package-format</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" >
<link rel="stylesheet" href="http://yandex.st/highlightjs/8.0/styles/github.min.css">
<link rel="stylesheet" href="default.css">
<script src="http://yandex.st/highlightjs/8.0/highlight.min.js"></script>
<script>hljs.configure( { languages: ['perl'] } ); hljs.initHighlightingOnLoad();</script>
</head>
<body class='pod'>
<!--
  generated by My::Pod v,
  using Pod::Simple::PullParser v3.28,
  under Perl v5.018002 at Sat Aug 30 10:16:52 2014 GMT.

 If you want to change this HTML document, you probably shouldn't do that
   by changing it directly.  Instead, see about changing the calling options
   to My::Pod, and/or subclassing My::Pod,
   then reconverting this document from the Pod source.
   When in doubt, email the author of My::Pod for advice.
   See 'perldoc My::Pod' for more info.

-->

<!-- start doc -->
<a name='___top' class='dummyTopAnchor' ></a>

<div class='indexgroup'>
<ul   class='indexList indexList1'>
  <li class='indexItem indexItem1'><a href='#TITLE'>TITLE</a>
  <li class='indexItem indexItem1'><a href='#AUTHORS'>AUTHORS</a>
  <li class='indexItem indexItem1'><a href='#VERSION'>VERSION</a>
  <li class='indexItem indexItem1'><a href='#TERMINOLOGY'>TERMINOLOGY</a>
  <ul   class='indexList indexList2'>
    <li class='indexItem indexItem2'><a href='#compilation_unit'>compilation unit</a>
    <li class='indexItem indexItem2'><a href='#distribution'>distribution</a>
    <li class='indexItem indexItem2'><a href='#owner'>owner</a>
    <li class='indexItem indexItem2'><a href='#content_storage'>content storage</a>
    <li class='indexItem indexItem2'><a href='#auth'>auth</a>
    <li class='indexItem indexItem2'><a href='#identity'>identity</a>
    <li class='indexItem indexItem2'><a href='#recommendation_manager'>recommendation manager</a>
  </ul>
  <li class='indexItem indexItem1'><a href='#DISTRIBUTION'>DISTRIBUTION</a>
  <ul   class='indexList indexList2'>
    <li class='indexItem indexItem2'><a href='#META6.json'>META6.json</a>
    <ul   class='indexList indexList3'>
      <li class='indexItem indexItem3'><a href='#perl'>perl</a>
      <li class='indexItem indexItem3'><a href='#name'>name</a>
      <li class='indexItem indexItem3'><a href='#version'>version</a>
      <li class='indexItem indexItem3'><a href='#description'>description</a>
      <li class='indexItem indexItem3'><a href='#authors'>authors</a>
      <li class='indexItem indexItem3'><a href='#provides'>provides</a>
      <li class='indexItem indexItem3'><a href='#depends'>depends</a>
      <li class='indexItem indexItem3'><a href='#emulates'>emulates</a>
      <li class='indexItem indexItem3'><a href='#supersedes'>supersedes</a>
      <li class='indexItem indexItem3'><a href='#superseded_by'>superseded_by</a>
      <li class='indexItem indexItem3'><a href='#excludes'>excludes</a>
      <li class='indexItem indexItem3'><a href='#build-depends'>build-depends</a>
      <li class='indexItem indexItem3'><a href='#test-depends'>test-depends</a>
      <li class='indexItem indexItem3'><a href='#resource'>resource</a>
      <li class='indexItem indexItem3'><a href='#support'>support</a>
      <li class='indexItem indexItem3'><a href='#production'>production</a>
      <li class='indexItem indexItem3'><a href='#license'>license</a>
      <li class='indexItem indexItem3'><a href='#tags'>tags</a>
    </ul>
    <li class='indexItem indexItem2'><a href='#Special_directories'>Special directories</a>
    <ul   class='indexList indexList3'>
      <li class='indexItem indexItem3'><a href='#bin'>bin</a>
      <li class='indexItem indexItem3'><a href='#t'>t</a>
      <li class='indexItem indexItem3'><a href='#hooks'>hooks</a>
    </ul>
    <li class='indexItem indexItem2'><a href='#Installation'>Installation</a>
  </ul>
  <li class='indexItem indexItem1'><a href='#CLASSES'>CLASSES</a>
  <ul   class='indexList indexList2'>
    <li class='indexItem indexItem2'><a href='#CompUnitRepo'>CompUnitRepo</a>
    <ul   class='indexList indexList3'>
      <li class='indexItem indexItem3'><a href='#Specifying_a_CompUnitRepo'>Specifying a CompUnitRepo</a>
      <li class='indexItem indexItem3'><a href='#parse-spec'>parse-spec</a>
      <li class='indexItem indexItem3'><a href='#new'>new</a>
      <li class='indexItem indexItem3'><a href='#short-id'>short-id</a>
      <li class='indexItem indexItem3'><a href='#install'>install</a>
      <li class='indexItem indexItem3'><a href='#candidates'>candidates</a>
    </ul>
    <li class='indexItem indexItem2'><a href='#CompUnitRepo%3A%3ALocal%3A%3AFile'>CompUnitRepo::Local::File</a>
    <ul   class='indexList indexList3'>
      <li class='indexItem indexItem3'><a href='#install'>install</a>
    </ul>
    <li class='indexItem indexItem2'><a href='#CompUnitRepo%3A%3ALocal%3A%3AInstallation'>CompUnitRepo::Local::Installation</a>
    <ul   class='indexList indexList3'>
      <li class='indexItem indexItem3'><a href='#install'>install</a>
    </ul>
    <li class='indexItem indexItem2'><a href='#Distribution'>Distribution</a>
    <ul   class='indexList indexList3'>
      <li class='indexItem indexItem3'><a href='#meta'>meta</a>
      <li class='indexItem indexItem3'><a href='#content'>content</a>
    </ul>
    <li class='indexItem indexItem2'><a href='#Distribution%3A%3ALocal%3A%3ATar'>Distribution::Local::Tar</a>
    <li class='indexItem indexItem2'><a href='#CompUnit'>CompUnit</a>
    <ul   class='indexList indexList3'>
      <li class='indexItem indexItem3'><a href='#new'>new</a>
      <li class='indexItem indexItem3'><a href='#load'>load</a>
      <li class='indexItem indexItem3'><a href='#loaded'>loaded</a>
    </ul>
  </ul>
  <li class='indexItem indexItem1'><a href='#SYSTEM_VARIABLES'>SYSTEM VARIABLES</a>
  <ul   class='indexList indexList2'>
    <li class='indexItem indexItem2'><a href='#%25%3FRESOURCE'>%?RESOURCE</a>
    <li class='indexItem indexItem2'><a href='#%25*CUSTOM_LIB'>%*CUSTOM_LIB</a>
    <li class='indexItem indexItem2'><a href='#%40*INC'>@*INC</a>
  </ul>
</ul>
</div>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="TITLE"
>TITLE</a></h1>

<p>Synopsis 22: Distributions,
Recommendations,
Delivery and Installation</p>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="AUTHORS"
>AUTHORS</a></h1>

<pre><code>Elizabeth Mattijsen &#60;liz@dijkmat.nl&#62;</code></pre>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="VERSION"
>VERSION</a></h1>

<pre><code>Created: 15 March 2014

Last Modified: 22 June 2014
Version: 3</code></pre>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="TERMINOLOGY"
>TERMINOLOGY</a></h1>

<p>Because many of the concepts used in this document may be overloaded by other concepts in the mind of the reader, it seems like a good idea to define some terminology first. Please note that these definitions only apply within the context of Perl 6.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="compilation_unit"
>compilation unit</a></h2>

<p>A piece of code that can be compiled as a unit. It can either exist in a file (and be compiled using <code>use</code> or <code>require</code>), or be presented as a stream of characters for compilation with <code>EVAL</code>. An example of a compilation unit in a file:</p>

<pre><code>  lib/JSON/Fast.pm6</code></pre>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="distribution"
>distribution</a></h2>

<p>A distribution is an archive of some form that can be used to install zero or more compilation units (each stored in a separate file), with any possibly associated files needed for execution. For example:</p>

<pre><code>  lib/JSON/Fast.pm6
  lib/JSON/PurePerl.pm6</code></pre>

<p>It has a name for identification, which may or may not coincide with the compilation units in the distribution. An example of a distribution name:</p>

<pre><code>  JSON-Fast</code></pre>

<p>It also has a version, to distinguish it from other distributions with the same name. For instance:</p>

<pre><code>  1.23</code></pre>

<p>Which, together, are used to create the filename of the distribution, for instance:</p>

<pre><code>  JSON-Fast.1.23.tar.gz</code></pre>

<p>Please note that by changing the <code>::</code> from the module specification to a <code>-</code> for the filename of the archive, we are effectively disallowing an owner to upload a distribution for &#34;JSON-Fast&#34; and &#34;JSON::Fast&#34; at the same time. This seems unlikely to become a problem.</p>

<p>A Perl 6 distribution <b>must</b> contain a configuration file named <code>META6.json</code>, containing JSON-encoded information about the contents of the distribution.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="owner"
>owner</a></h2>

<p>The owner of a distribution is responsible for the development of a distribution. This can either be a single person, or a (semi-)official organisation. The owner of a distribution has a (mnemonic) name, e.g.:</p>

<pre><code>  JRANDOM</code></pre>

<p>Please note that the owner is not necessarily the developer of a distribution, although if the owner is a single individual, this is pretty likely.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="content_storage"
>content storage</a></h2>

<p>A service to which an owner can upload a distribution to and other people can download <b>specific</b> distributions from. This is most likely some online web-service, but it does not need to be. It has a logical name that is essentially a URL. An example would be:</p>

<pre><code>  cpan</code></pre>

<p>The (mnemonic) name of the owner usually coincides with the userid or login name used to upload distributions, but does not need to be.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="auth"
>auth</a></h2>

<p>The <code>auth</code> of a distribution, is the combination of the content storage name with the name of the owner, separated by a colon. For example:</p>

<pre><code>  cpan:JRANDOM</code></pre>

<p>Please note that this is <b>not</b> an authority, merely an indication of the location where the distribution for that owner was obtained. Typically the auth of a distribution is used to try to load compilation units of already installed distributions, such as in:</p>

<pre><code>  use JSON::Fast:auth&#60;cpan:JRANDOM&#62;;</code></pre>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="identity"
>identity</a></h2>

<p>The identity of a distribution, is the combination of name of the content storage, the name of the owner, name and version of a distribution, separated by colons. For example:</p>

<pre><code>  cpan:JRANDOM:JSON-Fast:1.23</code></pre>

<p>There should really be only one unique distribution for a given identity in the world.</p>

<p>The content storage should accept an identity and either directly return the archive for that distribution, or return a URL from which that distribution can be downloaded.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="recommendation_manager"
>recommendation manager</a></h2>

<p>A service that will translate a request for a compilation unit (with optional owner and/or version and/or content storage specification, like a <code>use</code> statement) into a list of zero or more identities of distributions that match the request.</p>

<p>The recommendation manager is only used during the installation process of the distribution for a wanted compilation unit.</p>

<p>A recommendation manager can be run by a community (like the current Perl 6 ecosystem or the packages list for Perl 5 on CPAN), or by company (for use inside the company itself), or by any reviewing / grading service (for use by anybody wanting to use that service), or by any other person willing to put in the effort.</p>

<p>A request for:</p>

<pre><code>  JSON::PurePerl</code></pre>

<p>would yield the identity:</p>

<pre><code>  cpan:JRANDOM:JSON-Fast:1.23</code></pre>

<p>because the compilation unit <code>JSON::PurePerl</code> is part of the <code>JSON::Fast</code> distribution.</p>

<p>However, a request for:</p>

<pre><code>  JSON::Fast:auth&#60;github:JRANDOM&#62;</code></pre>

<p>would not find anything, because it has the wrong content storage specification (&#34;github&#34; instead of &#34;cpan&#34;).</p>

<p>Please note that a recommendation manager does not need to be bound to a single content storage. In fact, a recommendation manager would be best if being able to supply identities from the best of <b>all</b> worlds. And potentially be able to recommend identities responding to more natural language queries, but that is probably outside the scope of this specification.</p>

<p>A bundle of distributions is basically just a collection of identities that listen to a name (such as <code>Rakudo *</code>). A recommendation manager may provide bundles as part of its service. And packagers may use this information as the source for bundling distributions in their specific packaging system.</p>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="DISTRIBUTION"
>DISTRIBUTION</a></h1>

<p>A Perl 6 distribution consists of an archive of some form (presumably a .tar.gz, .tar.bz2 or .zip file) which is expected to at least contain a file called &#34;META6.json&#34;. The existence of this file indicates that this distribution is a Perl 6 distribution. This is important for those archive networks that also serve as a content-distribution system for other types of distributions (such as PAUSE / CPAN), so that they can adapt the processing of the contents, or decide to ignore any processing at all (such as CPAN-testers not being able to test Perl 6 distributions (yet)).</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="META6.json"
>META6.json</a></h2>

<p>The META6.json file is a JSON-file that must at least contain a <code>perl</code>, <code>name</code>, <code>version</code> and <code>description</code> section.</p>

<h3><a class='u' href='#___top' title='click to go to top of document'
name="perl"
>perl</a></h3>

<p>Mandatory. The minimal perl version for which this distribution can be installed. Specified as a version string. So:</p>

<pre><code>  &#34;perl&#34; : &#34;v6.0.1&#34;</code></pre>

<p>would not allow installation on Perl version 6.0.0.</p>

<h3><a class='u' href='#___top' title='click to go to top of document'
name="name"
>name</a></h3>

<p>Mandatory. The name identifying this distribution. This is usually the name of the main module that this distribution provides. An example of this would be:</p>

<pre><code>  &#34;name&#34; : &#34;JSON::Fast&#34;</code></pre>

<h3><a class='u' href='#___top' title='click to go to top of document'
name="version"
>version</a></h3>

<p>Mandatory. The version literal for this distribution. An example of this would be:</p>

<pre><code>  &#34;version&#34; : &#34;v1.23&#34;</code></pre>

<h3><a class='u' href='#___top' title='click to go to top of document'
name="description"
>description</a></h3>

<p>Mandatory. A one line description of this distribution. So, for instance:</p>

<pre><code>  &#34;description&#34; : &#34;Providing fast JSON encoding/decoding&#34;</code></pre>

<h3><a class='u' href='#___top' title='click to go to top of document'
name="authors"
>authors</a></h3>

<p>Optional. A list of (mnemonic) names of people who work / have worked on this distribution. For informational purposes only. An example:</p>

<pre><code>  &#34;authors&#34; : [
&#34;Janet Random&#34;,
&#34;Sam Helpedwithit&#34;
  ]</code></pre>

<p>Please note that for identification purposes, only the owner (who uploaded the distribution to the content storage) should be used.</p>

<h3><a class='u' href='#___top' title='click to go to top of document'
name="provides"
>provides</a></h3>

<p>Optional. A list of module - local filename pairs that this distribution makes available to be <code>use</code>d. For example:</p>

<pre><code>  &#34;provides&#34; : {
&#34;JSON::Fast&#34;     : &#34;lib/JSON/Fast.pm6&#34;
&#34;JSON::PurePerl&#34; : &#34;lib/JSON/PurePerl.pm6&#34;
  }</code></pre>

<p>Please note that the filenames specified only indicate the names of the files in the <b>distribution</b>. The installer may need to mangle filenames to be able support file systems that do not support the file names given (e.g. when they contain unicode characters where the file system does not support them). This also implies that any installer needs to keep a local database that is able to convert from the module names given, to the actual associated file).</p>

<h3><a class='u' href='#___top' title='click to go to top of document'
name="depends"
>depends</a></h3>

<p>Optional. A list of run-time dependencies, specified as <code>use</code> strings. To indicate alternatives, it is possible to specify a list of <code>use</code> strings, instead of just a single use string. So:</p>

<pre><code>  &#34;depends&#34; : [
&#34;Sereal:auth&#60;cpan:*&#62;:ver(1..*)&#34;,
[ &#34;Archive::Compress&#34;, &#34;Archive::Zlib&#34; ]
  ]</code></pre>

<p>would indicate a dependency on Sereal, and either Archive::Compress or Archive::Zlib.</p>

<p>An installer has the option to automatically install any dependencies, if the user has so indicated. Dependencies and alternatives should be tried in the order they are specified. In the case of alternatives, the first one for which the recommendation manager returns an identity should be installed. Failure of installation of an alternative may allow automatic attempts on other alternatives.</p>

<p>Please note that the <code>use</code> strings of compilation units are specified. It is the responsibility of the recommendation manager to turn these into identities of distributions that can be downloaded.</p>

<h3><a class='u' href='#___top' title='click to go to top of document'
name="emulates"
>emulates</a></h3>

<p>Optional. A hash in which the key is the compunit (provided by the distribution) to be aliased, and the value is the use string that should match to get that compilation unit. An example of this would be:</p>

<pre><code>  &#34;emulates&#34; : {
&#34;JSON::Fast&#34; : &#34;JSON::XS:auth&#60;cpan:MLEHMANN&#62;&#34;
  }</code></pre>

<p>If then later, a program would say:</p>

<pre><code>  use JSON::XS;</code></pre>

<p>it would in fact load the <code>JSON::Fast</code> compunit, but make it appear as a <code>JSON::XS</code> compunit, but only if there was no &#34;real&#34; <code>JSON::XS</code> compunit installed that would match the <code>use</code> specification. In other words: if the real thing is available, then it will be used. If it is not, it will fall back to the indicated compilation unit. And it will look like you are using the thing you asked for.</p>

<p>Conversely, if one would do a:</p>

<pre><code>  use JSON::Fast;</code></pre>

<p>then later doing a:</p>

<pre><code>  use JSON::XS:auth&#60;cpan:MLEHMANN&#62;;</code></pre>

<p>in the same scope would become a no-op, just as if the compunit had already been loaded.</p>

<p>Please note that it is responsibility of the emulating compunit to actually provide a compatible interface with emulated compunit.</p>

<h3><a class='u' href='#___top' title='click to go to top of document'
name="supersedes"
>supersedes</a></h3>

<p>Optional. Has the same meaning as &#34;emulates&#34; for the <a href="#CompUnitRepo" class="podlinkpod"
>&#34;CompUnitRepo&#34;</a>. But has additional meaning for external packagers: it indicates a potential superseding of the indicated compilation unit from the packagers point of view. See <a href="#superseded_by" class="podlinkpod"
>&#34;superseded_by&#34;</a>.</p>

<h3><a class='u' href='#___top' title='click to go to top of document'
name="superseded_by"
>superseded_by</a></h3>

<p>Optional. Has the reverse meaning of &#34;emulates&#34; for the <a href="#CompUnitRepo" class="podlinkpod"
>&#34;CompUnitRepo&#34;</a>. It is a hash in which the key is compunit provided by the distribution, and the value is the <code>use</code> string of the compunit it should be aliased to if that compunit is available. So in this case:</p>

<pre><code>  &#34;superseded_by&#34; : {
&#34;JSON::Fast&#34; : &#34;SuperJSON:ver(v1.0 .. *)&#34;
  }</code></pre>

<p>it would mean that if a program attempts to load the <code>JSON::Fast</code> compunit of this distribution, it should instead use any <code>SuperJSON</code> compunit that is installed that has a version of 1.0 or higher. In other words: please don&#39;t use my compunit, unless you really have to.</p>

<p>This tag has additional meaning for packagers: if a packager detects a valid <code>supersedes</code> and <code>superseded_by</code> pair in its collection of distributions to be packaged, the packager may decide to only supply the distribution providing the <code>superseded_by</code> compilation unit.</p>

<p>Please note that <code>superseded_by</code> has no meaning as a <code>depends</code>, so an installer should probably not automatically install any <code>superseded_by</code> compunits.</p>

<h3><a class='u' href='#___top' title='click to go to top of document'
name="excludes"
>excludes</a></h3>

<p>Optional. A hash in which the key is a compilation unit provided by this distribution, and the value is a <code>use</code> string of all compilation units that will be disallowed when attempted to be loaded in the same lexical scope. An example of this would be:</p>

<pre><code>  &#34;excludes&#34; : {
&#34;JSON::PurePerl&#34; : &#34;JSON::Slow:auth&#60;cpan:*&#62;:ver(1..*)&#34;
  }</code></pre>

<p>So, if a lexical scope loads <code>JSON::PurePerl</code> from this distribution, then attempting to load <code>JSON::Slow</code> will cause a Failure. Please note that this has <b>no</b> meaning for packagers: it is simply a way to provide a better error message if a collision of some sort will occur when both modules are loaded in the same lexical scope.</p>

<h3><a class='u' href='#___top' title='click to go to top of document'
name="build-depends"
>build-depends</a></h3>

<p>Optional. A list of build-time dependencies, specified as <code>use</code> strings. An example of this would be:</p>

<pre><code>  &#34;build-depends&#34; : [
&#34;Archive::Zip&#34;
  ]</code></pre>

<h3><a class='u' href='#___top' title='click to go to top of document'
name="test-depends"
>test-depends</a></h3>

<p>Optional. A list of test-time dependencies, specified as <code>use</code> strings. An example of this would be:</p>

<pre><code>  &#34;test-depends&#34; : [
&#34;Test:auth&#60;cpan:OVID&#62;&#34;
  ]</code></pre>

<h3><a class='u' href='#___top' title='click to go to top of document'
name="resource"
>resource</a></h3>

<p>Optional. A hash of resource groups, each of them corresponding to a directory in the &#34;resource&#34; directory in the distribution. Each resource group has a name and a list of files that are provided. During installation the installer will install these into a location, and make the files available through the <a href="#%25%3FRESOURCE" class="podlinkpod"
>&#34;%?RESOURCE&#34;</a> hash.</p>

<h3><a class='u' href='#___top' title='click to go to top of document'
name="support"
>support</a></h3>

<p>Optional. A hash of key-value pairs regarding support for this distribution. Possible names are: <code>email</code>, <code>mailinglist</code>, <code>bugtracker</code>, <code>source</code>, <code>irc</code>, <code>phone</code>.</p>

<dl>
<dt><a name="email"
>email</a></dt>

<dd>
<p>The email address of the owner of this distribution, if any.</p>

<dt><a name="mailinglist"
>mailinglist</a></dt>

<dd>
<p>The mailinglist of users of this distribution, if any.</p>

<dt><a name="bugtracker"
>bugtracker</a></dt>

<dd>
<p>The bugtracker of this distribution, if any.</p>

<dt><a name="source"
>source</a></dt>

<dd>
<p>The URL of the source of this distribution, if any.</p>

<dt><a name="irc"
>irc</a></dt>

<dd>
<p>The URL of the IRC channel where this distribution can be discussed, if any.</p>

<dt><a name="phone"
>phone</a></dt>

<dd>
<p>A fully qualified phone number (with potential cost indication) that can be used with queries about this distribution.</p>
</dd>
</dl>

<h3><a class='u' href='#___top' title='click to go to top of document'
name="production"
>production</a></h3>

<p>Optional. A Boolean to indicate whether or not this is a distribution intended to be used in production. For instance:</p>

<pre><code>  &#34;production&#34; : 1</code></pre>

<p>By default, a distribution is not ready for production. If a distribution is not ready for production, then it will never be recommended.</p>

<p>Please note that this section is only to be used by <b>installers</b>, giving them the opportunity to decide whether or not to install that distribution. Once a distribution is installed, it can be loaded just like any other distribution.</p>

<h3><a class='u' href='#___top' title='click to go to top of document'
name="license"
>license</a></h3>

<p>Optional. The URL with the text of the license under which this distribution is available for installation. Or some other way to indicate the license, e.g. inspired by the Perl 5 module <a href="http://search.cpan.org/perldoc?Software%3A%3ALicense" class="podlinkpod"
>Software::License</a>.</p>

<pre><code>  &#34;license&#34; : &#34;http://www.gnu.org/licenses/gpl-1.0.html&#34;  </code></pre>

<h3><a class='u' href='#___top' title='click to go to top of document'
name="tags"
>tags</a></h3>

<p>Optional. A list of general purpose tags. For instance:</p>

<pre><code>  &#34;tags&#34; : [
&#34;json&#34;,
&#34;perl6&#34;
  ]</code></pre>

<p>It has no meaning other than the meaning <b>you</b> assign to it.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="Special_directories"
>Special directories</a></h2>

<p>A distribution may contain several directories that will be handled specially.</p>

<h3><a class='u' href='#___top' title='click to go to top of document'
name="bin"
>bin</a></h3>

<p>Any file inside this directory, will be installed as a callable shell application.</p>

<h3><a class='u' href='#___top' title='click to go to top of document'
name="t"
>t</a></h3>

<p>All <code>.t</code> files in this directory, will be tested in alphabatical order, possibly in parallel. Any files in this directory will never be installed.</p>

<h3><a class='u' href='#___top' title='click to go to top of document'
name="hooks"
>hooks</a></h3>

<p>All files in this directory should contain executable Perl 6 code, to be executed at various stages of the install process of this distribution.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="Installation"
>Installation</a></h2>

<p>Distributions can be installed with an installer. This may be a command-line script, or be some kind of GUI. The installer needs the user to (implicitly) select the <code>CompUnitRepo</code> in which the distribution should be installed, and the recommendation manager that should be used to convert requests for a compilation unit into an identity of a distribution to be downloaded.</p>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="CLASSES"
>CLASSES</a></h1>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="CompUnitRepo"
>CompUnitRepo</a></h2>

<p>Base class (interface, really) for the object living in the <a href="#%40*INC" class="podlinkpod"
>&#34;@*INC&#34;</a> array. Used both for installing compunits, as well as finding a certain compunit by way of its from, longname, auth and ver information.</p>

<h3><a class='u' href='#___top' title='click to go to top of document'
name="Specifying_a_CompUnitRepo"
>Specifying a CompUnitRepo</a></h3>

<p>The specification of a CompUnitRepo can happen at various places: in a configuration file, on the command-line when starting (with <code>-I</code>), and in code when trying to create a CompUnitRepo object programmatically.</p>

<p>Each specification consists of a CompUnitRepo class specification (either explicitly, implicitly, or the short-hand form using the <a href="#short-id" class="podlinkpod"
>&#34;short-id&#34;</a> identifier), optional named parameters and a location indicator (usually a path or a URL).</p>

<p>Some examples (where CURL is short for CompUnitRepo::Local):</p>

<pre><code>  /foo/bar                    simple CURL::File in /foo/bar
  file:/foo/bar               (same)
  inst:/installed             simple CURL::Installation in /installed
  inst:name&#60;work&#62;:/installed  (same) but also set %*CUSTOM_LIB&#60;work&#62;
  inst:name[work]:/installed  (same) but more CLI-friendly
  inst:name{work}:/installed  (same) alternate CLI-friendly way
  CompUnitRepo::Local::Installation:/installed  (same) but with full class name
  CompUnitRepo::GitHub:masak/html-template      get it from GitHub</code></pre>

<p>Multiple specifications may be concatenated with <code>,</code>. If no class is specified on subsequent specifications, then the previous class specification will be assumed. So:</p>

<pre><code>  /foo/bar,/foo/baz           both use CURL::File
  inst:/installed,/also       both use CURL::Installation
  /foo/bar,inst:/installed    first CURL::File, second CURL::Installation</code></pre>

<h3><a class='u' href='#___top' title='click to go to top of document'
name="parse-spec"
>parse-spec</a></h3>

<pre><code>  my @repo-specs = CompUnitRepo.parse-spec( $string );</code></pre>

<p>This helper method returns a <code>List</code> of <code>Parcel</code>s, in which the first element contains the <code>CompUnitRepo</code> class type object, the second contains the location string, and the third contains a <code>Hash</code> of the optional named parameters. Throws an exception if anything went wrong with parsing.</p>

<h3><a class='u' href='#___top' title='click to go to top of document'
name="new"
>new</a></h3>

<pre><code>  my $repo = CompUnitRepo.new( $specification );</code></pre>

<p>Create a new CompUnitRepo-like object with the given specification, either for inclusion in <a href="#%3C%40*INC" class="podlinkpod"
>&#34;&#60;@*INC&#34;</a>, or to install a distribution. Returns the instantiated object.</p>

<p>Please note that for a given <code>specification</code>, there should always only be one <code>CompUnitRepo</code> object in a process.</p>

<h3><a class='u' href='#___top' title='click to go to top of document'
name="short-id"
>short-id</a></h3>

<pre><code>  say CompUnitRepo::Local::File.short-id;   # &#34;file&#34;</code></pre>

<p>Returns a short <code>\w+</code> identifier string (a <code>tag</code> if you will) to identify the use of this repo, e.g. in strings provided with the <code>-I</code> command line parameter. It should be unique for all of the CompUnitRepo subclasses loaded. The following <code>short-id</code>&#39;s are pre-defined:</p>

<pre><code>  file   CompUnitRepo::Local::File
  inst   CompUnitRepo::Local::Installation</code></pre>

<h3><a class='u' href='#___top' title='click to go to top of document'
name="install"
>install</a></h3>

<pre><code>  my $installed = $repo.install( $dist );</code></pre>

<p>Install the compilation units of a <a href="#Distribution" class="podlinkpod"
>&#34;Distribution&#34;</a> in the appropriate way for this CompUnitRepo-like object. May cause a fatal exception if this repository does not support installing. The parameter contains the <a href="#Distribution" class="podlinkpod"
>&#34;Distribution&#34;</a> object to be installed. Returns True if the distribution was installed, or a <code>Failure</code> if it didn&#39;t.</p>

<p>Of course, any implementation of <a href="http://search.cpan.org/perldoc?CompUnitRepo" class="podlinkpod"
>CompUnitRepo</a>&#39;s <code>install</code> interface, may decide to accept additional meta-information and store this and make available for later introspection.</p>

<h3><a class='u' href='#___top' title='click to go to top of document'
name="candidates"
>candidates</a></h3>

<pre><code>  my @candidates = $repo.candidates( $longname, $auth?, $ver?, $from? );</code></pre>

<p>Return <a href="http://search.cpan.org/perldoc?CompUnit" class="podlinkpod"
>CompUnit</a> candidates given the matching credentials.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="CompUnitRepo::Local::File"
>CompUnitRepo::Local::File</a></h2>

<p>The simplest, default case for locating compilation units on a file system. The module name specified should directly map to a file, similar to how Perl 5 this does. Mainly intended to be used in development situations to allow developers to have modules to be available without them having to be installed.</p>

<h3><a class='u' href='#___top' title='click to go to top of document'
name="install"
>install</a></h3>

<p>Will fail unconditionally: installing compilation units is done by putting files in the right location.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="CompUnitRepo::Local::Installation"
>CompUnitRepo::Local::Installation</a></h2>

<p>The default case for installed compilation units. Similar to the way Perl 5 installs modules, but with meta-information per object, rather than globally in a <code>packlist</code>. This should be used by installers such as <code>panda</code>.</p>

<h3><a class='u' href='#___top' title='click to go to top of document'
name="install"
>install</a></h3>

<pre><code>  my $installed = $repo.install( $dist );</code></pre>

<p>Install the given <a href="#Distribution" class="podlinkpod"
>&#34;Distribution&#34;</a> object in this repo.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="Distribution"
>Distribution</a></h2>

<p>The class for installing distributions using <a href="#CompUnitRepo%3A%3ALocal%3A%3AInstallation" class="podlinkpod"
>&#34;CompUnitRepo::Local::Installation&#34;</a>. Basically provides the API to access the <code>META6.json</code> file of a distribution. It should at least contain the following methods:</p>

<h3><a class='u' href='#___top' title='click to go to top of document'
name="meta"
>meta</a></h3>

<pre><code>  my $meta = $dist.meta;</code></pre>

<p>Return a Hash with the representation of the meta-data, constructed the same way as in the <code>META6.json</code> specification. Please note that an actual META6.json file does not need to exist, just a representation in that format.</p>

<h3><a class='u' href='#___top' title='click to go to top of document'
name="content"
>content</a></h3>

<pre><code>  my $content = $dist.content( &#60;provides JSON::Fast lib/JSON/Fast.pm6&#62; );

  my $content = $dist.content( &#60;resource images fido.png&#62; );</code></pre>

<p>Return the octet-stream as specified by the given keys, navigating through the <code>META6.json</code> hash.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="Distribution::Local::Tar"
>Distribution::Local::Tar</a></h2>

<p>An implementation of the <code>Distribution</code> API for locally stored <code>.tar</code> files.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="CompUnit"
>CompUnit</a></h2>

<p>The object that describes a compilation unit. Contains as much meta-data as possible, e.g. from the <code>Distribution</code> object it came from.</p>

<h3><a class='u' href='#___top' title='click to go to top of document'
name="new"
>new</a></h3>

<pre><code>  my $compunit = CompUnit.new( $path );</code></pre>

<p>Create a new CompUnit object with the given specification. Returns the instantiated object, or <code>Failure</code> if it could not find the <code>path</code>.</p>

<p>Please note that for a given <code>path</code>, there should always only be one <code>CompUnit</code> object in a process. This to prevent reloading the same compilation unit more than once.</p>

<h3><a class='u' href='#___top' title='click to go to top of document'
name="load"
>load</a></h3>

<pre><code>  my $loaded = @candidates[0].load(...);</code></pre>

<p>Returns True if loading of the <code>CompUnit</code> was successful, or a <code>Failure</code> if something went wrong.</p>

<h3><a class='u' href='#___top' title='click to go to top of document'
name="loaded"
>loaded</a></h3>

<pre><code>  my $loaded = $compunit.loaded;</code></pre>

<p>Return whether the compunit has been loaded.</p>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="SYSTEM_VARIABLES"
>SYSTEM VARIABLES</a></h1>

<p>Several dynamic variables are available.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="%?RESOURCE"
>%?RESOURCE</a></h2>

<p>This hash provides compile and runtime access to files associated with the <a href="#Distribution" class="podlinkpod"
>&#34;Distribution&#34;</a> of the current compilation unit.</p>

<p>So, if the <code>META6.json</code> file contains this <code>resource</code> section:</p>

<pre><code>  &#34;resource&#34; : {
&#34;images&#34; : {
  &#34;fido.png&#34;
}
  }</code></pre>

<p>then the <code>Distribution</code> is supposed to contain a file <code>resource/images/fido.png</code>. After installation, the path of that file would be available through</p>

<pre><code>  %?RESOURCE&#60;images&#62;&#60;fido.png&#62;.path</code></pre>

<p>and a handle could be obtained with:</p>

<pre><code>  %?RESOURCE&#60;images&#62;&#60;fido.png&#62;.IO</code></pre>

<p>without there being any guarantee that this path has anything to do with the path as specified in the distribution. Please also note that the installer may mangle filenames of actually installed files.</p>

<p>This means you can have files with unicode characters in upper/lower case, and still be able to access them when installed on a file system that does not support unicode.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="%*CUSTOM_LIB"
>%*CUSTOM_LIB</a></h2>

<p>This hash provides key/value pairs of <code>CompUnitRepo</code> specifications, to be used by packagers and/or installers.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="@*INC"
>@*INC</a></h2>

<p>This array contains the <code>CompUnitRepo</code> objects that will be queried in turn whenever an attempt should be made to load a compilation unit (be that at compile time with <code>use</code>, or at runtime with <code>require</code>.</p>

<p>The first <code>CompUnitRepo</code> object to return one candidate, will then be loaded and no further <code>CompUnitRepo</code> objects in <code>@*INC</code> will be queried. If the first <code>CompUnitRepo</code> object to return <code>any</code> candidates, returns more than one candidate, then <b>all</b> other <code>CompUnitRepo</code> objects in <code>@*INC</code> will also be queried, to allow any error message to present a <b>full</b> list of <code>CompUnit</code> candidate objects.</p>

<!-- end doc -->

</body></html>
